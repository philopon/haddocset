<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Data/Monoid.hs</title>
<link type="text/css" rel="stylesheet" href="hscolour.css"></link>
</head>
<body>
<pre><a name="line-1"></a><span class="hs-comment">{-# LANGUAGE Trustworthy #-}</span>
<a name="line-2"></a><span class="hs-comment">{-# LANGUAGE CPP, NoImplicitPrelude #-}</span>
<a name="line-3"></a>
<a name="line-4"></a><span class="hs-comment">-----------------------------------------------------------------------------</span>
<a name="line-5"></a><span class="hs-comment">-- |</span>
<a name="line-6"></a><span class="hs-comment">-- Module      :  Data.Monoid</span>
<a name="line-7"></a><span class="hs-comment">-- Copyright   :  (c) Andy Gill 2001,</span>
<a name="line-8"></a><span class="hs-comment">--                (c) Oregon Graduate Institute of Science and Technology, 2001</span>
<a name="line-9"></a><span class="hs-comment">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span>
<a name="line-10"></a><span class="hs-comment">--</span>
<a name="line-11"></a><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span>
<a name="line-12"></a><span class="hs-comment">-- Stability   :  experimental</span>
<a name="line-13"></a><span class="hs-comment">-- Portability :  portable</span>
<a name="line-14"></a><span class="hs-comment">--</span>
<a name="line-15"></a><span class="hs-comment">-- A class for monoids (types with an associative binary operation that</span>
<a name="line-16"></a><span class="hs-comment">-- has an identity) with various general-purpose instances.</span>
<a name="line-17"></a><span class="hs-comment">--</span>
<a name="line-18"></a><span class="hs-comment">-----------------------------------------------------------------------------</span>
<a name="line-19"></a>
<a name="line-20"></a><span class="hs-keyword">module</span> <span class="hs-conid">Data</span><span class="hs-varop">.</span><span class="hs-conid">Monoid</span> <span class="hs-layout">(</span>
<a name="line-21"></a>        <span class="hs-comment">-- * Monoid typeclass</span>
<a name="line-22"></a>        <span class="hs-conid">Monoid</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-23"></a>        <span class="hs-layout">(</span><span class="hs-varop">&lt;&gt;</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-24"></a>        <span class="hs-conid">Dual</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-25"></a>        <span class="hs-conid">Endo</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-26"></a>        <span class="hs-comment">-- * Bool wrappers</span>
<a name="line-27"></a>        <span class="hs-conid">All</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-28"></a>        <span class="hs-conid">Any</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-29"></a>        <span class="hs-comment">-- * Num wrappers</span>
<a name="line-30"></a>        <span class="hs-conid">Sum</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-31"></a>        <span class="hs-conid">Product</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-32"></a>        <span class="hs-comment">-- * Maybe wrappers</span>
<a name="line-33"></a>        <span class="hs-comment">-- $MaybeExamples</span>
<a name="line-34"></a>        <span class="hs-conid">First</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-35"></a>        <span class="hs-conid">Last</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span>
<a name="line-36"></a>  <span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-37"></a>
<a name="line-38"></a><span class="hs-comment">-- Push down the module in the dependency hierarchy.</span>
<a name="line-39"></a><span class="hs-cpp">#if defined(__GLASGOW_HASKELL__)</span>
<a name="line-40"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Base</span> <span class="hs-varid">hiding</span> <span class="hs-layout">(</span><span class="hs-conid">Any</span><span class="hs-layout">)</span>
<a name="line-41"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Enum</span>
<a name="line-42"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Num</span>
<a name="line-43"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Read</span>
<a name="line-44"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Show</span>
<a name="line-45"></a><span class="hs-keyword">import</span> <span class="hs-conid">Data</span><span class="hs-varop">.</span><span class="hs-conid">Maybe</span>
<a name="line-46"></a><span class="hs-cpp">#else</span>
<a name="line-47"></a><span class="hs-keyword">import</span> <span class="hs-conid">Prelude</span>
<a name="line-48"></a><span class="hs-cpp">#endif</span>
<a name="line-49"></a>
<a name="line-50"></a><span class="hs-comment">{-
<a name="line-51"></a>-- just for testing
<a name="line-52"></a>import Data.Maybe
<a name="line-53"></a>import Test.QuickCheck
<a name="line-54"></a>-- -}</span>
<a name="line-55"></a>
<a name="line-56"></a><span class="hs-comment">-- ---------------------------------------------------------------------------</span>
<a name="line-57"></a><span class="hs-comment">-- | The class of monoids (types with an associative binary operation that</span>
<a name="line-58"></a><span class="hs-comment">-- has an identity).  Instances should satisfy the following laws:</span>
<a name="line-59"></a><span class="hs-comment">--</span>
<a name="line-60"></a><span class="hs-comment">--  * @mappend mempty x = x@</span>
<a name="line-61"></a><span class="hs-comment">--</span>
<a name="line-62"></a><span class="hs-comment">--  * @mappend x mempty = x@</span>
<a name="line-63"></a><span class="hs-comment">--</span>
<a name="line-64"></a><span class="hs-comment">--  * @mappend x (mappend y z) = mappend (mappend x y) z@</span>
<a name="line-65"></a><span class="hs-comment">--</span>
<a name="line-66"></a><span class="hs-comment">--  * @mconcat = 'foldr' mappend mempty@</span>
<a name="line-67"></a><span class="hs-comment">--</span>
<a name="line-68"></a><span class="hs-comment">-- The method names refer to the monoid of lists under concatenation,</span>
<a name="line-69"></a><span class="hs-comment">-- but there are many other instances.</span>
<a name="line-70"></a><span class="hs-comment">--</span>
<a name="line-71"></a><span class="hs-comment">-- Minimal complete definition: 'mempty' and 'mappend'.</span>
<a name="line-72"></a><span class="hs-comment">--</span>
<a name="line-73"></a><span class="hs-comment">-- Some types can be viewed as a monoid in more than one way,</span>
<a name="line-74"></a><span class="hs-comment">-- e.g. both addition and multiplication on numbers.</span>
<a name="line-75"></a><span class="hs-comment">-- In such cases we often define @newtype@s and make those instances</span>
<a name="line-76"></a><span class="hs-comment">-- of 'Monoid', e.g. 'Sum' and 'Product'.</span>
<a name="line-77"></a>
<a name="line-78"></a><a name="Monoid"></a><span class="hs-keyword">class</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">a</span> <span class="hs-keyword">where</span>
<a name="line-79"></a>        <span class="hs-varid">mempty</span>  <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span>
<a name="line-80"></a>        <span class="hs-comment">-- ^ Identity of 'mappend'</span>
<a name="line-81"></a>        <span class="hs-varid">mappend</span> <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-82"></a>        <span class="hs-comment">-- ^ An associative operation</span>
<a name="line-83"></a>        <span class="hs-varid">mconcat</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-84"></a>
<a name="line-85"></a>        <span class="hs-comment">-- ^ Fold a list using the monoid.</span>
<a name="line-86"></a>        <span class="hs-comment">-- For most types, the default definition for 'mconcat' will be</span>
<a name="line-87"></a>        <span class="hs-comment">-- used, but the function is included in the class definition so</span>
<a name="line-88"></a>        <span class="hs-comment">-- that an optimized version can be provided for specific types.</span>
<a name="line-89"></a>
<a name="line-90"></a>        <span class="hs-varid">mconcat</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">foldr</span> <span class="hs-varid">mappend</span> <span class="hs-varid">mempty</span>
<a name="line-91"></a>
<a name="line-92"></a><span class="hs-keyword">infixr</span> <span class="hs-num">6</span> <span class="hs-varop">&lt;&gt;</span>
<a name="line-93"></a>
<a name="line-94"></a><a name="%3c%3e"></a><span class="hs-comment">-- | An infix synonym for 'mappend'.</span>
<a name="line-95"></a><span class="hs-layout">(</span><span class="hs-varop">&lt;&gt;</span><span class="hs-layout">)</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">m</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">m</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">m</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">m</span>
<a name="line-96"></a><span class="hs-layout">(</span><span class="hs-varop">&lt;&gt;</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">mappend</span>
<a name="line-97"></a><span class="hs-comment">{-# INLINE (&lt;&gt;) #-}</span>
<a name="line-98"></a>
<a name="line-99"></a><span class="hs-comment">-- Monoid instances.</span>
<a name="line-100"></a>
<a name="line-101"></a><a name="instance%20Monoid%20%5ba%5d"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Monoid</span> <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span> <span class="hs-keyword">where</span>
<a name="line-102"></a>        <span class="hs-varid">mempty</span>  <span class="hs-keyglyph">=</span> <span class="hs-conid">[]</span>
<a name="line-103"></a>        <span class="hs-varid">mappend</span> <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varop">++</span><span class="hs-layout">)</span>
<a name="line-104"></a>
<a name="line-105"></a><a name="instance%20Monoid%20(a%20-%3e%20b)"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">b</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Monoid</span> <span class="hs-layout">(</span><span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-106"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyword">_</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">mempty</span>
<a name="line-107"></a>        <span class="hs-varid">mappend</span> <span class="hs-varid">f</span> <span class="hs-varid">g</span> <span class="hs-varid">x</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">f</span> <span class="hs-varid">x</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">g</span> <span class="hs-varid">x</span>
<a name="line-108"></a>
<a name="line-109"></a><a name="instance%20Monoid%20()"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Monoid</span> <span class="hs-conid">()</span> <span class="hs-keyword">where</span>
<a name="line-110"></a>        <span class="hs-comment">-- Should it be strict?</span>
<a name="line-111"></a>        <span class="hs-varid">mempty</span>        <span class="hs-keyglyph">=</span> <span class="hs-conid">()</span>
<a name="line-112"></a>        <span class="hs-keyword">_</span> <span class="hs-varop">`mappend`</span> <span class="hs-keyword">_</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">()</span>
<a name="line-113"></a>        <span class="hs-varid">mconcat</span> <span class="hs-keyword">_</span>     <span class="hs-keyglyph">=</span> <span class="hs-conid">()</span>
<a name="line-114"></a>
<a name="line-115"></a><a name="instance%20Monoid%20(a,b)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Monoid</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Monoid</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-116"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">mempty</span><span class="hs-layout">,</span> <span class="hs-varid">mempty</span><span class="hs-layout">)</span>
<a name="line-117"></a>        <span class="hs-layout">(</span><span class="hs-varid">a1</span><span class="hs-layout">,</span><span class="hs-varid">b1</span><span class="hs-layout">)</span> <span class="hs-varop">`mappend`</span> <span class="hs-layout">(</span><span class="hs-varid">a2</span><span class="hs-layout">,</span><span class="hs-varid">b2</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span>
<a name="line-118"></a>                <span class="hs-layout">(</span><span class="hs-varid">a1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">a2</span><span class="hs-layout">,</span> <span class="hs-varid">b1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">b2</span><span class="hs-layout">)</span>
<a name="line-119"></a>
<a name="line-120"></a><a name="instance%20Monoid%20(a,b,c)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Monoid</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">c</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Monoid</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-121"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">mempty</span><span class="hs-layout">,</span> <span class="hs-varid">mempty</span><span class="hs-layout">,</span> <span class="hs-varid">mempty</span><span class="hs-layout">)</span>
<a name="line-122"></a>        <span class="hs-layout">(</span><span class="hs-varid">a1</span><span class="hs-layout">,</span><span class="hs-varid">b1</span><span class="hs-layout">,</span><span class="hs-varid">c1</span><span class="hs-layout">)</span> <span class="hs-varop">`mappend`</span> <span class="hs-layout">(</span><span class="hs-varid">a2</span><span class="hs-layout">,</span><span class="hs-varid">b2</span><span class="hs-layout">,</span><span class="hs-varid">c2</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span>
<a name="line-123"></a>                <span class="hs-layout">(</span><span class="hs-varid">a1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">a2</span><span class="hs-layout">,</span> <span class="hs-varid">b1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">b2</span><span class="hs-layout">,</span> <span class="hs-varid">c1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">c2</span><span class="hs-layout">)</span>
<a name="line-124"></a>
<a name="line-125"></a><a name="instance%20Monoid%20(a,b,c,d)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Monoid</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">d</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Monoid</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-126"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">mempty</span><span class="hs-layout">,</span> <span class="hs-varid">mempty</span><span class="hs-layout">,</span> <span class="hs-varid">mempty</span><span class="hs-layout">,</span> <span class="hs-varid">mempty</span><span class="hs-layout">)</span>
<a name="line-127"></a>        <span class="hs-layout">(</span><span class="hs-varid">a1</span><span class="hs-layout">,</span><span class="hs-varid">b1</span><span class="hs-layout">,</span><span class="hs-varid">c1</span><span class="hs-layout">,</span><span class="hs-varid">d1</span><span class="hs-layout">)</span> <span class="hs-varop">`mappend`</span> <span class="hs-layout">(</span><span class="hs-varid">a2</span><span class="hs-layout">,</span><span class="hs-varid">b2</span><span class="hs-layout">,</span><span class="hs-varid">c2</span><span class="hs-layout">,</span><span class="hs-varid">d2</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span>
<a name="line-128"></a>                <span class="hs-layout">(</span><span class="hs-varid">a1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">a2</span><span class="hs-layout">,</span> <span class="hs-varid">b1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">b2</span><span class="hs-layout">,</span>
<a name="line-129"></a>                 <span class="hs-varid">c1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">c2</span><span class="hs-layout">,</span> <span class="hs-varid">d1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">d2</span><span class="hs-layout">)</span>
<a name="line-130"></a>
<a name="line-131"></a><a name="instance%20Monoid%20(a,b,c,d,e)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Monoid</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">e</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span>
<a name="line-132"></a>                <span class="hs-conid">Monoid</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-133"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">mempty</span><span class="hs-layout">,</span> <span class="hs-varid">mempty</span><span class="hs-layout">,</span> <span class="hs-varid">mempty</span><span class="hs-layout">,</span> <span class="hs-varid">mempty</span><span class="hs-layout">,</span> <span class="hs-varid">mempty</span><span class="hs-layout">)</span>
<a name="line-134"></a>        <span class="hs-layout">(</span><span class="hs-varid">a1</span><span class="hs-layout">,</span><span class="hs-varid">b1</span><span class="hs-layout">,</span><span class="hs-varid">c1</span><span class="hs-layout">,</span><span class="hs-varid">d1</span><span class="hs-layout">,</span><span class="hs-varid">e1</span><span class="hs-layout">)</span> <span class="hs-varop">`mappend`</span> <span class="hs-layout">(</span><span class="hs-varid">a2</span><span class="hs-layout">,</span><span class="hs-varid">b2</span><span class="hs-layout">,</span><span class="hs-varid">c2</span><span class="hs-layout">,</span><span class="hs-varid">d2</span><span class="hs-layout">,</span><span class="hs-varid">e2</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span>
<a name="line-135"></a>                <span class="hs-layout">(</span><span class="hs-varid">a1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">a2</span><span class="hs-layout">,</span> <span class="hs-varid">b1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">b2</span><span class="hs-layout">,</span> <span class="hs-varid">c1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">c2</span><span class="hs-layout">,</span>
<a name="line-136"></a>                 <span class="hs-varid">d1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">d2</span><span class="hs-layout">,</span> <span class="hs-varid">e1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">e2</span><span class="hs-layout">)</span>
<a name="line-137"></a>
<a name="line-138"></a><a name="instance%20Monoid%20Ordering"></a><span class="hs-comment">-- lexicographical ordering</span>
<a name="line-139"></a><a name="instance%20Monoid%20Ordering"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Monoid</span> <span class="hs-conid">Ordering</span> <span class="hs-keyword">where</span>
<a name="line-140"></a>        <span class="hs-varid">mempty</span>         <span class="hs-keyglyph">=</span> <span class="hs-conid">EQ</span>
<a name="line-141"></a>        <span class="hs-conid">LT</span> <span class="hs-varop">`mappend`</span> <span class="hs-keyword">_</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">LT</span>
<a name="line-142"></a>        <span class="hs-conid">EQ</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">y</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">y</span>
<a name="line-143"></a>        <span class="hs-conid">GT</span> <span class="hs-varop">`mappend`</span> <span class="hs-keyword">_</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">GT</span>
<a name="line-144"></a>
<a name="line-145"></a><a name="Dual"></a><span class="hs-comment">-- | The dual of a monoid, obtained by swapping the arguments of 'mappend'.</span>
<a name="line-146"></a><a name="Dual"></a><span class="hs-keyword">newtype</span> <span class="hs-conid">Dual</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Dual</span> <span class="hs-layout">{</span> <span class="hs-varid">getDual</span> <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-layout">}</span>
<a name="line-147"></a>        <span class="hs-keyword">deriving</span> <span class="hs-layout">(</span><span class="hs-conid">Eq</span><span class="hs-layout">,</span> <span class="hs-conid">Ord</span><span class="hs-layout">,</span> <span class="hs-conid">Read</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span><span class="hs-layout">,</span> <span class="hs-conid">Bounded</span><span class="hs-layout">)</span>
<a name="line-148"></a>
<a name="line-149"></a><a name="instance%20Monoid%20(Dual%20a)"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Monoid</span> <span class="hs-layout">(</span><span class="hs-conid">Dual</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-150"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Dual</span> <span class="hs-varid">mempty</span>
<a name="line-151"></a>        <span class="hs-conid">Dual</span> <span class="hs-varid">x</span> <span class="hs-varop">`mappend`</span> <span class="hs-conid">Dual</span> <span class="hs-varid">y</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Dual</span> <span class="hs-layout">(</span><span class="hs-varid">y</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">x</span><span class="hs-layout">)</span>
<a name="line-152"></a>
<a name="line-153"></a><a name="Endo"></a><span class="hs-comment">-- | The monoid of endomorphisms under composition.</span>
<a name="line-154"></a><a name="Endo"></a><span class="hs-keyword">newtype</span> <span class="hs-conid">Endo</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Endo</span> <span class="hs-layout">{</span> <span class="hs-varid">appEndo</span> <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-layout">}</span>
<a name="line-155"></a>
<a name="line-156"></a><a name="instance%20Monoid%20(Endo%20a)"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Monoid</span> <span class="hs-layout">(</span><span class="hs-conid">Endo</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-157"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Endo</span> <span class="hs-varid">id</span>
<a name="line-158"></a>        <span class="hs-conid">Endo</span> <span class="hs-varid">f</span> <span class="hs-varop">`mappend`</span> <span class="hs-conid">Endo</span> <span class="hs-varid">g</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Endo</span> <span class="hs-layout">(</span><span class="hs-varid">f</span> <span class="hs-varop">.</span> <span class="hs-varid">g</span><span class="hs-layout">)</span>
<a name="line-159"></a>
<a name="line-160"></a><a name="All"></a><span class="hs-comment">-- | Boolean monoid under conjunction.</span>
<a name="line-161"></a><a name="All"></a><span class="hs-keyword">newtype</span> <span class="hs-conid">All</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">All</span> <span class="hs-layout">{</span> <span class="hs-varid">getAll</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Bool</span> <span class="hs-layout">}</span>
<a name="line-162"></a>        <span class="hs-keyword">deriving</span> <span class="hs-layout">(</span><span class="hs-conid">Eq</span><span class="hs-layout">,</span> <span class="hs-conid">Ord</span><span class="hs-layout">,</span> <span class="hs-conid">Read</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span><span class="hs-layout">,</span> <span class="hs-conid">Bounded</span><span class="hs-layout">)</span>
<a name="line-163"></a>
<a name="line-164"></a><a name="instance%20Monoid%20All"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Monoid</span> <span class="hs-conid">All</span> <span class="hs-keyword">where</span>
<a name="line-165"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">All</span> <span class="hs-conid">True</span>
<a name="line-166"></a>        <span class="hs-conid">All</span> <span class="hs-varid">x</span> <span class="hs-varop">`mappend`</span> <span class="hs-conid">All</span> <span class="hs-varid">y</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">All</span> <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">&amp;&amp;</span> <span class="hs-varid">y</span><span class="hs-layout">)</span>
<a name="line-167"></a>
<a name="line-168"></a><a name="Any"></a><span class="hs-comment">-- | Boolean monoid under disjunction.</span>
<a name="line-169"></a><a name="Any"></a><span class="hs-keyword">newtype</span> <span class="hs-conid">Any</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Any</span> <span class="hs-layout">{</span> <span class="hs-varid">getAny</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Bool</span> <span class="hs-layout">}</span>
<a name="line-170"></a>        <span class="hs-keyword">deriving</span> <span class="hs-layout">(</span><span class="hs-conid">Eq</span><span class="hs-layout">,</span> <span class="hs-conid">Ord</span><span class="hs-layout">,</span> <span class="hs-conid">Read</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span><span class="hs-layout">,</span> <span class="hs-conid">Bounded</span><span class="hs-layout">)</span>
<a name="line-171"></a>
<a name="line-172"></a><a name="instance%20Monoid%20Any"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Monoid</span> <span class="hs-conid">Any</span> <span class="hs-keyword">where</span>
<a name="line-173"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Any</span> <span class="hs-conid">False</span>
<a name="line-174"></a>        <span class="hs-conid">Any</span> <span class="hs-varid">x</span> <span class="hs-varop">`mappend`</span> <span class="hs-conid">Any</span> <span class="hs-varid">y</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Any</span> <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">||</span> <span class="hs-varid">y</span><span class="hs-layout">)</span>
<a name="line-175"></a>
<a name="line-176"></a><a name="Sum"></a><span class="hs-comment">-- | Monoid under addition.</span>
<a name="line-177"></a><a name="Sum"></a><span class="hs-keyword">newtype</span> <span class="hs-conid">Sum</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Sum</span> <span class="hs-layout">{</span> <span class="hs-varid">getSum</span> <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-layout">}</span>
<a name="line-178"></a>        <span class="hs-keyword">deriving</span> <span class="hs-layout">(</span><span class="hs-conid">Eq</span><span class="hs-layout">,</span> <span class="hs-conid">Ord</span><span class="hs-layout">,</span> <span class="hs-conid">Read</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span><span class="hs-layout">,</span> <span class="hs-conid">Bounded</span><span class="hs-layout">)</span>
<a name="line-179"></a>
<a name="line-180"></a><a name="instance%20Monoid%20(Sum%20a)"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Num</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Monoid</span> <span class="hs-layout">(</span><span class="hs-conid">Sum</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-181"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Sum</span> <span class="hs-num">0</span>
<a name="line-182"></a>        <span class="hs-conid">Sum</span> <span class="hs-varid">x</span> <span class="hs-varop">`mappend`</span> <span class="hs-conid">Sum</span> <span class="hs-varid">y</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Sum</span> <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">+</span> <span class="hs-varid">y</span><span class="hs-layout">)</span>
<a name="line-183"></a>
<a name="line-184"></a><a name="Product"></a><span class="hs-comment">-- | Monoid under multiplication.</span>
<a name="line-185"></a><a name="Product"></a><span class="hs-keyword">newtype</span> <span class="hs-conid">Product</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Product</span> <span class="hs-layout">{</span> <span class="hs-varid">getProduct</span> <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-layout">}</span>
<a name="line-186"></a>        <span class="hs-keyword">deriving</span> <span class="hs-layout">(</span><span class="hs-conid">Eq</span><span class="hs-layout">,</span> <span class="hs-conid">Ord</span><span class="hs-layout">,</span> <span class="hs-conid">Read</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span><span class="hs-layout">,</span> <span class="hs-conid">Bounded</span><span class="hs-layout">)</span>
<a name="line-187"></a>
<a name="line-188"></a><a name="instance%20Monoid%20(Product%20a)"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Num</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Monoid</span> <span class="hs-layout">(</span><span class="hs-conid">Product</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-189"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Product</span> <span class="hs-num">1</span>
<a name="line-190"></a>        <span class="hs-conid">Product</span> <span class="hs-varid">x</span> <span class="hs-varop">`mappend`</span> <span class="hs-conid">Product</span> <span class="hs-varid">y</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Product</span> <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">*</span> <span class="hs-varid">y</span><span class="hs-layout">)</span>
<a name="line-191"></a>
<a name="line-192"></a><span class="hs-comment">-- $MaybeExamples</span>
<a name="line-193"></a><span class="hs-comment">-- To implement @find@ or @findLast@ on any 'Foldable':</span>
<a name="line-194"></a><span class="hs-comment">--</span>
<a name="line-195"></a><span class="hs-comment">-- @</span>
<a name="line-196"></a><span class="hs-comment">-- findLast :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a</span>
<a name="line-197"></a><span class="hs-comment">-- findLast pred = getLast . foldMap (\x -&gt; if pred x</span>
<a name="line-198"></a><span class="hs-comment">--                                            then Last (Just x)</span>
<a name="line-199"></a><span class="hs-comment">--                                            else Last Nothing)</span>
<a name="line-200"></a><span class="hs-comment">-- @</span>
<a name="line-201"></a><span class="hs-comment">--</span>
<a name="line-202"></a><span class="hs-comment">-- Much of Data.Map's interface can be implemented with</span>
<a name="line-203"></a><span class="hs-comment">-- Data.Map.alter. Some of the rest can be implemented with a new</span>
<a name="line-204"></a><span class="hs-comment">-- @alterA@ function and either 'First' or 'Last':</span>
<a name="line-205"></a><span class="hs-comment">--</span>
<a name="line-206"></a><span class="hs-comment">-- &gt; alterA :: (Applicative f, Ord k) =&gt;</span>
<a name="line-207"></a><span class="hs-comment">-- &gt;           (Maybe a -&gt; f (Maybe a)) -&gt; k -&gt; Map k a -&gt; f (Map k a)</span>
<a name="line-208"></a><span class="hs-comment">-- &gt;</span>
<a name="line-209"></a><span class="hs-comment">-- &gt; instance Monoid a =&gt; Applicative ((,) a)  -- from Control.Applicative</span>
<a name="line-210"></a><span class="hs-comment">--</span>
<a name="line-211"></a><span class="hs-comment">-- @</span>
<a name="line-212"></a><span class="hs-comment">-- insertLookupWithKey :: Ord k =&gt; (k -&gt; v -&gt; v -&gt; v) -&gt; k -&gt; v</span>
<a name="line-213"></a><span class="hs-comment">--                     -&gt; Map k v -&gt; (Maybe v, Map k v)</span>
<a name="line-214"></a><span class="hs-comment">-- insertLookupWithKey combine key value =</span>
<a name="line-215"></a><span class="hs-comment">--   Arrow.first getFirst . alterA doChange key</span>
<a name="line-216"></a><span class="hs-comment">--   where</span>
<a name="line-217"></a><span class="hs-comment">--   doChange Nothing = (First Nothing, Just value)</span>
<a name="line-218"></a><span class="hs-comment">--   doChange (Just oldValue) =</span>
<a name="line-219"></a><span class="hs-comment">--     (First (Just oldValue),</span>
<a name="line-220"></a><span class="hs-comment">--      Just (combine key value oldValue))</span>
<a name="line-221"></a><span class="hs-comment">-- @</span>
<a name="line-222"></a>
<a name="line-223"></a><a name="instance%20Monoid%20(Maybe%20a)"></a><span class="hs-comment">-- | Lift a semigroup into 'Maybe' forming a 'Monoid' according to</span>
<a name="line-224"></a><a name="instance%20Monoid%20(Maybe%20a)"></a><span class="hs-comment">-- &lt;<a href="http://en.wikipedia.org/wiki/Monoid">http://en.wikipedia.org/wiki/Monoid</a>&gt;: \&quot;Any semigroup @S@ may be</span>
<a name="line-225"></a><a name="instance%20Monoid%20(Maybe%20a)"></a><span class="hs-comment">-- turned into a monoid simply by adjoining an element @e@ not in @S@</span>
<a name="line-226"></a><a name="instance%20Monoid%20(Maybe%20a)"></a><span class="hs-comment">-- and defining @e*e = e@ and @e*s = s = s*e@ for all @s âˆˆ S@.\&quot; Since</span>
<a name="line-227"></a><a name="instance%20Monoid%20(Maybe%20a)"></a><span class="hs-comment">-- there is no \&quot;Semigroup\&quot; typeclass providing just 'mappend', we</span>
<a name="line-228"></a><a name="instance%20Monoid%20(Maybe%20a)"></a><span class="hs-comment">-- use 'Monoid' instead.</span>
<a name="line-229"></a><a name="instance%20Monoid%20(Maybe%20a)"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Monoid</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Monoid</span> <span class="hs-layout">(</span><span class="hs-conid">Maybe</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-230"></a>  <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Nothing</span>
<a name="line-231"></a>  <span class="hs-conid">Nothing</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">m</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">m</span>
<a name="line-232"></a>  <span class="hs-varid">m</span> <span class="hs-varop">`mappend`</span> <span class="hs-conid">Nothing</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">m</span>
<a name="line-233"></a>  <span class="hs-conid">Just</span> <span class="hs-varid">m1</span> <span class="hs-varop">`mappend`</span> <span class="hs-conid">Just</span> <span class="hs-varid">m2</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Just</span> <span class="hs-layout">(</span><span class="hs-varid">m1</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">m2</span><span class="hs-layout">)</span>
<a name="line-234"></a>
<a name="line-235"></a>
<a name="line-236"></a><a name="First"></a><span class="hs-comment">-- | Maybe monoid returning the leftmost non-Nothing value.</span>
<a name="line-237"></a><a name="First"></a><span class="hs-keyword">newtype</span> <span class="hs-conid">First</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">First</span> <span class="hs-layout">{</span> <span class="hs-varid">getFirst</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Maybe</span> <span class="hs-varid">a</span> <span class="hs-layout">}</span>
<a name="line-238"></a>        <span class="hs-keyword">deriving</span> <span class="hs-layout">(</span><span class="hs-conid">Eq</span><span class="hs-layout">,</span> <span class="hs-conid">Ord</span><span class="hs-layout">,</span> <span class="hs-conid">Read</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span><span class="hs-layout">)</span>
<a name="line-239"></a>
<a name="line-240"></a><a name="instance%20Monoid%20(First%20a)"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Monoid</span> <span class="hs-layout">(</span><span class="hs-conid">First</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-241"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">First</span> <span class="hs-conid">Nothing</span>
<a name="line-242"></a>        <span class="hs-varid">r</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">First</span> <span class="hs-layout">(</span><span class="hs-conid">Just</span> <span class="hs-keyword">_</span><span class="hs-layout">)</span><span class="hs-layout">)</span> <span class="hs-varop">`mappend`</span> <span class="hs-keyword">_</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">r</span>
<a name="line-243"></a>        <span class="hs-conid">First</span> <span class="hs-conid">Nothing</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">r</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">r</span>
<a name="line-244"></a>
<a name="line-245"></a><a name="Last"></a><span class="hs-comment">-- | Maybe monoid returning the rightmost non-Nothing value.</span>
<a name="line-246"></a><a name="Last"></a><span class="hs-keyword">newtype</span> <span class="hs-conid">Last</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Last</span> <span class="hs-layout">{</span> <span class="hs-varid">getLast</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Maybe</span> <span class="hs-varid">a</span> <span class="hs-layout">}</span>
<a name="line-247"></a>        <span class="hs-keyword">deriving</span> <span class="hs-layout">(</span><span class="hs-conid">Eq</span><span class="hs-layout">,</span> <span class="hs-conid">Ord</span><span class="hs-layout">,</span> <span class="hs-conid">Read</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span><span class="hs-layout">)</span>
<a name="line-248"></a>
<a name="line-249"></a><a name="instance%20Monoid%20(Last%20a)"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Monoid</span> <span class="hs-layout">(</span><span class="hs-conid">Last</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-250"></a>        <span class="hs-varid">mempty</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Last</span> <span class="hs-conid">Nothing</span>
<a name="line-251"></a>        <span class="hs-keyword">_</span> <span class="hs-varop">`mappend`</span> <span class="hs-varid">r</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">Last</span> <span class="hs-layout">(</span><span class="hs-conid">Just</span> <span class="hs-keyword">_</span><span class="hs-layout">)</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">r</span>
<a name="line-252"></a>        <span class="hs-varid">r</span> <span class="hs-varop">`mappend`</span> <span class="hs-conid">Last</span> <span class="hs-conid">Nothing</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">r</span>
<a name="line-253"></a>
<a name="line-254"></a><span class="hs-comment">{-
<a name="line-255"></a>{--------------------------------------------------------------------
<a name="line-256"></a>  Testing
<a name="line-257"></a>--------------------------------------------------------------------}
<a name="line-258"></a>instance Arbitrary a =&gt; Arbitrary (Maybe a) where
<a name="line-259"></a>  arbitrary = oneof [return Nothing, Just `fmap` arbitrary]
<a name="line-260"></a>
<a name="line-261"></a>prop_mconcatMaybe :: [Maybe [Int]] -&gt; Bool
<a name="line-262"></a>prop_mconcatMaybe x =
<a name="line-263"></a>  fromMaybe [] (mconcat x) == mconcat (catMaybes x)
<a name="line-264"></a>
<a name="line-265"></a>prop_mconcatFirst :: [Maybe Int] -&gt; Bool
<a name="line-266"></a>prop_mconcatFirst x =
<a name="line-267"></a>  getFirst (mconcat (map First x)) == listToMaybe (catMaybes x)
<a name="line-268"></a>prop_mconcatLast :: [Maybe Int] -&gt; Bool
<a name="line-269"></a>prop_mconcatLast x =
<a name="line-270"></a>  getLast (mconcat (map Last x)) == listLastToMaybe (catMaybes x)
<a name="line-271"></a>        where listLastToMaybe [] = Nothing
<a name="line-272"></a>              listLastToMaybe lst = Just (last lst)
<a name="line-273"></a>-- -}</span>
<a name="line-274"></a>
</pre></body>
</html>
