<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>GHC/Show.lhs</title>
<link type="text/css" rel="stylesheet" href="hscolour.css"></link>
</head>
<body>
\begin{code}
<pre><a name="line-1"></a><span class="hs-comment">{-# LANGUAGE Trustworthy #-}</span>
<a name="line-2"></a><span class="hs-comment">{-# LANGUAGE CPP, NoImplicitPrelude, BangPatterns, StandaloneDeriving,
<a name="line-3"></a>             MagicHash, UnboxedTuples #-}</span>
<a name="line-4"></a><span class="hs-comment">{-# OPTIONS_HADDOCK hide #-}</span>
<a name="line-5"></a>
<a name="line-6"></a><span class="hs-cpp">#include &quot;MachDeps.h&quot;</span>
<a name="line-7"></a><span class="hs-cpp">#if SIZEOF_HSWORD == 4</span>
<a name="line-8"></a><span class="hs-cpp">#define DIGITS       9</span>
<a name="line-9"></a><span class="hs-cpp">#define BASE         1000000000</span>
<a name="line-10"></a><span class="hs-cpp">#elif SIZEOF_HSWORD == 8</span>
<a name="line-11"></a><span class="hs-cpp">#define DIGITS       18</span>
<a name="line-12"></a><span class="hs-cpp">#define BASE         1000000000000000000</span>
<a name="line-13"></a><span class="hs-cpp">#else</span>
<a name="line-14"></a><span class="hs-cpp">#error Please define DIGITS and BASE</span>
<a name="line-15"></a><span class="hs-comment">-- DIGITS should be the largest integer such that</span>
<a name="line-16"></a><span class="hs-comment">--     10^DIGITS &lt; 2^(SIZEOF_HSWORD * 8 - 1)</span>
<a name="line-17"></a><span class="hs-comment">-- BASE should be 10^DIGITS. Note that ^ is not available yet.</span>
<a name="line-18"></a><span class="hs-cpp">#endif</span>
<a name="line-19"></a>
<a name="line-20"></a><span class="hs-comment">-----------------------------------------------------------------------------</span>
<a name="line-21"></a><span class="hs-comment">-- |</span>
<a name="line-22"></a><span class="hs-comment">-- Module      :  GHC.Show</span>
<a name="line-23"></a><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow, 1992-2002</span>
<a name="line-24"></a><span class="hs-comment">-- License     :  see libraries/base/LICENSE</span>
<a name="line-25"></a><span class="hs-comment">--</span>
<a name="line-26"></a><span class="hs-comment">-- Maintainer  :  cvs-ghc@haskell.org</span>
<a name="line-27"></a><span class="hs-comment">-- Stability   :  internal</span>
<a name="line-28"></a><span class="hs-comment">-- Portability :  non-portable (GHC Extensions)</span>
<a name="line-29"></a><span class="hs-comment">--</span>
<a name="line-30"></a><span class="hs-comment">-- The 'Show' class, and related operations.</span>
<a name="line-31"></a><span class="hs-comment">--</span>
<a name="line-32"></a><span class="hs-comment">-----------------------------------------------------------------------------</span>
<a name="line-33"></a>
<a name="line-34"></a><span class="hs-comment">-- #hide</span>
<a name="line-35"></a><span class="hs-keyword">module</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Show</span>
<a name="line-36"></a>        <span class="hs-layout">(</span>
<a name="line-37"></a>        <span class="hs-conid">Show</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-conid">ShowS</span><span class="hs-layout">,</span>
<a name="line-38"></a>
<a name="line-39"></a>        <span class="hs-comment">-- Instances for Show: (), [], Bool, Ordering, Int, Char</span>
<a name="line-40"></a>
<a name="line-41"></a>        <span class="hs-comment">-- Show support code</span>
<a name="line-42"></a>        <span class="hs-varid">shows</span><span class="hs-layout">,</span> <span class="hs-varid">showChar</span><span class="hs-layout">,</span> <span class="hs-varid">showString</span><span class="hs-layout">,</span> <span class="hs-varid">showMultiLineString</span><span class="hs-layout">,</span>
<a name="line-43"></a>        <span class="hs-varid">showParen</span><span class="hs-layout">,</span> <span class="hs-varid">showList__</span><span class="hs-layout">,</span> <span class="hs-varid">showSpace</span><span class="hs-layout">,</span>
<a name="line-44"></a>        <span class="hs-varid">showLitChar</span><span class="hs-layout">,</span> <span class="hs-varid">showLitString</span><span class="hs-layout">,</span> <span class="hs-varid">protectEsc</span><span class="hs-layout">,</span>
<a name="line-45"></a>        <span class="hs-varid">intToDigit</span><span class="hs-layout">,</span> <span class="hs-varid">showSignedInt</span><span class="hs-layout">,</span>
<a name="line-46"></a>        <span class="hs-varid">appPrec</span><span class="hs-layout">,</span> <span class="hs-varid">appPrec1</span><span class="hs-layout">,</span>
<a name="line-47"></a>
<a name="line-48"></a>        <span class="hs-comment">-- Character operations</span>
<a name="line-49"></a>        <span class="hs-varid">asciiTab</span><span class="hs-layout">,</span>
<a name="line-50"></a>  <span class="hs-layout">)</span>
<a name="line-51"></a>        <span class="hs-keyword">where</span>
<a name="line-52"></a>
<a name="line-53"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Base</span>
<a name="line-54"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Num</span>
<a name="line-55"></a><span class="hs-keyword">import</span> <span class="hs-conid">Data</span><span class="hs-varop">.</span><span class="hs-conid">Maybe</span>
<a name="line-56"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">List</span> <span class="hs-layout">(</span><span class="hs-layout">(</span><span class="hs-varop">!!</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-varid">foldr1</span><span class="hs-layout">,</span> <span class="hs-varid">break</span><span class="hs-layout">)</span>
</pre>\end{code}



%*********************************************************
%*                                                      *
\subsection{The @Show@ class}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="ShowS"></a><span class="hs-comment">-- | The @shows@ functions return a function that prepends the</span>
<a name="line-2"></a><a name="ShowS"></a><span class="hs-comment">-- output 'String' to an existing 'String'.  This allows constant-time</span>
<a name="line-3"></a><a name="ShowS"></a><span class="hs-comment">-- concatenation of results using function composition.</span>
<a name="line-4"></a><a name="ShowS"></a><span class="hs-keyword">type</span> <span class="hs-conid">ShowS</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span>
<a name="line-5"></a>
<a name="line-6"></a><span class="hs-comment">-- | Conversion of values to readable 'String's.</span>
<a name="line-7"></a><span class="hs-comment">--</span>
<a name="line-8"></a><span class="hs-comment">-- Minimal complete definition: 'showsPrec' or 'show'.</span>
<a name="line-9"></a><span class="hs-comment">--</span>
<a name="line-10"></a><span class="hs-comment">-- Derived instances of 'Show' have the following properties, which</span>
<a name="line-11"></a><span class="hs-comment">-- are compatible with derived instances of 'Text.Read.Read':</span>
<a name="line-12"></a><span class="hs-comment">--</span>
<a name="line-13"></a><span class="hs-comment">-- * The result of 'show' is a syntactically correct Haskell</span>
<a name="line-14"></a><span class="hs-comment">--   expression containing only constants, given the fixity</span>
<a name="line-15"></a><span class="hs-comment">--   declarations in force at the point where the type is declared.</span>
<a name="line-16"></a><span class="hs-comment">--   It contains only the constructor names defined in the data type,</span>
<a name="line-17"></a><span class="hs-comment">--   parentheses, and spaces.  When labelled constructor fields are</span>
<a name="line-18"></a><span class="hs-comment">--   used, braces, commas, field names, and equal signs are also used.</span>
<a name="line-19"></a><span class="hs-comment">--</span>
<a name="line-20"></a><span class="hs-comment">-- * If the constructor is defined to be an infix operator, then</span>
<a name="line-21"></a><span class="hs-comment">--   'showsPrec' will produce infix applications of the constructor.</span>
<a name="line-22"></a><span class="hs-comment">--</span>
<a name="line-23"></a><span class="hs-comment">-- * the representation will be enclosed in parentheses if the</span>
<a name="line-24"></a><span class="hs-comment">--   precedence of the top-level constructor in @x@ is less than @d@</span>
<a name="line-25"></a><span class="hs-comment">--   (associativity is ignored).  Thus, if @d@ is @0@ then the result</span>
<a name="line-26"></a><span class="hs-comment">--   is never surrounded in parentheses; if @d@ is @11@ it is always</span>
<a name="line-27"></a><span class="hs-comment">--   surrounded in parentheses, unless it is an atomic expression.</span>
<a name="line-28"></a><span class="hs-comment">--</span>
<a name="line-29"></a><span class="hs-comment">-- * If the constructor is defined using record syntax, then 'show'</span>
<a name="line-30"></a><span class="hs-comment">--   will produce the record-syntax form, with the fields given in the</span>
<a name="line-31"></a><span class="hs-comment">--   same order as the original declaration.</span>
<a name="line-32"></a><span class="hs-comment">--</span>
<a name="line-33"></a><span class="hs-comment">-- For example, given the declarations</span>
<a name="line-34"></a><span class="hs-comment">--</span>
<a name="line-35"></a><span class="hs-comment">-- &gt; infixr 5 :^:</span>
<a name="line-36"></a><span class="hs-comment">-- &gt; data Tree a =  Leaf a  |  Tree a :^: Tree a</span>
<a name="line-37"></a><span class="hs-comment">--</span>
<a name="line-38"></a><span class="hs-comment">-- the derived instance of 'Show' is equivalent to</span>
<a name="line-39"></a><span class="hs-comment">--</span>
<a name="line-40"></a><span class="hs-comment">-- &gt; instance (Show a) =&gt; Show (Tree a) where</span>
<a name="line-41"></a><span class="hs-comment">-- &gt;</span>
<a name="line-42"></a><span class="hs-comment">-- &gt;        showsPrec d (Leaf m) = showParen (d &gt; app_prec) $</span>
<a name="line-43"></a><span class="hs-comment">-- &gt;             showString &quot;Leaf &quot; . showsPrec (app_prec+1) m</span>
<a name="line-44"></a><span class="hs-comment">-- &gt;          where app_prec = 10</span>
<a name="line-45"></a><span class="hs-comment">-- &gt;</span>
<a name="line-46"></a><span class="hs-comment">-- &gt;        showsPrec d (u :^: v) = showParen (d &gt; up_prec) $</span>
<a name="line-47"></a><span class="hs-comment">-- &gt;             showsPrec (up_prec+1) u .</span>
<a name="line-48"></a><span class="hs-comment">-- &gt;             showString &quot; :^: &quot;      .</span>
<a name="line-49"></a><span class="hs-comment">-- &gt;             showsPrec (up_prec+1) v</span>
<a name="line-50"></a><span class="hs-comment">-- &gt;          where up_prec = 5</span>
<a name="line-51"></a><span class="hs-comment">--</span>
<a name="line-52"></a><span class="hs-comment">-- Note that right-associativity of @:^:@ is ignored.  For example,</span>
<a name="line-53"></a><span class="hs-comment">--</span>
<a name="line-54"></a><span class="hs-comment">-- * @'show' (Leaf 1 :^: Leaf 2 :^: Leaf 3)@ produces the string</span>
<a name="line-55"></a><span class="hs-comment">--   @\&quot;Leaf 1 :^: (Leaf 2 :^: Leaf 3)\&quot;@.</span>
<a name="line-56"></a>
<a name="line-57"></a><a name="Show"></a><span class="hs-keyword">class</span>  <span class="hs-conid">Show</span> <span class="hs-varid">a</span>  <span class="hs-keyword">where</span>
<a name="line-58"></a>    <span class="hs-comment">-- | Convert a value to a readable 'String'.</span>
<a name="line-59"></a>    <span class="hs-comment">--</span>
<a name="line-60"></a>    <span class="hs-comment">-- 'showsPrec' should satisfy the law</span>
<a name="line-61"></a>    <span class="hs-comment">--</span>
<a name="line-62"></a>    <span class="hs-comment">-- &gt; showsPrec d x r ++ s  ==  showsPrec d x (r ++ s)</span>
<a name="line-63"></a>    <span class="hs-comment">--</span>
<a name="line-64"></a>    <span class="hs-comment">-- Derived instances of 'Text.Read.Read' and 'Show' satisfy the following:</span>
<a name="line-65"></a>    <span class="hs-comment">--</span>
<a name="line-66"></a>    <span class="hs-comment">-- * @(x,\&quot;\&quot;)@ is an element of</span>
<a name="line-67"></a>    <span class="hs-comment">--   @('Text.Read.readsPrec' d ('showsPrec' d x \&quot;\&quot;))@.</span>
<a name="line-68"></a>    <span class="hs-comment">--</span>
<a name="line-69"></a>    <span class="hs-comment">-- That is, 'Text.Read.readsPrec' parses the string produced by</span>
<a name="line-70"></a>    <span class="hs-comment">-- 'showsPrec', and delivers the value that 'showsPrec' started with.</span>
<a name="line-71"></a>
<a name="line-72"></a>    <span class="hs-varid">showsPrec</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span>    <span class="hs-comment">-- ^ the operator precedence of the enclosing</span>
<a name="line-73"></a>                        <span class="hs-comment">-- context (a number from @0@ to @11@).</span>
<a name="line-74"></a>                        <span class="hs-comment">-- Function application has precedence @10@.</span>
<a name="line-75"></a>              <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>      <span class="hs-comment">-- ^ the value to be converted to a 'String'</span>
<a name="line-76"></a>              <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-77"></a>
<a name="line-78"></a>    <span class="hs-comment">-- | A specialised variant of 'showsPrec', using precedence context</span>
<a name="line-79"></a>    <span class="hs-comment">-- zero, and returning an ordinary 'String'.</span>
<a name="line-80"></a>    <span class="hs-varid">show</span>      <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span>   <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span>
<a name="line-81"></a>
<a name="line-82"></a>    <span class="hs-comment">-- | The method 'showList' is provided to allow the programmer to</span>
<a name="line-83"></a>    <span class="hs-comment">-- give a specialised way of showing lists of values.</span>
<a name="line-84"></a>    <span class="hs-comment">-- For example, this is used by the predefined 'Show' instance of</span>
<a name="line-85"></a>    <span class="hs-comment">-- the 'Char' type, where values of type 'String' should be shown</span>
<a name="line-86"></a>    <span class="hs-comment">-- in double quotes, rather than between square brackets.</span>
<a name="line-87"></a>    <span class="hs-varid">showList</span>  <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-88"></a>
<a name="line-89"></a>    <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-varid">x</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">show</span> <span class="hs-varid">x</span> <span class="hs-varop">++</span> <span class="hs-varid">s</span>
<a name="line-90"></a>    <span class="hs-varid">show</span> <span class="hs-varid">x</span>          <span class="hs-keyglyph">=</span> <span class="hs-varid">shows</span> <span class="hs-varid">x</span> <span class="hs-str">&quot;&quot;</span>
<a name="line-91"></a>    <span class="hs-varid">showList</span> <span class="hs-varid">ls</span>   <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showList__</span> <span class="hs-varid">shows</span> <span class="hs-varid">ls</span> <span class="hs-varid">s</span>
<a name="line-92"></a>
<a name="line-93"></a><a name="showList__"></a><span class="hs-definition">showList__</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span>  <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-94"></a><span class="hs-definition">showList__</span> <span class="hs-keyword">_</span>     <span class="hs-conid">[]</span>     <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-str">&quot;[]&quot;</span> <span class="hs-varop">++</span> <span class="hs-varid">s</span>
<a name="line-95"></a><span class="hs-definition">showList__</span> <span class="hs-varid">showx</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:</span><span class="hs-varid">xs</span><span class="hs-layout">)</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-chr">'['</span> <span class="hs-conop">:</span> <span class="hs-varid">showx</span> <span class="hs-varid">x</span> <span class="hs-layout">(</span><span class="hs-varid">showl</span> <span class="hs-varid">xs</span><span class="hs-layout">)</span>
<a name="line-96"></a>  <span class="hs-keyword">where</span>
<a name="line-97"></a>    <span class="hs-varid">showl</span> <span class="hs-conid">[]</span>     <span class="hs-keyglyph">=</span> <span class="hs-chr">']'</span> <span class="hs-conop">:</span> <span class="hs-varid">s</span>
<a name="line-98"></a>    <span class="hs-varid">showl</span> <span class="hs-layout">(</span><span class="hs-varid">y</span><span class="hs-conop">:</span><span class="hs-varid">ys</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-chr">','</span> <span class="hs-conop">:</span> <span class="hs-varid">showx</span> <span class="hs-varid">y</span> <span class="hs-layout">(</span><span class="hs-varid">showl</span> <span class="hs-varid">ys</span><span class="hs-layout">)</span>
<a name="line-99"></a>
<a name="line-100"></a><a name="appPrec"></a><span class="hs-definition">appPrec</span><span class="hs-layout">,</span> <span class="hs-varid">appPrec1</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span>
<a name="line-101"></a>        <span class="hs-comment">-- Use unboxed stuff because we don't have overloaded numerics yet</span>
<a name="line-102"></a><span class="hs-definition">appPrec</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">I</span><span class="hs-cpp">#</span> <span class="hs-num">10</span><span class="hs-cpp">#</span>        <span class="hs-comment">-- Precedence of application:</span>
<a name="line-103"></a>                        <span class="hs-comment">--   one more than the maximum operator precedence of 9</span>
<a name="line-104"></a><a name="appPrec1"></a><span class="hs-definition">appPrec1</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">I</span><span class="hs-cpp">#</span> <span class="hs-num">11</span><span class="hs-cpp">#</span>       <span class="hs-comment">-- appPrec + 1</span>
</pre>\end{code}

%*********************************************************
%*                                                      *
\subsection{Simple Instances}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a>
<a name="line-2"></a><a name="instance%20Show%20()"></a><span class="hs-keyword">instance</span>  <span class="hs-conid">Show</span> <span class="hs-conid">()</span>  <span class="hs-keyword">where</span>
<a name="line-3"></a>    <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-conid">()</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showString</span> <span class="hs-str">&quot;()&quot;</span>
<a name="line-4"></a>
<a name="line-5"></a><a name="instance%20Show%20%5ba%5d"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Show</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span>  <span class="hs-keyword">where</span>
<a name="line-6"></a>    <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span>         <span class="hs-keyglyph">=</span> <span class="hs-varid">showList</span>
<a name="line-7"></a>
<a name="line-8"></a><a name="instance%20Show%20Bool"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Show</span> <span class="hs-conid">Bool</span> <span class="hs-keyword">where</span>
<a name="line-9"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-conid">True</span>  <span class="hs-keyglyph">=</span> <span class="hs-varid">showString</span> <span class="hs-str">&quot;True&quot;</span>
<a name="line-10"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-conid">False</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showString</span> <span class="hs-str">&quot;False&quot;</span>
<a name="line-11"></a>
<a name="line-12"></a><a name="instance%20Show%20Ordering"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Show</span> <span class="hs-conid">Ordering</span> <span class="hs-keyword">where</span>
<a name="line-13"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-conid">LT</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showString</span> <span class="hs-str">&quot;LT&quot;</span>
<a name="line-14"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-conid">EQ</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showString</span> <span class="hs-str">&quot;EQ&quot;</span>
<a name="line-15"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-conid">GT</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showString</span> <span class="hs-str">&quot;GT&quot;</span>
<a name="line-16"></a>
<a name="line-17"></a><a name="instance%20Show%20Char"></a><span class="hs-keyword">instance</span>  <span class="hs-conid">Show</span> <span class="hs-conid">Char</span>  <span class="hs-keyword">where</span>
<a name="line-18"></a>    <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-chr">'\''</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showString</span> <span class="hs-str">&quot;'\\''&quot;</span>
<a name="line-19"></a>    <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-varid">c</span>    <span class="hs-keyglyph">=</span> <span class="hs-varid">showChar</span> <span class="hs-chr">'\''</span> <span class="hs-varop">.</span> <span class="hs-varid">showLitChar</span> <span class="hs-varid">c</span> <span class="hs-varop">.</span> <span class="hs-varid">showChar</span> <span class="hs-chr">'\''</span>
<a name="line-20"></a>
<a name="line-21"></a>    <span class="hs-varid">showList</span> <span class="hs-varid">cs</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showChar</span> <span class="hs-chr">'&quot;'</span> <span class="hs-varop">.</span> <span class="hs-varid">showLitString</span> <span class="hs-varid">cs</span> <span class="hs-varop">.</span> <span class="hs-varid">showChar</span> <span class="hs-chr">'&quot;'</span>
<a name="line-22"></a>
<a name="line-23"></a><a name="instance%20Show%20Int"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Show</span> <span class="hs-conid">Int</span> <span class="hs-keyword">where</span>
<a name="line-24"></a>    <span class="hs-varid">showsPrec</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showSignedInt</span>
<a name="line-25"></a>
<a name="line-26"></a><a name="instance%20Show%20Word"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Show</span> <span class="hs-conid">Word</span> <span class="hs-keyword">where</span>
<a name="line-27"></a>    <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">w</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showWord</span> <span class="hs-varid">w</span>
<a name="line-28"></a>
<a name="line-29"></a><a name="showWord"></a><span class="hs-definition">showWord</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Word</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-30"></a><span class="hs-definition">showWord</span> <span class="hs-varid">w</span><span class="hs-cpp">#</span> <span class="hs-varid">cs</span>
<a name="line-31"></a> <span class="hs-keyglyph">|</span> <span class="hs-varid">w</span><span class="hs-cpp">#</span> <span class="hs-varop">`</span><span class="hs-varid">ltWord</span><span class="hs-cpp">#</span><span class="hs-varop">`</span> <span class="hs-num">10</span><span class="hs-cpp">##</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">C</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">chr</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">ord</span><span class="hs-cpp">#</span> <span class="hs-chr">'0'</span><span class="hs-cpp">#</span> <span class="hs-varop">+#</span> <span class="hs-varid">word2Int</span><span class="hs-cpp">#</span> <span class="hs-varid">w</span><span class="hs-cpp">#</span><span class="hs-layout">)</span><span class="hs-layout">)</span> <span class="hs-conop">:</span> <span class="hs-varid">cs</span>
<a name="line-32"></a> <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">chr</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">ord</span><span class="hs-cpp">#</span> <span class="hs-chr">'0'</span><span class="hs-cpp">#</span> <span class="hs-varop">+#</span> <span class="hs-varid">word2Int</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">w</span><span class="hs-cpp">#</span> <span class="hs-varop">`</span><span class="hs-varid">remWord</span><span class="hs-cpp">#</span><span class="hs-varop">`</span> <span class="hs-num">10</span><span class="hs-cpp">##</span><span class="hs-layout">)</span><span class="hs-layout">)</span> <span class="hs-keyword">of</span>
<a name="line-33"></a>               <span class="hs-varid">c</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span>
<a name="line-34"></a>                   <span class="hs-varid">showWord</span> <span class="hs-layout">(</span><span class="hs-varid">w</span><span class="hs-cpp">#</span> <span class="hs-varop">`</span><span class="hs-varid">quotWord</span><span class="hs-cpp">#</span><span class="hs-varop">`</span> <span class="hs-num">10</span><span class="hs-cpp">##</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-conid">C</span><span class="hs-cpp">#</span> <span class="hs-varid">c</span><span class="hs-cpp">#</span> <span class="hs-conop">:</span> <span class="hs-varid">cs</span><span class="hs-layout">)</span>
<a name="line-35"></a>
<a name="line-36"></a><a name="instance%20Show%20(Maybe%20a)"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Show</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-conid">Maybe</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-37"></a>    <span class="hs-varid">showsPrec</span> <span class="hs-sel">_p</span> <span class="hs-conid">Nothing</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showString</span> <span class="hs-str">&quot;Nothing&quot;</span> <span class="hs-varid">s</span>
<a name="line-38"></a>    <span class="hs-varid">showsPrec</span> <span class="hs-varid">p</span> <span class="hs-layout">(</span><span class="hs-conid">Just</span> <span class="hs-varid">x</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
<a name="line-39"></a>                          <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">showParen</span> <span class="hs-layout">(</span><span class="hs-varid">p</span> <span class="hs-varop">&gt;</span> <span class="hs-varid">appPrec</span><span class="hs-layout">)</span> <span class="hs-varop">$</span>
<a name="line-40"></a>                             <span class="hs-varid">showString</span> <span class="hs-str">&quot;Just &quot;</span> <span class="hs-varop">.</span>
<a name="line-41"></a>                             <span class="hs-varid">showsPrec</span> <span class="hs-varid">appPrec1</span> <span class="hs-varid">x</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{Show instances for the first few tuples
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><span class="hs-comment">-- The explicit 's' parameters are important</span>
<a name="line-2"></a><span class="hs-comment">-- Otherwise GHC thinks that &quot;shows x&quot; might take a lot of work to compute</span>
<a name="line-3"></a><span class="hs-comment">-- and generates defns like</span>
<a name="line-4"></a><span class="hs-comment">--      showsPrec _ (x,y) = let sx = shows x; sy = shows y in</span>
<a name="line-5"></a><span class="hs-comment">--                          \s -&gt; showChar '(' (sx (showChar ',' (sy (showChar ')' s))))</span>
<a name="line-6"></a>
<a name="line-7"></a><a name="instance%20Show%20(a,b)"></a><span class="hs-keyword">instance</span>  <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">)</span>  <span class="hs-keyword">where</span>
<a name="line-8"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-9"></a>
<a name="line-10"></a><a name="instance%20Show%20(a,%20b,%20c)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">c</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-11"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">)</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-12"></a>
<a name="line-13"></a><a name="instance%20Show%20(a,%20b,%20c,%20d)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">d</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">d</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-14"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">)</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">d</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-15"></a>
<a name="line-16"></a><a name="instance%20Show%20(a,%20b,%20c,%20d,%20e)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">e</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-varid">e</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-17"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">)</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">e</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-18"></a>
<a name="line-19"></a><a name="instance%20Show%20(a,b,c,d,e,f)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">f</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-20"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">)</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">f</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-21"></a>
<a name="line-22"></a><a name="instance%20Show%20(a,b,c,d,e,f,g)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">g</span><span class="hs-layout">)</span>
<a name="line-23"></a>        <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-24"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
<a name="line-25"></a>        <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">g</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-26"></a>
<a name="line-27"></a><a name="instance%20Show%20(a,b,c,d,e,f,g,h)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">h</span><span class="hs-layout">)</span>
<a name="line-28"></a>         <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-29"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
<a name="line-30"></a>        <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">h</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-31"></a>
<a name="line-32"></a><a name="instance%20Show%20(a,b,c,d,e,f,g,h,i)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">h</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">i</span><span class="hs-layout">)</span>
<a name="line-33"></a>         <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-34"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
<a name="line-35"></a>        <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">h</span><span class="hs-layout">,</span>
<a name="line-36"></a>                      <span class="hs-varid">shows</span> <span class="hs-varid">i</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-37"></a>
<a name="line-38"></a><a name="instance%20Show%20(a,b,c,d,e,f,g,h,i,j)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">h</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">i</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">j</span><span class="hs-layout">)</span>
<a name="line-39"></a>         <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">,</span><span class="hs-varid">j</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-40"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">,</span><span class="hs-varid">j</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
<a name="line-41"></a>        <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">h</span><span class="hs-layout">,</span>
<a name="line-42"></a>                      <span class="hs-varid">shows</span> <span class="hs-varid">i</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">j</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-43"></a>
<a name="line-44"></a><a name="instance%20Show%20(a,b,c,d,e,f,g,h,i,j,k)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">h</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">i</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">j</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">k</span><span class="hs-layout">)</span>
<a name="line-45"></a>         <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">,</span><span class="hs-varid">j</span><span class="hs-layout">,</span><span class="hs-varid">k</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-46"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">,</span><span class="hs-varid">j</span><span class="hs-layout">,</span><span class="hs-varid">k</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
<a name="line-47"></a>        <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">h</span><span class="hs-layout">,</span>
<a name="line-48"></a>                      <span class="hs-varid">shows</span> <span class="hs-varid">i</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">j</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">k</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-49"></a>
<a name="line-50"></a><a name="instance%20Show%20(a,b,c,d,e,f,g,h,i,j,k,l)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">h</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">i</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">j</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">k</span><span class="hs-layout">,</span>
<a name="line-51"></a>          <span class="hs-conid">Show</span> <span class="hs-varid">l</span><span class="hs-layout">)</span>
<a name="line-52"></a>         <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">,</span><span class="hs-varid">j</span><span class="hs-layout">,</span><span class="hs-varid">k</span><span class="hs-layout">,</span><span class="hs-varid">l</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-53"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">,</span><span class="hs-varid">j</span><span class="hs-layout">,</span><span class="hs-varid">k</span><span class="hs-layout">,</span><span class="hs-varid">l</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
<a name="line-54"></a>        <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">h</span><span class="hs-layout">,</span>
<a name="line-55"></a>                      <span class="hs-varid">shows</span> <span class="hs-varid">i</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">j</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">k</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">l</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-56"></a>
<a name="line-57"></a><a name="instance%20Show%20(a,b,c,d,e,f,g,h,i,j,k,l,m)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">h</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">i</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">j</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">k</span><span class="hs-layout">,</span>
<a name="line-58"></a>          <span class="hs-conid">Show</span> <span class="hs-varid">l</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">m</span><span class="hs-layout">)</span>
<a name="line-59"></a>         <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">,</span><span class="hs-varid">j</span><span class="hs-layout">,</span><span class="hs-varid">k</span><span class="hs-layout">,</span><span class="hs-varid">l</span><span class="hs-layout">,</span><span class="hs-varid">m</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-60"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">,</span><span class="hs-varid">j</span><span class="hs-layout">,</span><span class="hs-varid">k</span><span class="hs-layout">,</span><span class="hs-varid">l</span><span class="hs-layout">,</span><span class="hs-varid">m</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
<a name="line-61"></a>        <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">h</span><span class="hs-layout">,</span>
<a name="line-62"></a>                      <span class="hs-varid">shows</span> <span class="hs-varid">i</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">j</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">k</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">l</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">m</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-63"></a>
<a name="line-64"></a><a name="instance%20Show%20(a,b,c,d,e,f,g,h,i,j,k,l,m,n)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">h</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">i</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">j</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">k</span><span class="hs-layout">,</span>
<a name="line-65"></a>          <span class="hs-conid">Show</span> <span class="hs-varid">l</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">m</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">n</span><span class="hs-layout">)</span>
<a name="line-66"></a>         <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">,</span><span class="hs-varid">j</span><span class="hs-layout">,</span><span class="hs-varid">k</span><span class="hs-layout">,</span><span class="hs-varid">l</span><span class="hs-layout">,</span><span class="hs-varid">m</span><span class="hs-layout">,</span><span class="hs-varid">n</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-67"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">,</span><span class="hs-varid">j</span><span class="hs-layout">,</span><span class="hs-varid">k</span><span class="hs-layout">,</span><span class="hs-varid">l</span><span class="hs-layout">,</span><span class="hs-varid">m</span><span class="hs-layout">,</span><span class="hs-varid">n</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
<a name="line-68"></a>        <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">h</span><span class="hs-layout">,</span>
<a name="line-69"></a>                      <span class="hs-varid">shows</span> <span class="hs-varid">i</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">j</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">k</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">l</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">m</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">n</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-70"></a>
<a name="line-71"></a><a name="instance%20Show%20(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o)"></a><span class="hs-keyword">instance</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">h</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">i</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">j</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">k</span><span class="hs-layout">,</span>
<a name="line-72"></a>          <span class="hs-conid">Show</span> <span class="hs-varid">l</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">m</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">n</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">o</span><span class="hs-layout">)</span>
<a name="line-73"></a>         <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">,</span><span class="hs-varid">j</span><span class="hs-layout">,</span><span class="hs-varid">k</span><span class="hs-layout">,</span><span class="hs-varid">l</span><span class="hs-layout">,</span><span class="hs-varid">m</span><span class="hs-layout">,</span><span class="hs-varid">n</span><span class="hs-layout">,</span><span class="hs-varid">o</span><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-74"></a>  <span class="hs-varid">showsPrec</span> <span class="hs-keyword">_</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">d</span><span class="hs-layout">,</span><span class="hs-varid">e</span><span class="hs-layout">,</span><span class="hs-varid">f</span><span class="hs-layout">,</span><span class="hs-varid">g</span><span class="hs-layout">,</span><span class="hs-varid">h</span><span class="hs-layout">,</span><span class="hs-varid">i</span><span class="hs-layout">,</span><span class="hs-varid">j</span><span class="hs-layout">,</span><span class="hs-varid">k</span><span class="hs-layout">,</span><span class="hs-varid">l</span><span class="hs-layout">,</span><span class="hs-varid">m</span><span class="hs-layout">,</span><span class="hs-varid">n</span><span class="hs-layout">,</span><span class="hs-varid">o</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
<a name="line-75"></a>        <span class="hs-keyglyph">=</span> <span class="hs-varid">show_tuple</span> <span class="hs-keyglyph">[</span><span class="hs-varid">shows</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">b</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">c</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">d</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">e</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">f</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">g</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">h</span><span class="hs-layout">,</span>
<a name="line-76"></a>                      <span class="hs-varid">shows</span> <span class="hs-varid">i</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">j</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">k</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">l</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">m</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">n</span><span class="hs-layout">,</span> <span class="hs-varid">shows</span> <span class="hs-varid">o</span><span class="hs-keyglyph">]</span> <span class="hs-varid">s</span>
<a name="line-77"></a>
<a name="line-78"></a><a name="show_tuple"></a><span class="hs-definition">show_tuple</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-conid">ShowS</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-79"></a><span class="hs-definition">show_tuple</span> <span class="hs-varid">ss</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showChar</span> <span class="hs-chr">'('</span>
<a name="line-80"></a>              <span class="hs-varop">.</span> <span class="hs-varid">foldr1</span> <span class="hs-layout">(</span><span class="hs-keyglyph">\</span><span class="hs-varid">s</span> <span class="hs-varid">r</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">s</span> <span class="hs-varop">.</span> <span class="hs-varid">showChar</span> <span class="hs-chr">','</span> <span class="hs-varop">.</span> <span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-varid">ss</span>
<a name="line-81"></a>              <span class="hs-varop">.</span> <span class="hs-varid">showChar</span> <span class="hs-chr">')'</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{Support code for @Show@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="shows"></a><span class="hs-comment">-- | equivalent to 'showsPrec' with a precedence of 0.</span>
<a name="line-2"></a><span class="hs-definition">shows</span>           <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-3"></a><span class="hs-definition">shows</span>           <span class="hs-keyglyph">=</span>  <span class="hs-varid">showsPrec</span> <span class="hs-num">0</span>
<a name="line-4"></a>
<a name="line-5"></a><a name="showChar"></a><span class="hs-comment">-- | utility function converting a 'Char' to a show function that</span>
<a name="line-6"></a><span class="hs-comment">-- simply prepends the character unchanged.</span>
<a name="line-7"></a><span class="hs-definition">showChar</span>        <span class="hs-keyglyph">::</span> <span class="hs-conid">Char</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-8"></a><span class="hs-definition">showChar</span>        <span class="hs-keyglyph">=</span>  <span class="hs-layout">(</span><span class="hs-conop">:</span><span class="hs-layout">)</span>
<a name="line-9"></a>
<a name="line-10"></a><a name="showString"></a><span class="hs-comment">-- | utility function converting a 'String' to a show function that</span>
<a name="line-11"></a><span class="hs-comment">-- simply prepends the string unchanged.</span>
<a name="line-12"></a><span class="hs-definition">showString</span>      <span class="hs-keyglyph">::</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-13"></a><span class="hs-definition">showString</span>      <span class="hs-keyglyph">=</span>  <span class="hs-layout">(</span><span class="hs-varop">++</span><span class="hs-layout">)</span>
<a name="line-14"></a>
<a name="line-15"></a><a name="showParen"></a><span class="hs-comment">-- | utility function that surrounds the inner show function with</span>
<a name="line-16"></a><span class="hs-comment">-- parentheses when the 'Bool' parameter is 'True'.</span>
<a name="line-17"></a><span class="hs-definition">showParen</span>       <span class="hs-keyglyph">::</span> <span class="hs-conid">Bool</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-18"></a><span class="hs-definition">showParen</span> <span class="hs-varid">b</span> <span class="hs-varid">p</span>   <span class="hs-keyglyph">=</span>  <span class="hs-keyword">if</span> <span class="hs-varid">b</span> <span class="hs-keyword">then</span> <span class="hs-varid">showChar</span> <span class="hs-chr">'('</span> <span class="hs-varop">.</span> <span class="hs-varid">p</span> <span class="hs-varop">.</span> <span class="hs-varid">showChar</span> <span class="hs-chr">')'</span> <span class="hs-keyword">else</span> <span class="hs-varid">p</span>
<a name="line-19"></a>
<a name="line-20"></a><a name="showSpace"></a><span class="hs-definition">showSpace</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">ShowS</span>
<a name="line-21"></a><span class="hs-definition">showSpace</span> <span class="hs-keyglyph">=</span> <span class="hs-comment">{-showChar ' '-}</span> <span class="hs-keyglyph">\</span> <span class="hs-varid">xs</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-chr">' '</span> <span class="hs-conop">:</span> <span class="hs-varid">xs</span>
</pre>\end{code}

Code specific for characters

\begin{code}
<pre><a name="line-1"></a><a name="showLitChar"></a><span class="hs-comment">-- | Convert a character to a string using only printable characters,</span>
<a name="line-2"></a><span class="hs-comment">-- using Haskell source-language escape conventions.  For example:</span>
<a name="line-3"></a><span class="hs-comment">--</span>
<a name="line-4"></a><span class="hs-comment">-- &gt; showLitChar '\n' s  =  &quot;\\n&quot; ++ s</span>
<a name="line-5"></a><span class="hs-comment">--</span>
<a name="line-6"></a><span class="hs-definition">showLitChar</span>                <span class="hs-keyglyph">::</span> <span class="hs-conid">Char</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-7"></a><span class="hs-definition">showLitChar</span> <span class="hs-varid">c</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">c</span> <span class="hs-varop">&gt;</span> <span class="hs-chr">'\DEL'</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">showChar</span> <span class="hs-chr">'\\'</span> <span class="hs-layout">(</span><span class="hs-varid">protectEsc</span> <span class="hs-varid">isDec</span> <span class="hs-layout">(</span><span class="hs-varid">shows</span> <span class="hs-layout">(</span><span class="hs-varid">ord</span> <span class="hs-varid">c</span><span class="hs-layout">)</span><span class="hs-layout">)</span> <span class="hs-varid">s</span><span class="hs-layout">)</span>
<a name="line-8"></a><span class="hs-definition">showLitChar</span> <span class="hs-chr">'\DEL'</span>         <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">showString</span> <span class="hs-str">&quot;\\DEL&quot;</span> <span class="hs-varid">s</span>
<a name="line-9"></a><span class="hs-definition">showLitChar</span> <span class="hs-chr">'\\'</span>           <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">showString</span> <span class="hs-str">&quot;\\\\&quot;</span> <span class="hs-varid">s</span>
<a name="line-10"></a><span class="hs-definition">showLitChar</span> <span class="hs-varid">c</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">c</span> <span class="hs-varop">&gt;=</span> <span class="hs-chr">' '</span>   <span class="hs-keyglyph">=</span>  <span class="hs-varid">showChar</span> <span class="hs-varid">c</span> <span class="hs-varid">s</span>
<a name="line-11"></a><span class="hs-definition">showLitChar</span> <span class="hs-chr">'\a'</span>           <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">showString</span> <span class="hs-str">&quot;\\a&quot;</span> <span class="hs-varid">s</span>
<a name="line-12"></a><span class="hs-definition">showLitChar</span> <span class="hs-chr">'\b'</span>           <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">showString</span> <span class="hs-str">&quot;\\b&quot;</span> <span class="hs-varid">s</span>
<a name="line-13"></a><span class="hs-definition">showLitChar</span> <span class="hs-chr">'\f'</span>           <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">showString</span> <span class="hs-str">&quot;\\f&quot;</span> <span class="hs-varid">s</span>
<a name="line-14"></a><span class="hs-definition">showLitChar</span> <span class="hs-chr">'\n'</span>           <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">showString</span> <span class="hs-str">&quot;\\n&quot;</span> <span class="hs-varid">s</span>
<a name="line-15"></a><span class="hs-definition">showLitChar</span> <span class="hs-chr">'\r'</span>           <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">showString</span> <span class="hs-str">&quot;\\r&quot;</span> <span class="hs-varid">s</span>
<a name="line-16"></a><span class="hs-definition">showLitChar</span> <span class="hs-chr">'\t'</span>           <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">showString</span> <span class="hs-str">&quot;\\t&quot;</span> <span class="hs-varid">s</span>
<a name="line-17"></a><span class="hs-definition">showLitChar</span> <span class="hs-chr">'\v'</span>           <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">showString</span> <span class="hs-str">&quot;\\v&quot;</span> <span class="hs-varid">s</span>
<a name="line-18"></a><span class="hs-definition">showLitChar</span> <span class="hs-chr">'\SO'</span>          <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">protectEsc</span> <span class="hs-layout">(</span><span class="hs-varop">==</span> <span class="hs-chr">'H'</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">showString</span> <span class="hs-str">&quot;\\SO&quot;</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
<a name="line-19"></a><span class="hs-definition">showLitChar</span> <span class="hs-varid">c</span>              <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">showString</span> <span class="hs-layout">(</span><span class="hs-chr">'\\'</span> <span class="hs-conop">:</span> <span class="hs-varid">asciiTab</span><span class="hs-varop">!!</span><span class="hs-varid">ord</span> <span class="hs-varid">c</span><span class="hs-layout">)</span> <span class="hs-varid">s</span>
<a name="line-20"></a>        <span class="hs-comment">-- I've done manual eta-expansion here, becuase otherwise it's</span>
<a name="line-21"></a>        <span class="hs-comment">-- impossible to stop (asciiTab!!ord) getting floated out as an MFE</span>
<a name="line-22"></a>
<a name="line-23"></a><a name="showLitString"></a><span class="hs-definition">showLitString</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-24"></a><span class="hs-comment">-- | Same as 'showLitChar', but for strings</span>
<a name="line-25"></a><span class="hs-comment">-- It converts the string to a string using Haskell escape conventions</span>
<a name="line-26"></a><span class="hs-comment">-- for non-printable characters. Does not add double-quotes around the</span>
<a name="line-27"></a><span class="hs-comment">-- whole thing; the caller should do that.</span>
<a name="line-28"></a><span class="hs-comment">-- The main difference from showLitChar (apart from the fact that the</span>
<a name="line-29"></a><span class="hs-comment">-- argument is a string not a list) is that we must escape double-quotes</span>
<a name="line-30"></a><span class="hs-definition">showLitString</span> <span class="hs-conid">[]</span>         <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">s</span>
<a name="line-31"></a><span class="hs-definition">showLitString</span> <span class="hs-layout">(</span><span class="hs-chr">'&quot;'</span> <span class="hs-conop">:</span> <span class="hs-varid">cs</span><span class="hs-layout">)</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showString</span> <span class="hs-str">&quot;\\\&quot;&quot;</span> <span class="hs-layout">(</span><span class="hs-varid">showLitString</span> <span class="hs-varid">cs</span> <span class="hs-varid">s</span><span class="hs-layout">)</span>
<a name="line-32"></a><span class="hs-definition">showLitString</span> <span class="hs-layout">(</span><span class="hs-varid">c</span>   <span class="hs-conop">:</span> <span class="hs-varid">cs</span><span class="hs-layout">)</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showLitChar</span> <span class="hs-varid">c</span> <span class="hs-layout">(</span><span class="hs-varid">showLitString</span> <span class="hs-varid">cs</span> <span class="hs-varid">s</span><span class="hs-layout">)</span>
<a name="line-33"></a>   <span class="hs-comment">-- Making 's' an explicit parameter makes it clear to GHC that</span>
<a name="line-34"></a>   <span class="hs-comment">-- showLitString has arity 2, which avoids it allocating an extra lambda</span>
<a name="line-35"></a>   <span class="hs-comment">-- The sticking point is the recursive call to (showLitString cs), which</span>
<a name="line-36"></a>   <span class="hs-comment">-- it can't figure out would be ok with arity 2.</span>
<a name="line-37"></a>
<a name="line-38"></a><a name="showMultiLineString"></a><span class="hs-definition">showMultiLineString</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-conid">String</span><span class="hs-keyglyph">]</span>
<a name="line-39"></a><span class="hs-comment">-- | Like 'showLitString' (expand escape characters using Haskell</span>
<a name="line-40"></a><span class="hs-comment">-- escape conventions), but</span>
<a name="line-41"></a><span class="hs-comment">--   * break the string into multiple lines</span>
<a name="line-42"></a><span class="hs-comment">--   * wrap the entire thing in double quotes</span>
<a name="line-43"></a><span class="hs-comment">-- Example:  @showMultiLineString &quot;hello\ngoodbye\nblah&quot;@</span>
<a name="line-44"></a><span class="hs-comment">-- returns   @[&quot;\&quot;hello\\&quot;, &quot;\\goodbye\\&quot;, &quot;\\blah\&quot;&quot;]@</span>
<a name="line-45"></a><span class="hs-definition">showMultiLineString</span> <span class="hs-varid">str</span>
<a name="line-46"></a>  <span class="hs-keyglyph">=</span> <span class="hs-varid">go</span> <span class="hs-chr">'\&quot;'</span> <span class="hs-varid">str</span>
<a name="line-47"></a>  <span class="hs-keyword">where</span>
<a name="line-48"></a>    <span class="hs-varid">go</span> <span class="hs-varid">ch</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">break</span> <span class="hs-layout">(</span><span class="hs-varop">==</span> <span class="hs-chr">'\n'</span><span class="hs-layout">)</span> <span class="hs-varid">s</span> <span class="hs-keyword">of</span>
<a name="line-49"></a>                <span class="hs-layout">(</span><span class="hs-varid">l</span><span class="hs-layout">,</span> <span class="hs-keyword">_</span><span class="hs-conop">:</span><span class="hs-varid">s'</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-keyword">_</span><span class="hs-conop">:</span><span class="hs-keyword">_</span><span class="hs-layout">)</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-varid">ch</span> <span class="hs-conop">:</span> <span class="hs-varid">showLitString</span> <span class="hs-varid">l</span> <span class="hs-str">&quot;\\&quot;</span><span class="hs-layout">)</span> <span class="hs-conop">:</span> <span class="hs-varid">go</span> <span class="hs-chr">'\\'</span> <span class="hs-varid">s'</span>
<a name="line-50"></a>                <span class="hs-layout">(</span><span class="hs-varid">l</span><span class="hs-layout">,</span> <span class="hs-keyword">_</span><span class="hs-layout">)</span>          <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-varid">ch</span> <span class="hs-conop">:</span> <span class="hs-varid">showLitString</span> <span class="hs-varid">l</span> <span class="hs-str">&quot;\&quot;&quot;</span><span class="hs-keyglyph">]</span>
<a name="line-51"></a>
<a name="line-52"></a><a name="isDec"></a><span class="hs-definition">isDec</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Char</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Bool</span>
<a name="line-53"></a><span class="hs-definition">isDec</span> <span class="hs-varid">c</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">c</span> <span class="hs-varop">&gt;=</span> <span class="hs-chr">'0'</span> <span class="hs-varop">&amp;&amp;</span> <span class="hs-varid">c</span> <span class="hs-varop">&lt;=</span> <span class="hs-chr">'9'</span>
<a name="line-54"></a>
<a name="line-55"></a><a name="protectEsc"></a><span class="hs-definition">protectEsc</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Char</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Bool</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-56"></a><span class="hs-definition">protectEsc</span> <span class="hs-varid">p</span> <span class="hs-varid">f</span>             <span class="hs-keyglyph">=</span> <span class="hs-varid">f</span> <span class="hs-varop">.</span> <span class="hs-varid">cont</span>
<a name="line-57"></a>                             <span class="hs-keyword">where</span> <span class="hs-varid">cont</span> <span class="hs-varid">s</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-varid">c</span><span class="hs-conop">:</span><span class="hs-keyword">_</span><span class="hs-layout">)</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">p</span> <span class="hs-varid">c</span> <span class="hs-keyglyph">=</span> <span class="hs-str">&quot;\\&amp;&quot;</span> <span class="hs-varop">++</span> <span class="hs-varid">s</span>
<a name="line-58"></a>                                   <span class="hs-varid">cont</span> <span class="hs-varid">s</span>             <span class="hs-keyglyph">=</span> <span class="hs-varid">s</span>
<a name="line-59"></a>
<a name="line-60"></a>
<a name="line-61"></a><a name="asciiTab"></a><span class="hs-definition">asciiTab</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-conid">String</span><span class="hs-keyglyph">]</span>
<a name="line-62"></a><span class="hs-definition">asciiTab</span> <span class="hs-keyglyph">=</span> <span class="hs-comment">-- Using an array drags in the array module.  listArray ('\NUL', ' ')</span>
<a name="line-63"></a>           <span class="hs-keyglyph">[</span><span class="hs-str">&quot;NUL&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;SOH&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;STX&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;ETX&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;EOT&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;ENQ&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;ACK&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;BEL&quot;</span><span class="hs-layout">,</span>
<a name="line-64"></a>            <span class="hs-str">&quot;BS&quot;</span><span class="hs-layout">,</span>  <span class="hs-str">&quot;HT&quot;</span><span class="hs-layout">,</span>  <span class="hs-str">&quot;LF&quot;</span><span class="hs-layout">,</span>  <span class="hs-str">&quot;VT&quot;</span><span class="hs-layout">,</span>  <span class="hs-str">&quot;FF&quot;</span><span class="hs-layout">,</span>  <span class="hs-str">&quot;CR&quot;</span><span class="hs-layout">,</span>  <span class="hs-str">&quot;SO&quot;</span><span class="hs-layout">,</span>  <span class="hs-str">&quot;SI&quot;</span><span class="hs-layout">,</span>
<a name="line-65"></a>            <span class="hs-str">&quot;DLE&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;DC1&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;DC2&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;DC3&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;DC4&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;NAK&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;SYN&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;ETB&quot;</span><span class="hs-layout">,</span>
<a name="line-66"></a>            <span class="hs-str">&quot;CAN&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;EM&quot;</span><span class="hs-layout">,</span>  <span class="hs-str">&quot;SUB&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;ESC&quot;</span><span class="hs-layout">,</span> <span class="hs-str">&quot;FS&quot;</span><span class="hs-layout">,</span>  <span class="hs-str">&quot;GS&quot;</span><span class="hs-layout">,</span>  <span class="hs-str">&quot;RS&quot;</span><span class="hs-layout">,</span>  <span class="hs-str">&quot;US&quot;</span><span class="hs-layout">,</span>
<a name="line-67"></a>            <span class="hs-str">&quot;SP&quot;</span><span class="hs-keyglyph">]</span>
</pre>\end{code}

Code specific for Ints.

\begin{code}
<pre><a name="line-1"></a><a name="intToDigit"></a><span class="hs-comment">-- | Convert an 'Int' in the range @0@..@15@ to the corresponding single</span>
<a name="line-2"></a><span class="hs-comment">-- digit 'Char'.  This function fails on other inputs, and generates</span>
<a name="line-3"></a><span class="hs-comment">-- lower-case hexadecimal digits.</span>
<a name="line-4"></a><span class="hs-definition">intToDigit</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Char</span>
<a name="line-5"></a><span class="hs-definition">intToDigit</span> <span class="hs-layout">(</span><span class="hs-conid">I</span><span class="hs-cpp">#</span> <span class="hs-varid">i</span><span class="hs-layout">)</span>
<a name="line-6"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">i</span> <span class="hs-varop">&gt;=#</span> <span class="hs-num">0</span><span class="hs-cpp">#</span>  <span class="hs-varop">&amp;&amp;</span> <span class="hs-varid">i</span> <span class="hs-varop">&lt;=#</span>  <span class="hs-num">9</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">unsafeChr</span> <span class="hs-layout">(</span><span class="hs-varid">ord</span> <span class="hs-chr">'0'</span> <span class="hs-varop">+</span> <span class="hs-conid">I</span><span class="hs-cpp">#</span> <span class="hs-varid">i</span><span class="hs-layout">)</span>
<a name="line-7"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">i</span> <span class="hs-varop">&gt;=#</span> <span class="hs-num">10</span><span class="hs-cpp">#</span> <span class="hs-varop">&amp;&amp;</span> <span class="hs-varid">i</span> <span class="hs-varop">&lt;=#</span> <span class="hs-num">15</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">unsafeChr</span> <span class="hs-layout">(</span><span class="hs-varid">ord</span> <span class="hs-chr">'a'</span> <span class="hs-varop">+</span> <span class="hs-conid">I</span><span class="hs-cpp">#</span> <span class="hs-varid">i</span> <span class="hs-comment">-</span> <span class="hs-num">10</span><span class="hs-layout">)</span>
<a name="line-8"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>           <span class="hs-keyglyph">=</span>  <span class="hs-varid">error</span> <span class="hs-layout">(</span><span class="hs-str">&quot;Char.intToDigit: not a digit &quot;</span> <span class="hs-varop">++</span> <span class="hs-varid">show</span> <span class="hs-layout">(</span><span class="hs-conid">I</span><span class="hs-cpp">#</span> <span class="hs-varid">i</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-9"></a>
<a name="line-10"></a><a name="showSignedInt"></a><span class="hs-definition">showSignedInt</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-11"></a><span class="hs-definition">showSignedInt</span> <span class="hs-layout">(</span><span class="hs-conid">I</span><span class="hs-cpp">#</span> <span class="hs-varid">p</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-conid">I</span><span class="hs-cpp">#</span> <span class="hs-varid">n</span><span class="hs-layout">)</span> <span class="hs-varid">r</span>
<a name="line-12"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">n</span> <span class="hs-varop">&lt;#</span> <span class="hs-num">0</span><span class="hs-cpp">#</span> <span class="hs-varop">&amp;&amp;</span> <span class="hs-varid">p</span> <span class="hs-varop">&gt;#</span> <span class="hs-num">6</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">=</span> <span class="hs-chr">'('</span> <span class="hs-conop">:</span> <span class="hs-varid">itos</span> <span class="hs-varid">n</span> <span class="hs-layout">(</span><span class="hs-chr">')'</span> <span class="hs-conop">:</span> <span class="hs-varid">r</span><span class="hs-layout">)</span>
<a name="line-13"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>          <span class="hs-keyglyph">=</span> <span class="hs-varid">itos</span> <span class="hs-varid">n</span> <span class="hs-varid">r</span>
<a name="line-14"></a>
<a name="line-15"></a><a name="itos"></a><span class="hs-definition">itos</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span>
<a name="line-16"></a><span class="hs-definition">itos</span> <span class="hs-varid">n</span><span class="hs-cpp">#</span> <span class="hs-varid">cs</span>
<a name="line-17"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">n</span><span class="hs-cpp">#</span> <span class="hs-varop">&lt;#</span> <span class="hs-num">0</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">=</span>
<a name="line-18"></a>        <span class="hs-keyword">let</span> <span class="hs-varop">!</span><span class="hs-layout">(</span><span class="hs-conid">I</span><span class="hs-cpp">#</span> <span class="hs-varid">minInt</span><span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">minInt</span> <span class="hs-keyword">in</span>
<a name="line-19"></a>        <span class="hs-keyword">if</span> <span class="hs-varid">n</span><span class="hs-cpp">#</span> <span class="hs-varop">==#</span> <span class="hs-varid">minInt</span><span class="hs-cpp">#</span>
<a name="line-20"></a>                <span class="hs-comment">-- negateInt# minInt overflows, so we can't do that:</span>
<a name="line-21"></a>           <span class="hs-keyword">then</span> <span class="hs-chr">'-'</span> <span class="hs-conop">:</span> <span class="hs-layout">(</span><span class="hs-keyword">case</span> <span class="hs-varid">n</span><span class="hs-cpp">#</span> <span class="hs-varop">`</span><span class="hs-varid">quotRemInt</span><span class="hs-cpp">#</span><span class="hs-varop">`</span> <span class="hs-num">10</span><span class="hs-cpp">#</span> <span class="hs-keyword">of</span>
<a name="line-22"></a>                       <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-varid">q</span><span class="hs-layout">,</span> <span class="hs-varid">r</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span>
<a name="line-23"></a>                           <span class="hs-varid">itos'</span> <span class="hs-layout">(</span><span class="hs-varid">negateInt</span><span class="hs-cpp">#</span> <span class="hs-varid">q</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">itos'</span> <span class="hs-layout">(</span><span class="hs-varid">negateInt</span><span class="hs-cpp">#</span> <span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-varid">cs</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-24"></a>           <span class="hs-keyword">else</span> <span class="hs-chr">'-'</span> <span class="hs-conop">:</span> <span class="hs-varid">itos'</span> <span class="hs-layout">(</span><span class="hs-varid">negateInt</span><span class="hs-cpp">#</span> <span class="hs-varid">n</span><span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-varid">cs</span>
<a name="line-25"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">itos'</span> <span class="hs-varid">n</span><span class="hs-cpp">#</span> <span class="hs-varid">cs</span>
<a name="line-26"></a>    <span class="hs-keyword">where</span>
<a name="line-27"></a>    <span class="hs-varid">itos'</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span>
<a name="line-28"></a>    <span class="hs-varid">itos'</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span> <span class="hs-varid">cs'</span>
<a name="line-29"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span> <span class="hs-varop">&lt;#</span> <span class="hs-num">10</span><span class="hs-cpp">#</span>  <span class="hs-keyglyph">=</span> <span class="hs-conid">C</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">chr</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">ord</span><span class="hs-cpp">#</span> <span class="hs-chr">'0'</span><span class="hs-cpp">#</span> <span class="hs-varop">+#</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span><span class="hs-layout">)</span><span class="hs-layout">)</span> <span class="hs-conop">:</span> <span class="hs-varid">cs'</span>
<a name="line-30"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span> <span class="hs-varop">`</span><span class="hs-varid">quotRemInt</span><span class="hs-cpp">#</span><span class="hs-varop">`</span> <span class="hs-num">10</span><span class="hs-cpp">#</span> <span class="hs-keyword">of</span>
<a name="line-31"></a>                      <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-varid">q</span><span class="hs-layout">,</span> <span class="hs-varid">r</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span>
<a name="line-32"></a>                          <span class="hs-keyword">case</span> <span class="hs-varid">chr</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">ord</span><span class="hs-cpp">#</span> <span class="hs-chr">'0'</span><span class="hs-cpp">#</span> <span class="hs-varop">+#</span> <span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-keyword">of</span>
<a name="line-33"></a>                          <span class="hs-varid">c</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span>
<a name="line-34"></a>                              <span class="hs-varid">itos'</span> <span class="hs-varid">q</span> <span class="hs-layout">(</span><span class="hs-conid">C</span><span class="hs-cpp">#</span> <span class="hs-varid">c</span><span class="hs-cpp">#</span> <span class="hs-conop">:</span> <span class="hs-varid">cs'</span><span class="hs-layout">)</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{The @Integer@ instances for @Show@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="instance%20Show%20Integer"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Show</span> <span class="hs-conid">Integer</span> <span class="hs-keyword">where</span>
<a name="line-2"></a>    <span class="hs-varid">showsPrec</span> <span class="hs-varid">p</span> <span class="hs-varid">n</span> <span class="hs-varid">r</span>
<a name="line-3"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">p</span> <span class="hs-varop">&gt;</span> <span class="hs-num">6</span> <span class="hs-varop">&amp;&amp;</span> <span class="hs-varid">n</span> <span class="hs-varop">&lt;</span> <span class="hs-num">0</span> <span class="hs-keyglyph">=</span> <span class="hs-chr">'('</span> <span class="hs-conop">:</span> <span class="hs-varid">integerToString</span> <span class="hs-varid">n</span> <span class="hs-layout">(</span><span class="hs-chr">')'</span> <span class="hs-conop">:</span> <span class="hs-varid">r</span><span class="hs-layout">)</span>
<a name="line-4"></a>        <span class="hs-comment">-- Minor point: testing p first gives better code</span>
<a name="line-5"></a>        <span class="hs-comment">-- in the not-uncommon case where the p argument</span>
<a name="line-6"></a>        <span class="hs-comment">-- is a constant</span>
<a name="line-7"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">integerToString</span> <span class="hs-varid">n</span> <span class="hs-varid">r</span>
<a name="line-8"></a>    <span class="hs-varid">showList</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showList__</span> <span class="hs-layout">(</span><span class="hs-varid">showsPrec</span> <span class="hs-num">0</span><span class="hs-layout">)</span>
<a name="line-9"></a>
<a name="line-10"></a><a name="integerToString"></a><span class="hs-comment">-- Divide an conquer implementation of string conversion</span>
<a name="line-11"></a><span class="hs-definition">integerToString</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Integer</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span>
<a name="line-12"></a><span class="hs-definition">integerToString</span> <span class="hs-varid">n0</span> <span class="hs-varid">cs0</span>
<a name="line-13"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">n0</span> <span class="hs-varop">&lt;</span> <span class="hs-num">0</span>    <span class="hs-keyglyph">=</span> <span class="hs-chr">'-'</span> <span class="hs-conop">:</span> <span class="hs-varid">integerToString'</span> <span class="hs-layout">(</span><span class="hs-comment">-</span> <span class="hs-varid">n0</span><span class="hs-layout">)</span> <span class="hs-varid">cs0</span>
<a name="line-14"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">integerToString'</span> <span class="hs-varid">n0</span> <span class="hs-varid">cs0</span>
<a name="line-15"></a>    <span class="hs-keyword">where</span>
<a name="line-16"></a>    <span class="hs-varid">integerToString'</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Integer</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span>
<a name="line-17"></a>    <span class="hs-varid">integerToString'</span> <span class="hs-varid">n</span> <span class="hs-varid">cs</span>
<a name="line-18"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">n</span> <span class="hs-varop">&lt;</span> <span class="hs-conid">BASE</span>  <span class="hs-keyglyph">=</span> <span class="hs-varid">jhead</span> <span class="hs-layout">(</span><span class="hs-varid">fromInteger</span> <span class="hs-varid">n</span><span class="hs-layout">)</span> <span class="hs-varid">cs</span>
<a name="line-19"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">jprinth</span> <span class="hs-layout">(</span><span class="hs-varid">jsplitf</span> <span class="hs-layout">(</span><span class="hs-conid">BASE</span><span class="hs-varop">*</span><span class="hs-conid">BASE</span><span class="hs-layout">)</span> <span class="hs-varid">n</span><span class="hs-layout">)</span> <span class="hs-varid">cs</span>
<a name="line-20"></a>
<a name="line-21"></a>    <span class="hs-comment">-- Split n into digits in base p. We first split n into digits</span>
<a name="line-22"></a>    <span class="hs-comment">-- in base p*p and then split each of these digits into two.</span>
<a name="line-23"></a>    <span class="hs-comment">-- Note that the first 'digit' modulo p*p may have a leading zero</span>
<a name="line-24"></a>    <span class="hs-comment">-- in base p that we need to drop - this is what jsplith takes care of.</span>
<a name="line-25"></a>    <span class="hs-comment">-- jsplitb the handles the remaining digits.</span>
<a name="line-26"></a>    <span class="hs-varid">jsplitf</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Integer</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Integer</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Integer</span><span class="hs-keyglyph">]</span>
<a name="line-27"></a>    <span class="hs-varid">jsplitf</span> <span class="hs-varid">p</span> <span class="hs-varid">n</span>
<a name="line-28"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">p</span> <span class="hs-varop">&gt;</span> <span class="hs-varid">n</span>     <span class="hs-keyglyph">=</span> <span class="hs-keyglyph">[</span><span class="hs-varid">n</span><span class="hs-keyglyph">]</span>
<a name="line-29"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">jsplith</span> <span class="hs-varid">p</span> <span class="hs-layout">(</span><span class="hs-varid">jsplitf</span> <span class="hs-layout">(</span><span class="hs-varid">p</span><span class="hs-varop">*</span><span class="hs-varid">p</span><span class="hs-layout">)</span> <span class="hs-varid">n</span><span class="hs-layout">)</span>
<a name="line-30"></a>
<a name="line-31"></a>    <span class="hs-varid">jsplith</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Integer</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Integer</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Integer</span><span class="hs-keyglyph">]</span>
<a name="line-32"></a>    <span class="hs-varid">jsplith</span> <span class="hs-varid">p</span> <span class="hs-layout">(</span><span class="hs-varid">n</span><span class="hs-conop">:</span><span class="hs-varid">ns</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span>
<a name="line-33"></a>        <span class="hs-keyword">case</span> <span class="hs-varid">n</span> <span class="hs-varop">`quotRemInteger`</span> <span class="hs-varid">p</span> <span class="hs-keyword">of</span>
<a name="line-34"></a>        <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-varid">q</span><span class="hs-layout">,</span> <span class="hs-varid">r</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span>
<a name="line-35"></a>            <span class="hs-keyword">if</span> <span class="hs-varid">q</span> <span class="hs-varop">&gt;</span> <span class="hs-num">0</span> <span class="hs-keyword">then</span> <span class="hs-varid">q</span> <span class="hs-conop">:</span> <span class="hs-varid">r</span> <span class="hs-conop">:</span> <span class="hs-varid">jsplitb</span> <span class="hs-varid">p</span> <span class="hs-varid">ns</span>
<a name="line-36"></a>                     <span class="hs-keyword">else</span>     <span class="hs-varid">r</span> <span class="hs-conop">:</span> <span class="hs-varid">jsplitb</span> <span class="hs-varid">p</span> <span class="hs-varid">ns</span>
<a name="line-37"></a>    <span class="hs-varid">jsplith</span> <span class="hs-keyword">_</span> <span class="hs-conid">[]</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">error</span> <span class="hs-str">&quot;jsplith: []&quot;</span>
<a name="line-38"></a>
<a name="line-39"></a>    <span class="hs-varid">jsplitb</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Integer</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Integer</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Integer</span><span class="hs-keyglyph">]</span>
<a name="line-40"></a>    <span class="hs-varid">jsplitb</span> <span class="hs-keyword">_</span> <span class="hs-conid">[]</span>     <span class="hs-keyglyph">=</span> <span class="hs-conid">[]</span>
<a name="line-41"></a>    <span class="hs-varid">jsplitb</span> <span class="hs-varid">p</span> <span class="hs-layout">(</span><span class="hs-varid">n</span><span class="hs-conop">:</span><span class="hs-varid">ns</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">n</span> <span class="hs-varop">`quotRemInteger`</span> <span class="hs-varid">p</span> <span class="hs-keyword">of</span>
<a name="line-42"></a>                       <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-varid">q</span><span class="hs-layout">,</span> <span class="hs-varid">r</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span>
<a name="line-43"></a>                           <span class="hs-varid">q</span> <span class="hs-conop">:</span> <span class="hs-varid">r</span> <span class="hs-conop">:</span> <span class="hs-varid">jsplitb</span> <span class="hs-varid">p</span> <span class="hs-varid">ns</span>
<a name="line-44"></a>
<a name="line-45"></a>    <span class="hs-comment">-- Convert a number that has been split into digits in base BASE^2</span>
<a name="line-46"></a>    <span class="hs-comment">-- this includes a last splitting step and then conversion of digits</span>
<a name="line-47"></a>    <span class="hs-comment">-- that all fit into a machine word.</span>
<a name="line-48"></a>    <span class="hs-varid">jprinth</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Integer</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span>
<a name="line-49"></a>    <span class="hs-varid">jprinth</span> <span class="hs-layout">(</span><span class="hs-varid">n</span><span class="hs-conop">:</span><span class="hs-varid">ns</span><span class="hs-layout">)</span> <span class="hs-varid">cs</span> <span class="hs-keyglyph">=</span>
<a name="line-50"></a>        <span class="hs-keyword">case</span> <span class="hs-varid">n</span> <span class="hs-varop">`quotRemInteger`</span> <span class="hs-conid">BASE</span> <span class="hs-keyword">of</span>
<a name="line-51"></a>        <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-varid">q'</span><span class="hs-layout">,</span> <span class="hs-varid">r'</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span>
<a name="line-52"></a>            <span class="hs-keyword">let</span> <span class="hs-varid">q</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">fromInteger</span> <span class="hs-varid">q'</span>
<a name="line-53"></a>                <span class="hs-varid">r</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">fromInteger</span> <span class="hs-varid">r'</span>
<a name="line-54"></a>            <span class="hs-keyword">in</span> <span class="hs-keyword">if</span> <span class="hs-varid">q</span> <span class="hs-varop">&gt;</span> <span class="hs-num">0</span> <span class="hs-keyword">then</span> <span class="hs-varid">jhead</span> <span class="hs-varid">q</span> <span class="hs-varop">$</span> <span class="hs-varid">jblock</span> <span class="hs-varid">r</span> <span class="hs-varop">$</span> <span class="hs-varid">jprintb</span> <span class="hs-varid">ns</span> <span class="hs-varid">cs</span>
<a name="line-55"></a>                        <span class="hs-keyword">else</span> <span class="hs-varid">jhead</span> <span class="hs-varid">r</span> <span class="hs-varop">$</span> <span class="hs-varid">jprintb</span> <span class="hs-varid">ns</span> <span class="hs-varid">cs</span>
<a name="line-56"></a>    <span class="hs-varid">jprinth</span> <span class="hs-conid">[]</span> <span class="hs-keyword">_</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">error</span> <span class="hs-str">&quot;jprinth []&quot;</span>
<a name="line-57"></a>
<a name="line-58"></a>    <span class="hs-varid">jprintb</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Integer</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span>
<a name="line-59"></a>    <span class="hs-varid">jprintb</span> <span class="hs-conid">[]</span>     <span class="hs-varid">cs</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">cs</span>
<a name="line-60"></a>    <span class="hs-varid">jprintb</span> <span class="hs-layout">(</span><span class="hs-varid">n</span><span class="hs-conop">:</span><span class="hs-varid">ns</span><span class="hs-layout">)</span> <span class="hs-varid">cs</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">n</span> <span class="hs-varop">`quotRemInteger`</span> <span class="hs-conid">BASE</span> <span class="hs-keyword">of</span>
<a name="line-61"></a>                        <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-varid">q'</span><span class="hs-layout">,</span> <span class="hs-varid">r'</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span>
<a name="line-62"></a>                            <span class="hs-keyword">let</span> <span class="hs-varid">q</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">fromInteger</span> <span class="hs-varid">q'</span>
<a name="line-63"></a>                                <span class="hs-varid">r</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">fromInteger</span> <span class="hs-varid">r'</span>
<a name="line-64"></a>                            <span class="hs-keyword">in</span> <span class="hs-varid">jblock</span> <span class="hs-varid">q</span> <span class="hs-varop">$</span> <span class="hs-varid">jblock</span> <span class="hs-varid">r</span> <span class="hs-varop">$</span> <span class="hs-varid">jprintb</span> <span class="hs-varid">ns</span> <span class="hs-varid">cs</span>
<a name="line-65"></a>
<a name="line-66"></a>    <span class="hs-comment">-- Convert an integer that fits into a machine word. Again, we have two</span>
<a name="line-67"></a>    <span class="hs-comment">-- functions, one that drops leading zeros (jhead) and one that doesn't</span>
<a name="line-68"></a>    <span class="hs-comment">-- (jblock)</span>
<a name="line-69"></a>    <span class="hs-varid">jhead</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span>
<a name="line-70"></a>    <span class="hs-varid">jhead</span> <span class="hs-varid">n</span> <span class="hs-varid">cs</span>
<a name="line-71"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">n</span> <span class="hs-varop">&lt;</span> <span class="hs-num">10</span>    <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">unsafeChr</span> <span class="hs-layout">(</span><span class="hs-varid">ord</span> <span class="hs-chr">'0'</span> <span class="hs-varop">+</span> <span class="hs-varid">n</span><span class="hs-layout">)</span> <span class="hs-keyword">of</span>
<a name="line-72"></a>            <span class="hs-varid">c</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">C</span><span class="hs-cpp">#</span> <span class="hs-keyword">_</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">c</span> <span class="hs-conop">:</span> <span class="hs-varid">cs</span>
<a name="line-73"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">unsafeChr</span> <span class="hs-layout">(</span><span class="hs-varid">ord</span> <span class="hs-chr">'0'</span> <span class="hs-varop">+</span> <span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-keyword">of</span>
<a name="line-74"></a>            <span class="hs-varid">c</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">C</span><span class="hs-cpp">#</span> <span class="hs-keyword">_</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">jhead</span> <span class="hs-varid">q</span> <span class="hs-layout">(</span><span class="hs-varid">c</span> <span class="hs-conop">:</span> <span class="hs-varid">cs</span><span class="hs-layout">)</span>
<a name="line-75"></a>        <span class="hs-keyword">where</span>
<a name="line-76"></a>        <span class="hs-layout">(</span><span class="hs-varid">q</span><span class="hs-layout">,</span> <span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">n</span> <span class="hs-varop">`quotRemInt`</span> <span class="hs-num">10</span>
<a name="line-77"></a>
<a name="line-78"></a>    <span class="hs-varid">jblock</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">jblock'</span> <span class="hs-comment">{- ' -}</span> <span class="hs-conid">DIGITS</span>
<a name="line-79"></a>
<a name="line-80"></a>    <span class="hs-varid">jblock'</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span>
<a name="line-81"></a>    <span class="hs-varid">jblock'</span> <span class="hs-varid">d</span> <span class="hs-varid">n</span> <span class="hs-varid">cs</span>
<a name="line-82"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">d</span> <span class="hs-varop">==</span> <span class="hs-num">1</span>    <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">unsafeChr</span> <span class="hs-layout">(</span><span class="hs-varid">ord</span> <span class="hs-chr">'0'</span> <span class="hs-varop">+</span> <span class="hs-varid">n</span><span class="hs-layout">)</span> <span class="hs-keyword">of</span>
<a name="line-83"></a>             <span class="hs-varid">c</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">C</span><span class="hs-cpp">#</span> <span class="hs-keyword">_</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">c</span> <span class="hs-conop">:</span> <span class="hs-varid">cs</span>
<a name="line-84"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">unsafeChr</span> <span class="hs-layout">(</span><span class="hs-varid">ord</span> <span class="hs-chr">'0'</span> <span class="hs-varop">+</span> <span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-keyword">of</span>
<a name="line-85"></a>             <span class="hs-varid">c</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">C</span><span class="hs-cpp">#</span> <span class="hs-keyword">_</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">jblock'</span> <span class="hs-layout">(</span><span class="hs-varid">d</span> <span class="hs-comment">-</span> <span class="hs-num">1</span><span class="hs-layout">)</span> <span class="hs-varid">q</span> <span class="hs-layout">(</span><span class="hs-varid">c</span> <span class="hs-conop">:</span> <span class="hs-varid">cs</span><span class="hs-layout">)</span>
<a name="line-86"></a>        <span class="hs-keyword">where</span>
<a name="line-87"></a>        <span class="hs-layout">(</span><span class="hs-varid">q</span><span class="hs-layout">,</span> <span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">n</span> <span class="hs-varop">`quotRemInt`</span> <span class="hs-num">10</span>
</pre>\end{code}

</body>
</html>
