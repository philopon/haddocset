<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>GHC/Real.lhs</title>
<link type="text/css" rel="stylesheet" href="hscolour.css"></link>
</head>
<body>
\begin{code}
<pre><a name="line-1"></a><span class="hs-comment">{-# LANGUAGE Trustworthy #-}</span>
<a name="line-2"></a><span class="hs-comment">{-# LANGUAGE CPP, NoImplicitPrelude, MagicHash, UnboxedTuples, BangPatterns #-}</span>
<a name="line-3"></a><span class="hs-comment">{-# OPTIONS_GHC -fno-warn-orphans #-}</span>
<a name="line-4"></a><span class="hs-comment">{-# OPTIONS_HADDOCK hide #-}</span>
<a name="line-5"></a><span class="hs-comment">-----------------------------------------------------------------------------</span>
<a name="line-6"></a><span class="hs-comment">-- |</span>
<a name="line-7"></a><span class="hs-comment">-- Module      :  GHC.Real</span>
<a name="line-8"></a><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow, 1994-2002</span>
<a name="line-9"></a><span class="hs-comment">-- License     :  see libraries/base/LICENSE</span>
<a name="line-10"></a><span class="hs-comment">--</span>
<a name="line-11"></a><span class="hs-comment">-- Maintainer  :  cvs-ghc@haskell.org</span>
<a name="line-12"></a><span class="hs-comment">-- Stability   :  internal</span>
<a name="line-13"></a><span class="hs-comment">-- Portability :  non-portable (GHC Extensions)</span>
<a name="line-14"></a><span class="hs-comment">--</span>
<a name="line-15"></a><span class="hs-comment">-- The types 'Ratio' and 'Rational', and the classes 'Real', 'Fractional',</span>
<a name="line-16"></a><span class="hs-comment">-- 'Integral', and 'RealFrac'.</span>
<a name="line-17"></a><span class="hs-comment">--</span>
<a name="line-18"></a><span class="hs-comment">-----------------------------------------------------------------------------</span>
<a name="line-19"></a>
<a name="line-20"></a><span class="hs-comment">-- #hide</span>
<a name="line-21"></a><span class="hs-keyword">module</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Real</span> <span class="hs-keyword">where</span>
<a name="line-22"></a>
<a name="line-23"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Base</span>
<a name="line-24"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Num</span>
<a name="line-25"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">List</span>
<a name="line-26"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Enum</span>
<a name="line-27"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Show</span>
<a name="line-28"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Err</span>
<a name="line-29"></a>
<a name="line-30"></a><span class="hs-cpp">#ifdef OPTIMISE_INTEGER_GCD_LCM</span>
<a name="line-31"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Integer</span><span class="hs-varop">.</span><span class="hs-conid">GMP</span><span class="hs-varop">.</span><span class="hs-conid">Internals</span>
<a name="line-32"></a><span class="hs-cpp">#endif</span>
<a name="line-33"></a>
<a name="line-34"></a><span class="hs-keyword">infixr</span> <span class="hs-num">8</span>  <span class="hs-varop">^</span><span class="hs-layout">,</span> <span class="hs-varop">^^</span>
<a name="line-35"></a><span class="hs-keyword">infixl</span> <span class="hs-num">7</span>  <span class="hs-varop">/</span><span class="hs-layout">,</span> <span class="hs-varop">`quot`</span><span class="hs-layout">,</span> <span class="hs-varop">`rem`</span><span class="hs-layout">,</span> <span class="hs-varop">`div`</span><span class="hs-layout">,</span> <span class="hs-varop">`mod`</span>
<a name="line-36"></a><span class="hs-keyword">infixl</span> <span class="hs-num">7</span>  <span class="hs-varop">%</span>
<a name="line-37"></a>
<a name="line-38"></a><span class="hs-keyword">default</span> <span class="hs-conid">()</span>              <span class="hs-comment">-- Double isn't available yet,</span>
<a name="line-39"></a>                        <span class="hs-comment">-- and we shouldn't be using defaults anyway</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{The @Ratio@ and @Rational@ types}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="Ratio"></a><span class="hs-comment">-- | Rational numbers, with numerator and denominator of some 'Integral' type.</span>
<a name="line-2"></a><a name="Ratio"></a><span class="hs-keyword">data</span>  <span class="hs-conid">Ratio</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=</span> <span class="hs-varop">!</span><span class="hs-varid">a</span> <span class="hs-conop">:%</span> <span class="hs-varop">!</span><span class="hs-varid">a</span>  <span class="hs-keyword">deriving</span> <span class="hs-layout">(</span><span class="hs-conid">Eq</span><span class="hs-layout">)</span>
<a name="line-3"></a>
<a name="line-4"></a><a name="Rational"></a><span class="hs-comment">-- | Arbitrary-precision rational numbers, represented as a ratio of</span>
<a name="line-5"></a><a name="Rational"></a><span class="hs-comment">-- two 'Integer' values.  A rational number may be constructed using</span>
<a name="line-6"></a><a name="Rational"></a><span class="hs-comment">-- the '%' operator.</span>
<a name="line-7"></a><a name="Rational"></a><span class="hs-keyword">type</span>  <span class="hs-conid">Rational</span>          <span class="hs-keyglyph">=</span>  <span class="hs-conid">Ratio</span> <span class="hs-conid">Integer</span>
<a name="line-8"></a>
<a name="line-9"></a><a name="ratioPrec"></a><span class="hs-definition">ratioPrec</span><span class="hs-layout">,</span> <span class="hs-varid">ratioPrec1</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span>
<a name="line-10"></a><span class="hs-definition">ratioPrec</span>  <span class="hs-keyglyph">=</span> <span class="hs-num">7</span>  <span class="hs-comment">-- Precedence of ':%' constructor</span>
<a name="line-11"></a><a name="ratioPrec1"></a><span class="hs-definition">ratioPrec1</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">ratioPrec</span> <span class="hs-varop">+</span> <span class="hs-num">1</span>
<a name="line-12"></a>
<a name="line-13"></a><a name="infinity"></a><span class="hs-definition">infinity</span><span class="hs-layout">,</span> <span class="hs-varid">notANumber</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Rational</span>
<a name="line-14"></a><span class="hs-definition">infinity</span>   <span class="hs-keyglyph">=</span> <span class="hs-num">1</span> <span class="hs-conop">:%</span> <span class="hs-num">0</span>
<a name="line-15"></a><a name="notANumber"></a><span class="hs-definition">notANumber</span> <span class="hs-keyglyph">=</span> <span class="hs-num">0</span> <span class="hs-conop">:%</span> <span class="hs-num">0</span>
<a name="line-16"></a>
<a name="line-17"></a><span class="hs-comment">-- Use :%, not % for Inf/NaN; the latter would</span>
<a name="line-18"></a><span class="hs-comment">-- immediately lead to a runtime error, because it normalises.</span>
</pre>\end{code}


\begin{code}
<pre><a name="line-1"></a><a name="%25"></a><span class="hs-comment">-- | Forms the ratio of two integral numbers.</span>
<a name="line-2"></a><span class="hs-comment">{-# SPECIALISE (%) :: Integer -&gt; Integer -&gt; Rational #-}</span>
<a name="line-3"></a><span class="hs-layout">(</span><span class="hs-varop">%</span><span class="hs-layout">)</span>                     <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Ratio</span> <span class="hs-varid">a</span>
<a name="line-4"></a>
<a name="line-5"></a><a name="numerator"></a><span class="hs-comment">-- | Extract the numerator of the ratio in reduced form:</span>
<a name="line-6"></a><span class="hs-comment">-- the numerator and denominator have no common factor and the denominator</span>
<a name="line-7"></a><span class="hs-comment">-- is positive.</span>
<a name="line-8"></a><span class="hs-definition">numerator</span>       <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Ratio</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-9"></a>
<a name="line-10"></a><a name="denominator"></a><span class="hs-comment">-- | Extract the denominator of the ratio in reduced form:</span>
<a name="line-11"></a><span class="hs-comment">-- the numerator and denominator have no common factor and the denominator</span>
<a name="line-12"></a><span class="hs-comment">-- is positive.</span>
<a name="line-13"></a><span class="hs-definition">denominator</span>     <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Ratio</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
</pre>\end{code}

\tr{reduce} is a subsidiary function used only in this module .
It normalises a ratio by dividing both numerator and denominator by
their greatest common divisor.

\begin{code}
<pre><a name="line-1"></a><a name="reduce"></a><span class="hs-definition">reduce</span> <span class="hs-keyglyph">::</span>  <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Ratio</span> <span class="hs-varid">a</span>
<a name="line-2"></a><span class="hs-comment">{-# SPECIALISE reduce :: Integer -&gt; Integer -&gt; Rational #-}</span>
<a name="line-3"></a><span class="hs-definition">reduce</span> <span class="hs-keyword">_</span> <span class="hs-num">0</span>              <span class="hs-keyglyph">=</span>  <span class="hs-varid">ratioZeroDenominatorError</span>
<a name="line-4"></a><span class="hs-definition">reduce</span> <span class="hs-varid">x</span> <span class="hs-varid">y</span>              <span class="hs-keyglyph">=</span>  <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">`quot`</span> <span class="hs-varid">d</span><span class="hs-layout">)</span> <span class="hs-conop">:%</span> <span class="hs-layout">(</span><span class="hs-varid">y</span> <span class="hs-varop">`quot`</span> <span class="hs-varid">d</span><span class="hs-layout">)</span>
<a name="line-5"></a>                           <span class="hs-keyword">where</span> <span class="hs-varid">d</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">gcd</span> <span class="hs-varid">x</span> <span class="hs-varid">y</span>
</pre>\end{code}

\begin{code}
<pre><a name="line-1"></a><a name="%25"></a><span class="hs-definition">x</span> <span class="hs-varop">%</span> <span class="hs-varid">y</span>                   <span class="hs-keyglyph">=</span>  <span class="hs-varid">reduce</span> <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">*</span> <span class="hs-varid">signum</span> <span class="hs-varid">y</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">abs</span> <span class="hs-varid">y</span><span class="hs-layout">)</span>
<a name="line-2"></a>
<a name="line-3"></a><a name="numerator"></a><span class="hs-definition">numerator</span>   <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-conop">:%</span> <span class="hs-keyword">_</span><span class="hs-layout">)</span>    <span class="hs-keyglyph">=</span>  <span class="hs-varid">x</span>
<a name="line-4"></a><a name="denominator"></a><span class="hs-definition">denominator</span> <span class="hs-layout">(</span><span class="hs-keyword">_</span> <span class="hs-conop">:%</span> <span class="hs-varid">y</span><span class="hs-layout">)</span>    <span class="hs-keyglyph">=</span>  <span class="hs-varid">y</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{Standard numeric classes}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="Real"></a><span class="hs-keyword">class</span>  <span class="hs-layout">(</span><span class="hs-conid">Num</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Ord</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Real</span> <span class="hs-varid">a</span>  <span class="hs-keyword">where</span>
<a name="line-2"></a>    <span class="hs-comment">-- | the rational equivalent of its real argument with full precision</span>
<a name="line-3"></a>    <span class="hs-varid">toRational</span>          <span class="hs-keyglyph">::</span>  <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Rational</span>
<a name="line-4"></a>
<a name="line-5"></a><a name="Integral"></a><span class="hs-comment">-- | Integral numbers, supporting integer division.</span>
<a name="line-6"></a><a name="Integral"></a><span class="hs-comment">--</span>
<a name="line-7"></a><a name="Integral"></a><span class="hs-comment">-- Minimal complete definition: 'quotRem' and 'toInteger'</span>
<a name="line-8"></a><a name="Integral"></a><span class="hs-keyword">class</span>  <span class="hs-layout">(</span><span class="hs-conid">Real</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Enum</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Integral</span> <span class="hs-varid">a</span>  <span class="hs-keyword">where</span>
<a name="line-9"></a>    <span class="hs-comment">-- | integer division truncated toward zero</span>
<a name="line-10"></a>    <span class="hs-varid">quot</span>                <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-11"></a>    <span class="hs-comment">-- | integer remainder, satisfying</span>
<a name="line-12"></a>    <span class="hs-comment">--</span>
<a name="line-13"></a>    <span class="hs-comment">-- &gt; (x `quot` y)*y + (x `rem` y) == x</span>
<a name="line-14"></a>    <span class="hs-varid">rem</span>                 <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-15"></a>    <span class="hs-comment">-- | integer division truncated toward negative infinity</span>
<a name="line-16"></a>    <span class="hs-varid">div</span>                 <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-17"></a>    <span class="hs-comment">-- | integer modulus, satisfying</span>
<a name="line-18"></a>    <span class="hs-comment">--</span>
<a name="line-19"></a>    <span class="hs-comment">-- &gt; (x `div` y)*y + (x `mod` y) == x</span>
<a name="line-20"></a>    <span class="hs-varid">mod</span>                 <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-21"></a>    <span class="hs-comment">-- | simultaneous 'quot' and 'rem'</span>
<a name="line-22"></a>    <span class="hs-varid">quotRem</span>             <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">a</span><span class="hs-layout">)</span>
<a name="line-23"></a>    <span class="hs-comment">-- | simultaneous 'div' and 'mod'</span>
<a name="line-24"></a>    <span class="hs-varid">divMod</span>              <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-varid">a</span><span class="hs-layout">,</span><span class="hs-varid">a</span><span class="hs-layout">)</span>
<a name="line-25"></a>    <span class="hs-comment">-- | conversion to 'Integer'</span>
<a name="line-26"></a>    <span class="hs-varid">toInteger</span>           <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Integer</span>
<a name="line-27"></a>
<a name="line-28"></a>    <span class="hs-comment">{-# INLINE quot #-}</span>
<a name="line-29"></a>    <span class="hs-comment">{-# INLINE rem #-}</span>
<a name="line-30"></a>    <span class="hs-comment">{-# INLINE div #-}</span>
<a name="line-31"></a>    <span class="hs-comment">{-# INLINE mod #-}</span>
<a name="line-32"></a>    <span class="hs-varid">n</span> <span class="hs-varop">`quot`</span> <span class="hs-varid">d</span>          <span class="hs-keyglyph">=</span>  <span class="hs-varid">q</span>  <span class="hs-keyword">where</span> <span class="hs-layout">(</span><span class="hs-varid">q</span><span class="hs-layout">,</span><span class="hs-keyword">_</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">quotRem</span> <span class="hs-varid">n</span> <span class="hs-varid">d</span>
<a name="line-33"></a>    <span class="hs-varid">n</span> <span class="hs-varop">`rem`</span> <span class="hs-varid">d</span>           <span class="hs-keyglyph">=</span>  <span class="hs-varid">r</span>  <span class="hs-keyword">where</span> <span class="hs-layout">(</span><span class="hs-keyword">_</span><span class="hs-layout">,</span><span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">quotRem</span> <span class="hs-varid">n</span> <span class="hs-varid">d</span>
<a name="line-34"></a>    <span class="hs-varid">n</span> <span class="hs-varop">`div`</span> <span class="hs-varid">d</span>           <span class="hs-keyglyph">=</span>  <span class="hs-varid">q</span>  <span class="hs-keyword">where</span> <span class="hs-layout">(</span><span class="hs-varid">q</span><span class="hs-layout">,</span><span class="hs-keyword">_</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">divMod</span> <span class="hs-varid">n</span> <span class="hs-varid">d</span>
<a name="line-35"></a>    <span class="hs-varid">n</span> <span class="hs-varop">`mod`</span> <span class="hs-varid">d</span>           <span class="hs-keyglyph">=</span>  <span class="hs-varid">r</span>  <span class="hs-keyword">where</span> <span class="hs-layout">(</span><span class="hs-keyword">_</span><span class="hs-layout">,</span><span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">divMod</span> <span class="hs-varid">n</span> <span class="hs-varid">d</span>
<a name="line-36"></a>
<a name="line-37"></a>    <span class="hs-varid">divMod</span> <span class="hs-varid">n</span> <span class="hs-varid">d</span>          <span class="hs-keyglyph">=</span>  <span class="hs-keyword">if</span> <span class="hs-varid">signum</span> <span class="hs-varid">r</span> <span class="hs-varop">==</span> <span class="hs-varid">negate</span> <span class="hs-layout">(</span><span class="hs-varid">signum</span> <span class="hs-varid">d</span><span class="hs-layout">)</span> <span class="hs-keyword">then</span> <span class="hs-layout">(</span><span class="hs-varid">q</span><span class="hs-comment">-</span><span class="hs-num">1</span><span class="hs-layout">,</span> <span class="hs-varid">r</span><span class="hs-varop">+</span><span class="hs-varid">d</span><span class="hs-layout">)</span> <span class="hs-keyword">else</span> <span class="hs-varid">qr</span>
<a name="line-38"></a>                           <span class="hs-keyword">where</span> <span class="hs-varid">qr</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-varid">q</span><span class="hs-layout">,</span><span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">quotRem</span> <span class="hs-varid">n</span> <span class="hs-varid">d</span>
<a name="line-39"></a>
<a name="line-40"></a><a name="Fractional"></a><span class="hs-comment">-- | Fractional numbers, supporting real division.</span>
<a name="line-41"></a><a name="Fractional"></a><span class="hs-comment">--</span>
<a name="line-42"></a><a name="Fractional"></a><span class="hs-comment">-- Minimal complete definition: 'fromRational' and ('recip' or @('/')@)</span>
<a name="line-43"></a><a name="Fractional"></a><span class="hs-keyword">class</span>  <span class="hs-layout">(</span><span class="hs-conid">Num</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Fractional</span> <span class="hs-varid">a</span>  <span class="hs-keyword">where</span>
<a name="line-44"></a>    <span class="hs-comment">-- | fractional division</span>
<a name="line-45"></a>    <span class="hs-layout">(</span><span class="hs-varop">/</span><span class="hs-layout">)</span>                 <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-46"></a>    <span class="hs-comment">-- | reciprocal fraction</span>
<a name="line-47"></a>    <span class="hs-varid">recip</span>               <span class="hs-keyglyph">::</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-48"></a>    <span class="hs-comment">-- | Conversion from a 'Rational' (that is @'Ratio' 'Integer'@).</span>
<a name="line-49"></a>    <span class="hs-comment">-- A floating literal stands for an application of 'fromRational'</span>
<a name="line-50"></a>    <span class="hs-comment">-- to a value of type 'Rational', so such literals have type</span>
<a name="line-51"></a>    <span class="hs-comment">-- @('Fractional' a) =&gt; a@.</span>
<a name="line-52"></a>    <span class="hs-varid">fromRational</span>        <span class="hs-keyglyph">::</span> <span class="hs-conid">Rational</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-53"></a>
<a name="line-54"></a>    <span class="hs-comment">{-# INLINE recip #-}</span>
<a name="line-55"></a>    <span class="hs-comment">{-# INLINE (/) #-}</span>
<a name="line-56"></a>    <span class="hs-varid">recip</span> <span class="hs-varid">x</span>             <span class="hs-keyglyph">=</span>  <span class="hs-num">1</span> <span class="hs-varop">/</span> <span class="hs-varid">x</span>
<a name="line-57"></a>    <span class="hs-varid">x</span> <span class="hs-varop">/</span> <span class="hs-varid">y</span>               <span class="hs-keyglyph">=</span> <span class="hs-varid">x</span> <span class="hs-varop">*</span> <span class="hs-varid">recip</span> <span class="hs-varid">y</span>
<a name="line-58"></a>
<a name="line-59"></a><a name="RealFrac"></a><span class="hs-comment">-- | Extracting components of fractions.</span>
<a name="line-60"></a><a name="RealFrac"></a><span class="hs-comment">--</span>
<a name="line-61"></a><a name="RealFrac"></a><span class="hs-comment">-- Minimal complete definition: 'properFraction'</span>
<a name="line-62"></a><a name="RealFrac"></a><span class="hs-keyword">class</span>  <span class="hs-layout">(</span><span class="hs-conid">Real</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Fractional</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">RealFrac</span> <span class="hs-varid">a</span>  <span class="hs-keyword">where</span>
<a name="line-63"></a>    <span class="hs-comment">-- | The function 'properFraction' takes a real fractional number @x@</span>
<a name="line-64"></a>    <span class="hs-comment">-- and returns a pair @(n,f)@ such that @x = n+f@, and:</span>
<a name="line-65"></a>    <span class="hs-comment">--</span>
<a name="line-66"></a>    <span class="hs-comment">-- * @n@ is an integral number with the same sign as @x@; and</span>
<a name="line-67"></a>    <span class="hs-comment">--</span>
<a name="line-68"></a>    <span class="hs-comment">-- * @f@ is a fraction with the same type and sign as @x@,</span>
<a name="line-69"></a>    <span class="hs-comment">--   and with absolute value less than @1@.</span>
<a name="line-70"></a>    <span class="hs-comment">--</span>
<a name="line-71"></a>    <span class="hs-comment">-- The default definitions of the 'ceiling', 'floor', 'truncate'</span>
<a name="line-72"></a>    <span class="hs-comment">-- and 'round' functions are in terms of 'properFraction'.</span>
<a name="line-73"></a>    <span class="hs-varid">properFraction</span>      <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-varid">b</span><span class="hs-layout">,</span><span class="hs-varid">a</span><span class="hs-layout">)</span>
<a name="line-74"></a>    <span class="hs-comment">-- | @'truncate' x@ returns the integer nearest @x@ between zero and @x@</span>
<a name="line-75"></a>    <span class="hs-varid">truncate</span>            <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">b</span>
<a name="line-76"></a>    <span class="hs-comment">-- | @'round' x@ returns the nearest integer to @x@;</span>
<a name="line-77"></a>    <span class="hs-comment">--   the even integer if @x@ is equidistant between two integers</span>
<a name="line-78"></a>    <span class="hs-varid">round</span>               <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">b</span>
<a name="line-79"></a>    <span class="hs-comment">-- | @'ceiling' x@ returns the least integer not less than @x@</span>
<a name="line-80"></a>    <span class="hs-varid">ceiling</span>             <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">b</span>
<a name="line-81"></a>    <span class="hs-comment">-- | @'floor' x@ returns the greatest integer not greater than @x@</span>
<a name="line-82"></a>    <span class="hs-varid">floor</span>               <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">b</span>
<a name="line-83"></a>
<a name="line-84"></a>    <span class="hs-comment">{-# INLINE truncate #-}</span>
<a name="line-85"></a>    <span class="hs-varid">truncate</span> <span class="hs-varid">x</span>          <span class="hs-keyglyph">=</span>  <span class="hs-varid">m</span>  <span class="hs-keyword">where</span> <span class="hs-layout">(</span><span class="hs-varid">m</span><span class="hs-layout">,</span><span class="hs-keyword">_</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">properFraction</span> <span class="hs-varid">x</span>
<a name="line-86"></a>
<a name="line-87"></a>    <span class="hs-varid">round</span> <span class="hs-varid">x</span>             <span class="hs-keyglyph">=</span>  <span class="hs-keyword">let</span> <span class="hs-layout">(</span><span class="hs-varid">n</span><span class="hs-layout">,</span><span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">properFraction</span> <span class="hs-varid">x</span>
<a name="line-88"></a>                               <span class="hs-varid">m</span>     <span class="hs-keyglyph">=</span> <span class="hs-keyword">if</span> <span class="hs-varid">r</span> <span class="hs-varop">&lt;</span> <span class="hs-num">0</span> <span class="hs-keyword">then</span> <span class="hs-varid">n</span> <span class="hs-comment">-</span> <span class="hs-num">1</span> <span class="hs-keyword">else</span> <span class="hs-varid">n</span> <span class="hs-varop">+</span> <span class="hs-num">1</span>
<a name="line-89"></a>                           <span class="hs-keyword">in</span> <span class="hs-keyword">case</span> <span class="hs-varid">signum</span> <span class="hs-layout">(</span><span class="hs-varid">abs</span> <span class="hs-varid">r</span> <span class="hs-comment">-</span> <span class="hs-num">0.5</span><span class="hs-layout">)</span> <span class="hs-keyword">of</span>
<a name="line-90"></a>                                <span class="hs-comment">-</span><span class="hs-num">1</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">n</span>
<a name="line-91"></a>                                <span class="hs-num">0</span>  <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyword">if</span> <span class="hs-varid">even</span> <span class="hs-varid">n</span> <span class="hs-keyword">then</span> <span class="hs-varid">n</span> <span class="hs-keyword">else</span> <span class="hs-varid">m</span>
<a name="line-92"></a>                                <span class="hs-num">1</span>  <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">m</span>
<a name="line-93"></a>                                <span class="hs-keyword">_</span>  <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">error</span> <span class="hs-str">&quot;round default defn: Bad value&quot;</span>
<a name="line-94"></a>
<a name="line-95"></a>    <span class="hs-varid">ceiling</span> <span class="hs-varid">x</span>           <span class="hs-keyglyph">=</span>  <span class="hs-keyword">if</span> <span class="hs-varid">r</span> <span class="hs-varop">&gt;</span> <span class="hs-num">0</span> <span class="hs-keyword">then</span> <span class="hs-varid">n</span> <span class="hs-varop">+</span> <span class="hs-num">1</span> <span class="hs-keyword">else</span> <span class="hs-varid">n</span>
<a name="line-96"></a>                           <span class="hs-keyword">where</span> <span class="hs-layout">(</span><span class="hs-varid">n</span><span class="hs-layout">,</span><span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">properFraction</span> <span class="hs-varid">x</span>
<a name="line-97"></a>
<a name="line-98"></a>    <span class="hs-varid">floor</span> <span class="hs-varid">x</span>             <span class="hs-keyglyph">=</span>  <span class="hs-keyword">if</span> <span class="hs-varid">r</span> <span class="hs-varop">&lt;</span> <span class="hs-num">0</span> <span class="hs-keyword">then</span> <span class="hs-varid">n</span> <span class="hs-comment">-</span> <span class="hs-num">1</span> <span class="hs-keyword">else</span> <span class="hs-varid">n</span>
<a name="line-99"></a>                           <span class="hs-keyword">where</span> <span class="hs-layout">(</span><span class="hs-varid">n</span><span class="hs-layout">,</span><span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">properFraction</span> <span class="hs-varid">x</span>
</pre>\end{code}


These 'numeric' enumerations come straight from the Report

\begin{code}
<pre><a name="line-1"></a><a name="numericEnumFrom"></a><span class="hs-definition">numericEnumFrom</span>         <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Fractional</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span>
<a name="line-2"></a><span class="hs-definition">numericEnumFrom</span> <span class="hs-varid">n</span>	<span class="hs-keyglyph">=</span>  <span class="hs-varid">n</span> <span class="hs-varop">`seq`</span> <span class="hs-layout">(</span><span class="hs-varid">n</span> <span class="hs-conop">:</span> <span class="hs-varid">numericEnumFrom</span> <span class="hs-layout">(</span><span class="hs-varid">n</span> <span class="hs-varop">+</span> <span class="hs-num">1</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-3"></a>
<a name="line-4"></a><a name="numericEnumFromThen"></a><span class="hs-definition">numericEnumFromThen</span>     <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Fractional</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span>
<a name="line-5"></a><span class="hs-definition">numericEnumFromThen</span> <span class="hs-varid">n</span> <span class="hs-varid">m</span>	<span class="hs-keyglyph">=</span> <span class="hs-varid">n</span> <span class="hs-varop">`seq`</span> <span class="hs-varid">m</span> <span class="hs-varop">`seq`</span> <span class="hs-layout">(</span><span class="hs-varid">n</span> <span class="hs-conop">:</span> <span class="hs-varid">numericEnumFromThen</span> <span class="hs-varid">m</span> <span class="hs-layout">(</span><span class="hs-varid">m</span><span class="hs-varop">+</span><span class="hs-varid">m</span><span class="hs-comment">-</span><span class="hs-varid">n</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-6"></a>
<a name="line-7"></a><a name="numericEnumFromTo"></a><span class="hs-definition">numericEnumFromTo</span>       <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Ord</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Fractional</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span>
<a name="line-8"></a><span class="hs-definition">numericEnumFromTo</span> <span class="hs-varid">n</span> <span class="hs-varid">m</span>   <span class="hs-keyglyph">=</span> <span class="hs-varid">takeWhile</span> <span class="hs-layout">(</span><span class="hs-varop">&lt;=</span> <span class="hs-varid">m</span> <span class="hs-varop">+</span> <span class="hs-num">1</span><span class="hs-varop">/</span><span class="hs-num">2</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">numericEnumFrom</span> <span class="hs-varid">n</span><span class="hs-layout">)</span>
<a name="line-9"></a>
<a name="line-10"></a><a name="numericEnumFromThenTo"></a><span class="hs-definition">numericEnumFromThenTo</span>   <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Ord</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Fractional</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span>
<a name="line-11"></a><span class="hs-definition">numericEnumFromThenTo</span> <span class="hs-varid">e1</span> <span class="hs-varid">e2</span> <span class="hs-varid">e3</span>
<a name="line-12"></a>    <span class="hs-keyglyph">=</span> <span class="hs-varid">takeWhile</span> <span class="hs-varid">predicate</span> <span class="hs-layout">(</span><span class="hs-varid">numericEnumFromThen</span> <span class="hs-varid">e1</span> <span class="hs-varid">e2</span><span class="hs-layout">)</span>
<a name="line-13"></a>                                <span class="hs-keyword">where</span>
<a name="line-14"></a>                                 <span class="hs-varid">mid</span> <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">e2</span> <span class="hs-comment">-</span> <span class="hs-varid">e1</span><span class="hs-layout">)</span> <span class="hs-varop">/</span> <span class="hs-num">2</span>
<a name="line-15"></a>                                 <span class="hs-varid">predicate</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">e2</span> <span class="hs-varop">&gt;=</span> <span class="hs-varid">e1</span>  <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varop">&lt;=</span> <span class="hs-varid">e3</span> <span class="hs-varop">+</span> <span class="hs-varid">mid</span><span class="hs-layout">)</span>
<a name="line-16"></a>                                           <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varop">&gt;=</span> <span class="hs-varid">e3</span> <span class="hs-varop">+</span> <span class="hs-varid">mid</span><span class="hs-layout">)</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{Instances for @Int@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="instance%20Real%20Int"></a><span class="hs-keyword">instance</span>  <span class="hs-conid">Real</span> <span class="hs-conid">Int</span>  <span class="hs-keyword">where</span>
<a name="line-2"></a>    <span class="hs-varid">toRational</span> <span class="hs-varid">x</span>        <span class="hs-keyglyph">=</span>  <span class="hs-varid">toInteger</span> <span class="hs-varid">x</span> <span class="hs-conop">:%</span> <span class="hs-num">1</span>
<a name="line-3"></a>
<a name="line-4"></a><a name="instance%20Integral%20Int"></a><span class="hs-keyword">instance</span>  <span class="hs-conid">Integral</span> <span class="hs-conid">Int</span>  <span class="hs-keyword">where</span>
<a name="line-5"></a>    <span class="hs-varid">toInteger</span> <span class="hs-layout">(</span><span class="hs-conid">I</span><span class="hs-cpp">#</span> <span class="hs-varid">i</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">smallInteger</span> <span class="hs-varid">i</span>
<a name="line-6"></a>
<a name="line-7"></a>    <span class="hs-varid">a</span> <span class="hs-varop">`quot`</span> <span class="hs-varid">b</span>
<a name="line-8"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">b</span> <span class="hs-varop">==</span> <span class="hs-num">0</span>                     <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-9"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">b</span> <span class="hs-varop">==</span> <span class="hs-layout">(</span><span class="hs-comment">-</span><span class="hs-num">1</span><span class="hs-layout">)</span> <span class="hs-varop">&amp;&amp;</span> <span class="hs-varid">a</span> <span class="hs-varop">==</span> <span class="hs-varid">minBound</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">overflowError</span> <span class="hs-comment">-- Note [Order of tests]</span>
<a name="line-10"></a>                                                  <span class="hs-comment">-- in GHC.Int</span>
<a name="line-11"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>                  <span class="hs-keyglyph">=</span>  <span class="hs-varid">a</span> <span class="hs-varop">`quotInt`</span> <span class="hs-varid">b</span>
<a name="line-12"></a>
<a name="line-13"></a>    <span class="hs-varid">a</span> <span class="hs-varop">`rem`</span> <span class="hs-varid">b</span>
<a name="line-14"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">b</span> <span class="hs-varop">==</span> <span class="hs-num">0</span>                     <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-15"></a>       <span class="hs-comment">-- The quotRem CPU instruction fails for minBound `quotRem` -1,</span>
<a name="line-16"></a>       <span class="hs-comment">-- but minBound `rem` -1 is well-defined (0). We therefore</span>
<a name="line-17"></a>       <span class="hs-comment">-- special-case it.</span>
<a name="line-18"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">b</span> <span class="hs-varop">==</span> <span class="hs-layout">(</span><span class="hs-comment">-</span><span class="hs-num">1</span><span class="hs-layout">)</span>                  <span class="hs-keyglyph">=</span> <span class="hs-num">0</span>
<a name="line-19"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>                  <span class="hs-keyglyph">=</span>  <span class="hs-varid">a</span> <span class="hs-varop">`remInt`</span> <span class="hs-varid">b</span>
<a name="line-20"></a>
<a name="line-21"></a>    <span class="hs-varid">a</span> <span class="hs-varop">`div`</span> <span class="hs-varid">b</span>
<a name="line-22"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">b</span> <span class="hs-varop">==</span> <span class="hs-num">0</span>                     <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-23"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">b</span> <span class="hs-varop">==</span> <span class="hs-layout">(</span><span class="hs-comment">-</span><span class="hs-num">1</span><span class="hs-layout">)</span> <span class="hs-varop">&amp;&amp;</span> <span class="hs-varid">a</span> <span class="hs-varop">==</span> <span class="hs-varid">minBound</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">overflowError</span> <span class="hs-comment">-- Note [Order of tests]</span>
<a name="line-24"></a>                                                  <span class="hs-comment">-- in GHC.Int</span>
<a name="line-25"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>                  <span class="hs-keyglyph">=</span>  <span class="hs-varid">a</span> <span class="hs-varop">`divInt`</span> <span class="hs-varid">b</span>
<a name="line-26"></a>
<a name="line-27"></a>    <span class="hs-varid">a</span> <span class="hs-varop">`mod`</span> <span class="hs-varid">b</span>
<a name="line-28"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">b</span> <span class="hs-varop">==</span> <span class="hs-num">0</span>                     <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-29"></a>       <span class="hs-comment">-- The divMod CPU instruction fails for minBound `divMod` -1,</span>
<a name="line-30"></a>       <span class="hs-comment">-- but minBound `mod` -1 is well-defined (0). We therefore</span>
<a name="line-31"></a>       <span class="hs-comment">-- special-case it.</span>
<a name="line-32"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">b</span> <span class="hs-varop">==</span> <span class="hs-layout">(</span><span class="hs-comment">-</span><span class="hs-num">1</span><span class="hs-layout">)</span>                  <span class="hs-keyglyph">=</span> <span class="hs-num">0</span>
<a name="line-33"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>                  <span class="hs-keyglyph">=</span>  <span class="hs-varid">a</span> <span class="hs-varop">`modInt`</span> <span class="hs-varid">b</span>
<a name="line-34"></a>
<a name="line-35"></a>    <span class="hs-varid">a</span> <span class="hs-varop">`quotRem`</span> <span class="hs-varid">b</span>
<a name="line-36"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">b</span> <span class="hs-varop">==</span> <span class="hs-num">0</span>                     <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-37"></a>       <span class="hs-comment">-- Note [Order of tests] in GHC.Int</span>
<a name="line-38"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">b</span> <span class="hs-varop">==</span> <span class="hs-layout">(</span><span class="hs-comment">-</span><span class="hs-num">1</span><span class="hs-layout">)</span> <span class="hs-varop">&amp;&amp;</span> <span class="hs-varid">a</span> <span class="hs-varop">==</span> <span class="hs-varid">minBound</span> <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">overflowError</span><span class="hs-layout">,</span> <span class="hs-num">0</span><span class="hs-layout">)</span>
<a name="line-39"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>                  <span class="hs-keyglyph">=</span>  <span class="hs-varid">a</span> <span class="hs-varop">`quotRemInt`</span> <span class="hs-varid">b</span>
<a name="line-40"></a>
<a name="line-41"></a>    <span class="hs-varid">a</span> <span class="hs-varop">`divMod`</span> <span class="hs-varid">b</span>
<a name="line-42"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">b</span> <span class="hs-varop">==</span> <span class="hs-num">0</span>                     <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-43"></a>       <span class="hs-comment">-- Note [Order of tests] in GHC.Int</span>
<a name="line-44"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">b</span> <span class="hs-varop">==</span> <span class="hs-layout">(</span><span class="hs-comment">-</span><span class="hs-num">1</span><span class="hs-layout">)</span> <span class="hs-varop">&amp;&amp;</span> <span class="hs-varid">a</span> <span class="hs-varop">==</span> <span class="hs-varid">minBound</span> <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">overflowError</span><span class="hs-layout">,</span> <span class="hs-num">0</span><span class="hs-layout">)</span>
<a name="line-45"></a>     <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>                  <span class="hs-keyglyph">=</span>  <span class="hs-varid">a</span> <span class="hs-varop">`divModInt`</span> <span class="hs-varid">b</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{Instances for @Word@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="instance%20Real%20Word"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Real</span> <span class="hs-conid">Word</span> <span class="hs-keyword">where</span>
<a name="line-2"></a>    <span class="hs-varid">toRational</span> <span class="hs-varid">x</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">toInteger</span> <span class="hs-varid">x</span> <span class="hs-varop">%</span> <span class="hs-num">1</span>
<a name="line-3"></a>
<a name="line-4"></a><a name="instance%20Integral%20Word"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Integral</span> <span class="hs-conid">Word</span> <span class="hs-keyword">where</span>
<a name="line-5"></a>    <span class="hs-varid">quot</span>    <span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-varid">y</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-6"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">y</span> <span class="hs-varop">/=</span> <span class="hs-num">0</span>                <span class="hs-keyglyph">=</span> <span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-cpp">#</span> <span class="hs-varop">`</span><span class="hs-varid">quotWord</span><span class="hs-cpp">#</span><span class="hs-varop">`</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-7"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>             <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-8"></a>    <span class="hs-varid">rem</span>     <span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-varid">y</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-9"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">y</span> <span class="hs-varop">/=</span> <span class="hs-num">0</span>                <span class="hs-keyglyph">=</span> <span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-cpp">#</span> <span class="hs-varop">`</span><span class="hs-varid">remWord</span><span class="hs-cpp">#</span><span class="hs-varop">`</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-10"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>             <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-11"></a>    <span class="hs-varid">div</span>     <span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-varid">y</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-12"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">y</span> <span class="hs-varop">/=</span> <span class="hs-num">0</span>                <span class="hs-keyglyph">=</span> <span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-cpp">#</span> <span class="hs-varop">`</span><span class="hs-varid">quotWord</span><span class="hs-cpp">#</span><span class="hs-varop">`</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-13"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>             <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-14"></a>    <span class="hs-varid">mod</span>     <span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-varid">y</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-15"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">y</span> <span class="hs-varop">/=</span> <span class="hs-num">0</span>                <span class="hs-keyglyph">=</span> <span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-cpp">#</span> <span class="hs-varop">`</span><span class="hs-varid">remWord</span><span class="hs-cpp">#</span><span class="hs-varop">`</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-16"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>             <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-17"></a>    <span class="hs-varid">quotRem</span> <span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-varid">y</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-18"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">y</span> <span class="hs-varop">/=</span> <span class="hs-num">0</span>                <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span> <span class="hs-varop">`</span><span class="hs-varid">quotRemWord</span><span class="hs-cpp">#</span><span class="hs-varop">`</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span> <span class="hs-keyword">of</span>
<a name="line-19"></a>                                  <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-varid">q</span><span class="hs-layout">,</span> <span class="hs-varid">r</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span>
<a name="line-20"></a>                                      <span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">q</span><span class="hs-layout">,</span> <span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">r</span><span class="hs-layout">)</span>
<a name="line-21"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>             <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-22"></a>    <span class="hs-varid">divMod</span>  <span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-varid">y</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-23"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">y</span> <span class="hs-varop">/=</span> <span class="hs-num">0</span>                <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-cpp">#</span> <span class="hs-varop">`</span><span class="hs-varid">quotWord</span><span class="hs-cpp">#</span><span class="hs-varop">`</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-cpp">#</span> <span class="hs-varop">`</span><span class="hs-varid">remWord</span><span class="hs-cpp">#</span><span class="hs-varop">`</span> <span class="hs-varid">y</span><span class="hs-cpp">#</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-24"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>             <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-25"></a>    <span class="hs-varid">toInteger</span> <span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-26"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">i</span><span class="hs-cpp">#</span> <span class="hs-varop">&gt;=#</span> <span class="hs-num">0</span><span class="hs-cpp">#</span>             <span class="hs-keyglyph">=</span> <span class="hs-varid">smallInteger</span> <span class="hs-varid">i</span><span class="hs-cpp">#</span>
<a name="line-27"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>             <span class="hs-keyglyph">=</span> <span class="hs-varid">wordToInteger</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span>
<a name="line-28"></a>        <span class="hs-keyword">where</span>
<a name="line-29"></a>        <span class="hs-varop">!</span><span class="hs-varid">i</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">word2Int</span><span class="hs-cpp">#</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span>
<a name="line-30"></a>
<a name="line-31"></a><a name="instance%20Enum%20Word"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Enum</span> <span class="hs-conid">Word</span> <span class="hs-keyword">where</span>
<a name="line-32"></a>    <span class="hs-varid">succ</span> <span class="hs-varid">x</span>
<a name="line-33"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">x</span> <span class="hs-varop">/=</span> <span class="hs-varid">maxBound</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">x</span> <span class="hs-varop">+</span> <span class="hs-num">1</span>
<a name="line-34"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>     <span class="hs-keyglyph">=</span> <span class="hs-varid">succError</span> <span class="hs-str">&quot;Word&quot;</span>
<a name="line-35"></a>    <span class="hs-varid">pred</span> <span class="hs-varid">x</span>
<a name="line-36"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">x</span> <span class="hs-varop">/=</span> <span class="hs-varid">minBound</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">x</span> <span class="hs-comment">-</span> <span class="hs-num">1</span>
<a name="line-37"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>     <span class="hs-keyglyph">=</span> <span class="hs-varid">predError</span> <span class="hs-str">&quot;Word&quot;</span>
<a name="line-38"></a>    <span class="hs-varid">toEnum</span> <span class="hs-varid">i</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">I</span><span class="hs-cpp">#</span> <span class="hs-varid">i</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-39"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">i</span> <span class="hs-varop">&gt;=</span> <span class="hs-num">0</span>        <span class="hs-keyglyph">=</span> <span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">int2Word</span><span class="hs-cpp">#</span> <span class="hs-varid">i</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-40"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>     <span class="hs-keyglyph">=</span> <span class="hs-varid">toEnumError</span> <span class="hs-str">&quot;Word&quot;</span> <span class="hs-varid">i</span> <span class="hs-layout">(</span><span class="hs-varid">minBound</span><span class="hs-keyglyph">::</span><span class="hs-conid">Word</span><span class="hs-layout">,</span> <span class="hs-varid">maxBound</span><span class="hs-keyglyph">::</span><span class="hs-conid">Word</span><span class="hs-layout">)</span>
<a name="line-41"></a>    <span class="hs-varid">fromEnum</span> <span class="hs-varid">x</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">W</span><span class="hs-cpp">#</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-42"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">x</span> <span class="hs-varop">&lt;=</span> <span class="hs-varid">fromIntegral</span> <span class="hs-layout">(</span><span class="hs-varid">maxBound</span><span class="hs-keyglyph">::</span><span class="hs-conid">Int</span><span class="hs-layout">)</span>
<a name="line-43"></a>                        <span class="hs-keyglyph">=</span> <span class="hs-conid">I</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">word2Int</span><span class="hs-cpp">#</span> <span class="hs-varid">x</span><span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-44"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>     <span class="hs-keyglyph">=</span> <span class="hs-varid">fromEnumError</span> <span class="hs-str">&quot;Word&quot;</span> <span class="hs-varid">x</span>
<a name="line-45"></a>    <span class="hs-varid">enumFrom</span>            <span class="hs-keyglyph">=</span> <span class="hs-varid">integralEnumFrom</span>
<a name="line-46"></a>    <span class="hs-varid">enumFromThen</span>        <span class="hs-keyglyph">=</span> <span class="hs-varid">integralEnumFromThen</span>
<a name="line-47"></a>    <span class="hs-varid">enumFromTo</span>          <span class="hs-keyglyph">=</span> <span class="hs-varid">integralEnumFromTo</span>
<a name="line-48"></a>    <span class="hs-varid">enumFromThenTo</span>      <span class="hs-keyglyph">=</span> <span class="hs-varid">integralEnumFromThenTo</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{Instances for @Integer@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="instance%20Real%20Integer"></a><span class="hs-keyword">instance</span>  <span class="hs-conid">Real</span> <span class="hs-conid">Integer</span>  <span class="hs-keyword">where</span>
<a name="line-2"></a>    <span class="hs-varid">toRational</span> <span class="hs-varid">x</span>        <span class="hs-keyglyph">=</span>  <span class="hs-varid">x</span> <span class="hs-conop">:%</span> <span class="hs-num">1</span>
<a name="line-3"></a>
<a name="line-4"></a><a name="instance%20Integral%20Integer"></a><span class="hs-keyword">instance</span>  <span class="hs-conid">Integral</span> <span class="hs-conid">Integer</span> <span class="hs-keyword">where</span>
<a name="line-5"></a>    <span class="hs-varid">toInteger</span> <span class="hs-varid">n</span>      <span class="hs-keyglyph">=</span> <span class="hs-varid">n</span>
<a name="line-6"></a>
<a name="line-7"></a>    <span class="hs-keyword">_</span> <span class="hs-varop">`quot`</span> <span class="hs-num">0</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-8"></a>    <span class="hs-varid">n</span> <span class="hs-varop">`quot`</span> <span class="hs-varid">d</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">n</span> <span class="hs-varop">`quotInteger`</span> <span class="hs-varid">d</span>
<a name="line-9"></a>
<a name="line-10"></a>    <span class="hs-keyword">_</span> <span class="hs-varop">`rem`</span> <span class="hs-num">0</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-11"></a>    <span class="hs-varid">n</span> <span class="hs-varop">`rem`</span>  <span class="hs-varid">d</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">n</span> <span class="hs-varop">`remInteger`</span>  <span class="hs-varid">d</span>
<a name="line-12"></a>
<a name="line-13"></a>    <span class="hs-keyword">_</span> <span class="hs-varop">`div`</span> <span class="hs-num">0</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-14"></a>    <span class="hs-varid">n</span> <span class="hs-varop">`div`</span> <span class="hs-varid">d</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">n</span> <span class="hs-varop">`divInteger`</span> <span class="hs-varid">d</span>
<a name="line-15"></a>
<a name="line-16"></a>    <span class="hs-keyword">_</span> <span class="hs-varop">`mod`</span> <span class="hs-num">0</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-17"></a>    <span class="hs-varid">n</span> <span class="hs-varop">`mod`</span>  <span class="hs-varid">d</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">n</span> <span class="hs-varop">`modInteger`</span>  <span class="hs-varid">d</span>
<a name="line-18"></a>
<a name="line-19"></a>    <span class="hs-keyword">_</span> <span class="hs-varop">`divMod`</span> <span class="hs-num">0</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-20"></a>    <span class="hs-varid">a</span> <span class="hs-varop">`divMod`</span> <span class="hs-varid">b</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">a</span> <span class="hs-varop">`divModInteger`</span> <span class="hs-varid">b</span> <span class="hs-keyword">of</span>
<a name="line-21"></a>                   <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-varid">x</span><span class="hs-layout">,</span> <span class="hs-varid">y</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-layout">,</span> <span class="hs-varid">y</span><span class="hs-layout">)</span>
<a name="line-22"></a>
<a name="line-23"></a>    <span class="hs-keyword">_</span> <span class="hs-varop">`quotRem`</span> <span class="hs-num">0</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">divZeroError</span>
<a name="line-24"></a>    <span class="hs-varid">a</span> <span class="hs-varop">`quotRem`</span> <span class="hs-varid">b</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">a</span> <span class="hs-varop">`quotRemInteger`</span> <span class="hs-varid">b</span> <span class="hs-keyword">of</span>
<a name="line-25"></a>                    <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-varid">q</span><span class="hs-layout">,</span> <span class="hs-varid">r</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-varid">q</span><span class="hs-layout">,</span> <span class="hs-varid">r</span><span class="hs-layout">)</span>
<a name="line-26"></a>
<a name="line-27"></a>    <span class="hs-comment">-- use the defaults for div &amp; mod</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{Instances for @Ratio@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="instance%20Ord%20(Ratio%20a)"></a><span class="hs-keyword">instance</span>  <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Ord</span> <span class="hs-layout">(</span><span class="hs-conid">Ratio</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyword">where</span>
<a name="line-2"></a>    <span class="hs-comment">{-# SPECIALIZE instance Ord Rational #-}</span>
<a name="line-3"></a>    <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span> <span class="hs-varop">&lt;=</span> <span class="hs-layout">(</span><span class="hs-varid">x'</span><span class="hs-conop">:%</span><span class="hs-varid">y'</span><span class="hs-layout">)</span>  <span class="hs-keyglyph">=</span>  <span class="hs-varid">x</span> <span class="hs-varop">*</span> <span class="hs-varid">y'</span> <span class="hs-varop">&lt;=</span> <span class="hs-varid">x'</span> <span class="hs-varop">*</span> <span class="hs-varid">y</span>
<a name="line-4"></a>    <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span> <span class="hs-varop">&lt;</span>  <span class="hs-layout">(</span><span class="hs-varid">x'</span><span class="hs-conop">:%</span><span class="hs-varid">y'</span><span class="hs-layout">)</span>  <span class="hs-keyglyph">=</span>  <span class="hs-varid">x</span> <span class="hs-varop">*</span> <span class="hs-varid">y'</span> <span class="hs-varop">&lt;</span>  <span class="hs-varid">x'</span> <span class="hs-varop">*</span> <span class="hs-varid">y</span>
<a name="line-5"></a>
<a name="line-6"></a><a name="instance%20Num%20(Ratio%20a)"></a><span class="hs-keyword">instance</span>  <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Num</span> <span class="hs-layout">(</span><span class="hs-conid">Ratio</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyword">where</span>
<a name="line-7"></a>    <span class="hs-comment">{-# SPECIALIZE instance Num Rational #-}</span>
<a name="line-8"></a>    <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span> <span class="hs-varop">+</span> <span class="hs-layout">(</span><span class="hs-varid">x'</span><span class="hs-conop">:%</span><span class="hs-varid">y'</span><span class="hs-layout">)</span>   <span class="hs-keyglyph">=</span>  <span class="hs-varid">reduce</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-varop">*</span><span class="hs-varid">y'</span> <span class="hs-varop">+</span> <span class="hs-varid">x'</span><span class="hs-varop">*</span><span class="hs-varid">y</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">y</span><span class="hs-varop">*</span><span class="hs-varid">y'</span><span class="hs-layout">)</span>
<a name="line-9"></a>    <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span> <span class="hs-comment">-</span> <span class="hs-layout">(</span><span class="hs-varid">x'</span><span class="hs-conop">:%</span><span class="hs-varid">y'</span><span class="hs-layout">)</span>   <span class="hs-keyglyph">=</span>  <span class="hs-varid">reduce</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-varop">*</span><span class="hs-varid">y'</span> <span class="hs-comment">-</span> <span class="hs-varid">x'</span><span class="hs-varop">*</span><span class="hs-varid">y</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">y</span><span class="hs-varop">*</span><span class="hs-varid">y'</span><span class="hs-layout">)</span>
<a name="line-10"></a>    <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span> <span class="hs-varop">*</span> <span class="hs-layout">(</span><span class="hs-varid">x'</span><span class="hs-conop">:%</span><span class="hs-varid">y'</span><span class="hs-layout">)</span>   <span class="hs-keyglyph">=</span>  <span class="hs-varid">reduce</span> <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">*</span> <span class="hs-varid">x'</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">y</span> <span class="hs-varop">*</span> <span class="hs-varid">y'</span><span class="hs-layout">)</span>
<a name="line-11"></a>    <span class="hs-varid">negate</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span>       <span class="hs-keyglyph">=</span>  <span class="hs-layout">(</span><span class="hs-comment">-</span><span class="hs-varid">x</span><span class="hs-layout">)</span> <span class="hs-conop">:%</span> <span class="hs-varid">y</span>
<a name="line-12"></a>    <span class="hs-varid">abs</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span>          <span class="hs-keyglyph">=</span>  <span class="hs-varid">abs</span> <span class="hs-varid">x</span> <span class="hs-conop">:%</span> <span class="hs-varid">y</span>
<a name="line-13"></a>    <span class="hs-varid">signum</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-keyword">_</span><span class="hs-layout">)</span>       <span class="hs-keyglyph">=</span>  <span class="hs-varid">signum</span> <span class="hs-varid">x</span> <span class="hs-conop">:%</span> <span class="hs-num">1</span>
<a name="line-14"></a>    <span class="hs-varid">fromInteger</span> <span class="hs-varid">x</span>       <span class="hs-keyglyph">=</span>  <span class="hs-varid">fromInteger</span> <span class="hs-varid">x</span> <span class="hs-conop">:%</span> <span class="hs-num">1</span>
<a name="line-15"></a>
<a name="line-16"></a><a name="instance%20Fractional%20(Ratio%20a)"></a><span class="hs-comment">{-# RULES &quot;fromRational/id&quot; fromRational = id :: Rational -&gt; Rational #-}</span>
<a name="line-17"></a><a name="instance%20Fractional%20(Ratio%20a)"></a><span class="hs-keyword">instance</span>  <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Fractional</span> <span class="hs-layout">(</span><span class="hs-conid">Ratio</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyword">where</span>
<a name="line-18"></a>    <span class="hs-comment">{-# SPECIALIZE instance Fractional Rational #-}</span>
<a name="line-19"></a>    <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span> <span class="hs-varop">/</span> <span class="hs-layout">(</span><span class="hs-varid">x'</span><span class="hs-conop">:%</span><span class="hs-varid">y'</span><span class="hs-layout">)</span>   <span class="hs-keyglyph">=</span>  <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-varop">*</span><span class="hs-varid">y'</span><span class="hs-layout">)</span> <span class="hs-varop">%</span> <span class="hs-layout">(</span><span class="hs-varid">y</span><span class="hs-varop">*</span><span class="hs-varid">x'</span><span class="hs-layout">)</span>
<a name="line-20"></a>    <span class="hs-varid">recip</span> <span class="hs-layout">(</span><span class="hs-num">0</span><span class="hs-conop">:%</span><span class="hs-keyword">_</span><span class="hs-layout">)</span>        <span class="hs-keyglyph">=</span> <span class="hs-varid">ratioZeroDenominatorError</span>
<a name="line-21"></a>    <span class="hs-varid">recip</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span>
<a name="line-22"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">x</span> <span class="hs-varop">&lt;</span> <span class="hs-num">0</span>         <span class="hs-keyglyph">=</span> <span class="hs-varid">negate</span> <span class="hs-varid">y</span> <span class="hs-conop">:%</span> <span class="hs-varid">negate</span> <span class="hs-varid">x</span>
<a name="line-23"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>     <span class="hs-keyglyph">=</span> <span class="hs-varid">y</span> <span class="hs-conop">:%</span> <span class="hs-varid">x</span>
<a name="line-24"></a>    <span class="hs-varid">fromRational</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span>  <span class="hs-varid">fromInteger</span> <span class="hs-varid">x</span> <span class="hs-varop">%</span> <span class="hs-varid">fromInteger</span> <span class="hs-varid">y</span>
<a name="line-25"></a>
<a name="line-26"></a><a name="instance%20Real%20(Ratio%20a)"></a><span class="hs-keyword">instance</span>  <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Real</span> <span class="hs-layout">(</span><span class="hs-conid">Ratio</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyword">where</span>
<a name="line-27"></a>    <span class="hs-comment">{-# SPECIALIZE instance Real Rational #-}</span>
<a name="line-28"></a>    <span class="hs-varid">toRational</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span>   <span class="hs-keyglyph">=</span>  <span class="hs-varid">toInteger</span> <span class="hs-varid">x</span> <span class="hs-conop">:%</span> <span class="hs-varid">toInteger</span> <span class="hs-varid">y</span>
<a name="line-29"></a>
<a name="line-30"></a><a name="instance%20RealFrac%20(Ratio%20a)"></a><span class="hs-keyword">instance</span>  <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">RealFrac</span> <span class="hs-layout">(</span><span class="hs-conid">Ratio</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyword">where</span>
<a name="line-31"></a>    <span class="hs-comment">{-# SPECIALIZE instance RealFrac Rational #-}</span>
<a name="line-32"></a>    <span class="hs-varid">properFraction</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">fromInteger</span> <span class="hs-layout">(</span><span class="hs-varid">toInteger</span> <span class="hs-varid">q</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-varid">r</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span>
<a name="line-33"></a>                          <span class="hs-keyword">where</span> <span class="hs-layout">(</span><span class="hs-varid">q</span><span class="hs-layout">,</span><span class="hs-varid">r</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">quotRem</span> <span class="hs-varid">x</span> <span class="hs-varid">y</span>
<a name="line-34"></a>
<a name="line-35"></a><a name="instance%20Show%20(Ratio%20a)"></a><span class="hs-keyword">instance</span>  <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Show</span> <span class="hs-layout">(</span><span class="hs-conid">Ratio</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyword">where</span>
<a name="line-36"></a>    <span class="hs-comment">{-# SPECIALIZE instance Show Rational #-}</span>
<a name="line-37"></a>    <span class="hs-varid">showsPrec</span> <span class="hs-varid">p</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-conop">:%</span><span class="hs-varid">y</span><span class="hs-layout">)</span>  <span class="hs-keyglyph">=</span>  <span class="hs-varid">showParen</span> <span class="hs-layout">(</span><span class="hs-varid">p</span> <span class="hs-varop">&gt;</span> <span class="hs-varid">ratioPrec</span><span class="hs-layout">)</span> <span class="hs-varop">$</span>
<a name="line-38"></a>                           <span class="hs-varid">showsPrec</span> <span class="hs-varid">ratioPrec1</span> <span class="hs-varid">x</span> <span class="hs-varop">.</span>
<a name="line-39"></a>                           <span class="hs-varid">showString</span> <span class="hs-str">&quot; % &quot;</span> <span class="hs-varop">.</span>
<a name="line-40"></a>                           <span class="hs-comment">-- H98 report has spaces round the %</span>
<a name="line-41"></a>                           <span class="hs-comment">-- but we removed them [May 04]</span>
<a name="line-42"></a>                           <span class="hs-comment">-- and added them again for consistency with</span>
<a name="line-43"></a>                           <span class="hs-comment">-- Haskell 98 [Sep 08, #1920]</span>
<a name="line-44"></a>                           <span class="hs-varid">showsPrec</span> <span class="hs-varid">ratioPrec1</span> <span class="hs-varid">y</span>
<a name="line-45"></a>
<a name="line-46"></a><a name="instance%20Enum%20(Ratio%20a)"></a><span class="hs-keyword">instance</span>  <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Enum</span> <span class="hs-layout">(</span><span class="hs-conid">Ratio</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>  <span class="hs-keyword">where</span>
<a name="line-47"></a>    <span class="hs-comment">{-# SPECIALIZE instance Enum Rational #-}</span>
<a name="line-48"></a>    <span class="hs-varid">succ</span> <span class="hs-varid">x</span>              <span class="hs-keyglyph">=</span>  <span class="hs-varid">x</span> <span class="hs-varop">+</span> <span class="hs-num">1</span>
<a name="line-49"></a>    <span class="hs-varid">pred</span> <span class="hs-varid">x</span>              <span class="hs-keyglyph">=</span>  <span class="hs-varid">x</span> <span class="hs-comment">-</span> <span class="hs-num">1</span>
<a name="line-50"></a>
<a name="line-51"></a>    <span class="hs-varid">toEnum</span> <span class="hs-varid">n</span>            <span class="hs-keyglyph">=</span>  <span class="hs-varid">fromIntegral</span> <span class="hs-varid">n</span> <span class="hs-conop">:%</span> <span class="hs-num">1</span>
<a name="line-52"></a>    <span class="hs-varid">fromEnum</span>            <span class="hs-keyglyph">=</span>  <span class="hs-varid">fromInteger</span> <span class="hs-varop">.</span> <span class="hs-varid">truncate</span>
<a name="line-53"></a>
<a name="line-54"></a>    <span class="hs-varid">enumFrom</span>            <span class="hs-keyglyph">=</span>  <span class="hs-varid">numericEnumFrom</span>
<a name="line-55"></a>    <span class="hs-varid">enumFromThen</span>        <span class="hs-keyglyph">=</span>  <span class="hs-varid">numericEnumFromThen</span>
<a name="line-56"></a>    <span class="hs-varid">enumFromTo</span>          <span class="hs-keyglyph">=</span>  <span class="hs-varid">numericEnumFromTo</span>
<a name="line-57"></a>    <span class="hs-varid">enumFromThenTo</span>      <span class="hs-keyglyph">=</span>  <span class="hs-varid">numericEnumFromThenTo</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{Coercions}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="fromIntegral"></a><span class="hs-comment">-- | general coercion from integral types</span>
<a name="line-2"></a><span class="hs-definition">fromIntegral</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Num</span> <span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">b</span>
<a name="line-3"></a><span class="hs-definition">fromIntegral</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">fromInteger</span> <span class="hs-varop">.</span> <span class="hs-varid">toInteger</span>
<a name="line-4"></a>
<a name="line-5"></a><span class="hs-comment">{-# RULES
<a name="line-6"></a>&quot;fromIntegral/Int-&gt;Int&quot; fromIntegral = id :: Int -&gt; Int
<a name="line-7"></a>    #-}</span>
<a name="line-8"></a>
<a name="line-9"></a><span class="hs-comment">{-# RULES
<a name="line-10"></a>&quot;fromIntegral/Int-&gt;Word&quot;  fromIntegral = \(I# x#) -&gt; W# (int2Word# x#)
<a name="line-11"></a>&quot;fromIntegral/Word-&gt;Int&quot;  fromIntegral = \(W# x#) -&gt; I# (word2Int# x#)
<a name="line-12"></a>&quot;fromIntegral/Word-&gt;Word&quot; fromIntegral = id :: Word -&gt; Word
<a name="line-13"></a>    #-}</span>
<a name="line-14"></a>
<a name="line-15"></a><a name="realToFrac"></a><span class="hs-comment">-- | general coercion to fractional types</span>
<a name="line-16"></a><span class="hs-definition">realToFrac</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Real</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Fractional</span> <span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">b</span>
<a name="line-17"></a><span class="hs-definition">realToFrac</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">fromRational</span> <span class="hs-varop">.</span> <span class="hs-varid">toRational</span>
</pre>\end{code}

%*********************************************************
%*                                                      *
\subsection{Overloaded numeric functions}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="showSigned"></a><span class="hs-comment">-- | Converts a possibly-negative 'Real' value to a string.</span>
<a name="line-2"></a><span class="hs-definition">showSigned</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Real</span> <span class="hs-varid">a</span><span class="hs-layout">)</span>
<a name="line-3"></a>  <span class="hs-keyglyph">=&gt;</span> <span class="hs-layout">(</span><span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span><span class="hs-layout">)</span>       <span class="hs-comment">-- ^ a function that can show unsigned values</span>
<a name="line-4"></a>  <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span>                <span class="hs-comment">-- ^ the precedence of the enclosing context</span>
<a name="line-5"></a>  <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>                  <span class="hs-comment">-- ^ the value to show</span>
<a name="line-6"></a>  <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ShowS</span>
<a name="line-7"></a><span class="hs-definition">showSigned</span> <span class="hs-varid">showPos</span> <span class="hs-varid">p</span> <span class="hs-varid">x</span>
<a name="line-8"></a>   <span class="hs-keyglyph">|</span> <span class="hs-varid">x</span> <span class="hs-varop">&lt;</span> <span class="hs-num">0</span>     <span class="hs-keyglyph">=</span> <span class="hs-varid">showParen</span> <span class="hs-layout">(</span><span class="hs-varid">p</span> <span class="hs-varop">&gt;</span> <span class="hs-num">6</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">showChar</span> <span class="hs-chr">'-'</span> <span class="hs-varop">.</span> <span class="hs-varid">showPos</span> <span class="hs-layout">(</span><span class="hs-comment">-</span><span class="hs-varid">x</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-9"></a>   <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">showPos</span> <span class="hs-varid">x</span>
<a name="line-10"></a>
<a name="line-11"></a><a name="even"></a><span class="hs-definition">even</span><span class="hs-layout">,</span> <span class="hs-varid">odd</span>       <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Bool</span>
<a name="line-12"></a><span class="hs-definition">even</span> <span class="hs-varid">n</span>          <span class="hs-keyglyph">=</span>  <span class="hs-varid">n</span> <span class="hs-varop">`rem`</span> <span class="hs-num">2</span> <span class="hs-varop">==</span> <span class="hs-num">0</span>
<a name="line-13"></a><a name="odd"></a><span class="hs-definition">odd</span>             <span class="hs-keyglyph">=</span>  <span class="hs-varid">not</span> <span class="hs-varop">.</span> <span class="hs-varid">even</span>
<a name="line-14"></a>
<a name="line-15"></a><span class="hs-comment">-------------------------------------------------------</span>
<a name="line-16"></a><span class="hs-comment">-- | raise a number to a non-negative integral power</span>
<a name="line-17"></a><span class="hs-comment">{-# SPECIALISE [1] (^) ::
<a name="line-18"></a>        Integer -&gt; Integer -&gt; Integer,
<a name="line-19"></a>        Integer -&gt; Int -&gt; Integer,
<a name="line-20"></a>        Int -&gt; Int -&gt; Int #-}</span>
<a name="line-21"></a><span class="hs-comment">{-# INLINABLE (^) #-}</span>    <span class="hs-comment">-- See Note [Inlining (^)]</span>
<a name="line-22"></a><a name="%5e"></a><span class="hs-layout">(</span><span class="hs-varop">^</span><span class="hs-layout">)</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Num</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Integral</span> <span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">b</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-23"></a><a name="x0"></a><span class="hs-definition">x0</span> <span class="hs-varop">^</span> <span class="hs-varid">y0</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">y0</span> <span class="hs-varop">&lt;</span> <span class="hs-num">0</span>    <span class="hs-keyglyph">=</span> <span class="hs-varid">error</span> <span class="hs-str">&quot;Negative exponent&quot;</span>
<a name="line-24"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">y0</span> <span class="hs-varop">==</span> <span class="hs-num">0</span>   <span class="hs-keyglyph">=</span> <span class="hs-num">1</span>
<a name="line-25"></a>        <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">f</span> <span class="hs-varid">x0</span> <span class="hs-varid">y0</span>
<a name="line-26"></a>    <span class="hs-keyword">where</span> <span class="hs-comment">-- f : x0 ^ y0 = x ^ y</span>
<a name="line-27"></a>          <span class="hs-varid">f</span> <span class="hs-varid">x</span> <span class="hs-varid">y</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">even</span> <span class="hs-varid">y</span>    <span class="hs-keyglyph">=</span> <span class="hs-varid">f</span> <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">*</span> <span class="hs-varid">x</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">y</span> <span class="hs-varop">`quot`</span> <span class="hs-num">2</span><span class="hs-layout">)</span>
<a name="line-28"></a>                <span class="hs-keyglyph">|</span> <span class="hs-varid">y</span> <span class="hs-varop">==</span> <span class="hs-num">1</span>    <span class="hs-keyglyph">=</span> <span class="hs-varid">x</span>
<a name="line-29"></a>                <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">g</span> <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">*</span> <span class="hs-varid">x</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-layout">(</span><span class="hs-varid">y</span> <span class="hs-comment">-</span> <span class="hs-num">1</span><span class="hs-layout">)</span> <span class="hs-varop">`quot`</span> <span class="hs-num">2</span><span class="hs-layout">)</span> <span class="hs-varid">x</span>
<a name="line-30"></a>          <span class="hs-comment">-- g : x0 ^ y0 = (x ^ y) * z</span>
<a name="line-31"></a>          <span class="hs-varid">g</span> <span class="hs-varid">x</span> <span class="hs-varid">y</span> <span class="hs-varid">z</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">even</span> <span class="hs-varid">y</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">g</span> <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">*</span> <span class="hs-varid">x</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">y</span> <span class="hs-varop">`quot`</span> <span class="hs-num">2</span><span class="hs-layout">)</span> <span class="hs-varid">z</span>
<a name="line-32"></a>                  <span class="hs-keyglyph">|</span> <span class="hs-varid">y</span> <span class="hs-varop">==</span> <span class="hs-num">1</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">x</span> <span class="hs-varop">*</span> <span class="hs-varid">z</span>
<a name="line-33"></a>                  <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">g</span> <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">*</span> <span class="hs-varid">x</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-layout">(</span><span class="hs-varid">y</span> <span class="hs-comment">-</span> <span class="hs-num">1</span><span class="hs-layout">)</span> <span class="hs-varop">`quot`</span> <span class="hs-num">2</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">*</span> <span class="hs-varid">z</span><span class="hs-layout">)</span>
<a name="line-34"></a>
<a name="line-35"></a><a name="%5e%5e"></a><span class="hs-comment">-- | raise a number to an integral power</span>
<a name="line-36"></a><span class="hs-layout">(</span><span class="hs-varop">^^</span><span class="hs-layout">)</span>            <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Fractional</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Integral</span> <span class="hs-varid">b</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">b</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-37"></a><span class="hs-comment">{-# INLINABLE (^^) #-}</span>         <span class="hs-comment">-- See Note [Inlining (^)</span>
<a name="line-38"></a><a name="x"></a><span class="hs-definition">x</span> <span class="hs-varop">^^</span> <span class="hs-varid">n</span>          <span class="hs-keyglyph">=</span>  <span class="hs-keyword">if</span> <span class="hs-varid">n</span> <span class="hs-varop">&gt;=</span> <span class="hs-num">0</span> <span class="hs-keyword">then</span> <span class="hs-varid">x</span><span class="hs-varop">^</span><span class="hs-varid">n</span> <span class="hs-keyword">else</span> <span class="hs-varid">recip</span> <span class="hs-layout">(</span><span class="hs-varid">x</span><span class="hs-varop">^</span><span class="hs-layout">(</span><span class="hs-varid">negate</span> <span class="hs-varid">n</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-39"></a>
<a name="line-40"></a><span class="hs-comment">{- Note [Inlining (^)
<a name="line-41"></a>   ~~~~~~~~~~~~~~~~~~~~~
<a name="line-42"></a>   The INLINABLE pragma allows (^) to be specialised at its call sites.
<a name="line-43"></a>   If it is called repeatedly at the same type, that can make a huge
<a name="line-44"></a>   difference, because of those constants which can be repeatedly
<a name="line-45"></a>   calculated.
<a name="line-46"></a>
<a name="line-47"></a>   Currently the fromInteger calls are not floated because we get
<a name="line-48"></a>             \d1 d2 x y -&gt; blah
<a name="line-49"></a>   after the gentle round of simplification. -}</span>
<a name="line-50"></a>
<a name="line-51"></a><span class="hs-comment">{- Rules for powers with known small exponent
<a name="line-52"></a>    see #5237
<a name="line-53"></a>    For small exponents, (^) is inefficient compared to manually
<a name="line-54"></a>    expanding the multiplication tree.
<a name="line-55"></a>    Here, rules for the most common exponent types are given.
<a name="line-56"></a>    The range of exponents for which rules are given is quite
<a name="line-57"></a>    arbitrary and kept small to not unduly increase the number of rules.
<a name="line-58"></a>    0 and 1 are excluded based on the assumption that nobody would
<a name="line-59"></a>    write x^0 or x^1 in code and the cases where an exponent could
<a name="line-60"></a>    be statically resolved to 0 or 1 are rare.
<a name="line-61"></a>
<a name="line-62"></a>    It might be desirable to have corresponding rules also for
<a name="line-63"></a>    exponents of other types, in particular Word, but we can't
<a name="line-64"></a>    have those rules here (importing GHC.Word or GHC.Int would
<a name="line-65"></a>    create a cyclic module dependency), and it's doubtful they
<a name="line-66"></a>    would fire, since the exponents of other types tend to get
<a name="line-67"></a>    floated out before the rule has a chance to fire.
<a name="line-68"></a>
<a name="line-69"></a>    Also desirable would be rules for (^^), but I haven't managed
<a name="line-70"></a>    to get those to fire.
<a name="line-71"></a>
<a name="line-72"></a>    Note: Trying to save multiplications by sharing the square for
<a name="line-73"></a>    exponents 4 and 5 does not save time, indeed, for Double, it is
<a name="line-74"></a>    up to twice slower, so the rules contain flat sequences of
<a name="line-75"></a>    multiplications.
<a name="line-76"></a>-}</span>
<a name="line-77"></a>
<a name="line-78"></a><span class="hs-comment">{-# RULES
<a name="line-79"></a>&quot;^2/Int&quot;        forall x. x ^ (2 :: Int) = let u = x in u*u
<a name="line-80"></a>&quot;^3/Int&quot;        forall x. x ^ (3 :: Int) = let u = x in u*u*u
<a name="line-81"></a>&quot;^4/Int&quot;        forall x. x ^ (4 :: Int) = let u = x in u*u*u*u
<a name="line-82"></a>&quot;^5/Int&quot;        forall x. x ^ (5 :: Int) = let u = x in u*u*u*u*u
<a name="line-83"></a>&quot;^2/Integer&quot;    forall x. x ^ (2 :: Integer) = let u = x in u*u
<a name="line-84"></a>&quot;^3/Integer&quot;    forall x. x ^ (3 :: Integer) = let u = x in u*u*u
<a name="line-85"></a>&quot;^4/Integer&quot;    forall x. x ^ (4 :: Integer) = let u = x in u*u*u*u
<a name="line-86"></a>&quot;^5/Integer&quot;    forall x. x ^ (5 :: Integer) = let u = x in u*u*u*u*u
<a name="line-87"></a>  #-}</span>
<a name="line-88"></a>
<a name="line-89"></a><span class="hs-comment">-------------------------------------------------------</span>
<a name="line-90"></a><span class="hs-comment">-- Special power functions for Rational</span>
<a name="line-91"></a><span class="hs-comment">--</span>
<a name="line-92"></a><span class="hs-comment">-- see #4337</span>
<a name="line-93"></a><span class="hs-comment">--</span>
<a name="line-94"></a><span class="hs-comment">-- Rationale:</span>
<a name="line-95"></a><span class="hs-comment">-- For a legitimate Rational (n :% d), the numerator and denominator are</span>
<a name="line-96"></a><span class="hs-comment">-- coprime, i.e. they have no common prime factor.</span>
<a name="line-97"></a><span class="hs-comment">-- Therefore all powers (n ^ a) and (d ^ b) are also coprime, so it is</span>
<a name="line-98"></a><span class="hs-comment">-- not necessary to compute the greatest common divisor, which would be</span>
<a name="line-99"></a><span class="hs-comment">-- done in the default implementation at each multiplication step.</span>
<a name="line-100"></a><span class="hs-comment">-- Since exponentiation quickly leads to very large numbers and</span>
<a name="line-101"></a><span class="hs-comment">-- calculation of gcds is generally very slow for large numbers,</span>
<a name="line-102"></a><span class="hs-comment">-- avoiding the gcd leads to an order of magnitude speedup relatively</span>
<a name="line-103"></a><span class="hs-comment">-- soon (and an asymptotic improvement overall).</span>
<a name="line-104"></a><span class="hs-comment">--</span>
<a name="line-105"></a><span class="hs-comment">-- Note:</span>
<a name="line-106"></a><span class="hs-comment">-- We cannot use these functions for general Ratio a because that would</span>
<a name="line-107"></a><span class="hs-comment">-- change results in a multitude of cases.</span>
<a name="line-108"></a><span class="hs-comment">-- The cause is that if a and b are coprime, their remainders by any</span>
<a name="line-109"></a><span class="hs-comment">-- positive modulus generally aren't, so in the default implementation</span>
<a name="line-110"></a><span class="hs-comment">-- reduction occurs.</span>
<a name="line-111"></a><span class="hs-comment">--</span>
<a name="line-112"></a><span class="hs-comment">-- Example:</span>
<a name="line-113"></a><span class="hs-comment">-- (17 % 3) ^ 3 :: Ratio Word8</span>
<a name="line-114"></a><span class="hs-comment">-- Default:</span>
<a name="line-115"></a><span class="hs-comment">-- (17 % 3) ^ 3 = ((17 % 3) ^ 2) * (17 % 3)</span>
<a name="line-116"></a><span class="hs-comment">--              = ((289 `mod` 256) % 9) * (17 % 3)</span>
<a name="line-117"></a><span class="hs-comment">--              = (33 % 9) * (17 % 3)</span>
<a name="line-118"></a><span class="hs-comment">--              = (11 % 3) * (17 % 3)</span>
<a name="line-119"></a><span class="hs-comment">--              = (187 % 9)</span>
<a name="line-120"></a><span class="hs-comment">-- But:</span>
<a name="line-121"></a><span class="hs-comment">-- ((17^3) `mod` 256) % (3^3)   = (4913 `mod` 256) % 27</span>
<a name="line-122"></a><span class="hs-comment">--                              = 49 % 27</span>
<a name="line-123"></a><span class="hs-comment">--</span>
<a name="line-124"></a><span class="hs-comment">-- TODO:</span>
<a name="line-125"></a><span class="hs-comment">-- Find out whether special-casing for numerator, denominator or</span>
<a name="line-126"></a><span class="hs-comment">-- exponent = 1 (or -1, where that may apply) gains something.</span>
<a name="line-127"></a>
<a name="line-128"></a><a name="%5e%25%5e"></a><span class="hs-comment">-- Special version of (^) for Rational base</span>
<a name="line-129"></a><span class="hs-comment">{-# RULES &quot;(^)/Rational&quot;    (^) = (^%^) #-}</span>
<a name="line-130"></a><span class="hs-layout">(</span><span class="hs-varop">^%^</span><span class="hs-layout">)</span>           <span class="hs-keyglyph">::</span> <span class="hs-conid">Integral</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Rational</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Rational</span>
<a name="line-131"></a><span class="hs-layout">(</span><span class="hs-varid">n</span> <span class="hs-conop">:%</span> <span class="hs-varid">d</span><span class="hs-layout">)</span> <span class="hs-varop">^%^</span> <span class="hs-varid">e</span>
<a name="line-132"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">e</span> <span class="hs-varop">&lt;</span> <span class="hs-num">0</span>     <span class="hs-keyglyph">=</span> <span class="hs-varid">error</span> <span class="hs-str">&quot;Negative exponent&quot;</span>
<a name="line-133"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">e</span> <span class="hs-varop">==</span> <span class="hs-num">0</span>    <span class="hs-keyglyph">=</span> <span class="hs-num">1</span> <span class="hs-conop">:%</span> <span class="hs-num">1</span>
<a name="line-134"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">n</span> <span class="hs-varop">^</span> <span class="hs-varid">e</span><span class="hs-layout">)</span> <span class="hs-conop">:%</span> <span class="hs-layout">(</span><span class="hs-varid">d</span> <span class="hs-varop">^</span> <span class="hs-varid">e</span><span class="hs-layout">)</span>
<a name="line-135"></a>
<a name="line-136"></a><a name="%5e%5e%25%5e%5e"></a><span class="hs-comment">-- Special version of (^^) for Rational base</span>
<a name="line-137"></a><span class="hs-comment">{-# RULES &quot;(^^)/Rational&quot;   (^^) = (^^%^^) #-}</span>
<a name="line-138"></a><span class="hs-layout">(</span><span class="hs-varop">^^%^^</span><span class="hs-layout">)</span>         <span class="hs-keyglyph">::</span> <span class="hs-conid">Integral</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Rational</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Rational</span>
<a name="line-139"></a><span class="hs-layout">(</span><span class="hs-varid">n</span> <span class="hs-conop">:%</span> <span class="hs-varid">d</span><span class="hs-layout">)</span> <span class="hs-varop">^^%^^</span> <span class="hs-varid">e</span>
<a name="line-140"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">e</span> <span class="hs-varop">&gt;</span> <span class="hs-num">0</span>     <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">n</span> <span class="hs-varop">^</span> <span class="hs-varid">e</span><span class="hs-layout">)</span> <span class="hs-conop">:%</span> <span class="hs-layout">(</span><span class="hs-varid">d</span> <span class="hs-varop">^</span> <span class="hs-varid">e</span><span class="hs-layout">)</span>
<a name="line-141"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">e</span> <span class="hs-varop">==</span> <span class="hs-num">0</span>    <span class="hs-keyglyph">=</span> <span class="hs-num">1</span> <span class="hs-conop">:%</span> <span class="hs-num">1</span>
<a name="line-142"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">n</span> <span class="hs-varop">&gt;</span> <span class="hs-num">0</span>     <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">d</span> <span class="hs-varop">^</span> <span class="hs-layout">(</span><span class="hs-varid">negate</span> <span class="hs-varid">e</span><span class="hs-layout">)</span><span class="hs-layout">)</span> <span class="hs-conop">:%</span> <span class="hs-layout">(</span><span class="hs-varid">n</span> <span class="hs-varop">^</span> <span class="hs-layout">(</span><span class="hs-varid">negate</span> <span class="hs-varid">e</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-143"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">n</span> <span class="hs-varop">==</span> <span class="hs-num">0</span>    <span class="hs-keyglyph">=</span> <span class="hs-varid">ratioZeroDenominatorError</span>
<a name="line-144"></a>    <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">let</span> <span class="hs-varid">nn</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">d</span> <span class="hs-varop">^</span> <span class="hs-layout">(</span><span class="hs-varid">negate</span> <span class="hs-varid">e</span><span class="hs-layout">)</span>
<a name="line-145"></a>                      <span class="hs-varid">dd</span> <span class="hs-keyglyph">=</span> <span class="hs-layout">(</span><span class="hs-varid">negate</span> <span class="hs-varid">n</span><span class="hs-layout">)</span> <span class="hs-varop">^</span> <span class="hs-layout">(</span><span class="hs-varid">negate</span> <span class="hs-varid">e</span><span class="hs-layout">)</span>
<a name="line-146"></a>                  <span class="hs-keyword">in</span> <span class="hs-keyword">if</span> <span class="hs-varid">even</span> <span class="hs-varid">e</span> <span class="hs-keyword">then</span> <span class="hs-layout">(</span><span class="hs-varid">nn</span> <span class="hs-conop">:%</span> <span class="hs-varid">dd</span><span class="hs-layout">)</span> <span class="hs-keyword">else</span> <span class="hs-layout">(</span><span class="hs-varid">negate</span> <span class="hs-varid">nn</span> <span class="hs-conop">:%</span> <span class="hs-varid">dd</span><span class="hs-layout">)</span>
<a name="line-147"></a>
<a name="line-148"></a><a name="gcd"></a><span class="hs-comment">-------------------------------------------------------</span>
<a name="line-149"></a><span class="hs-comment">-- | @'gcd' x y@ is the non-negative factor of both @x@ and @y@ of which</span>
<a name="line-150"></a><span class="hs-comment">-- every common factor of @x@ and @y@ is also a factor; for example</span>
<a name="line-151"></a><span class="hs-comment">-- @'gcd' 4 2 = 2@, @'gcd' (-4) 6 = 2@, @'gcd' 0 4@ = @4@. @'gcd' 0 0@ = @0@.</span>
<a name="line-152"></a><span class="hs-comment">-- (That is, the common divisor that is \&quot;greatest\&quot; in the divisibility</span>
<a name="line-153"></a><span class="hs-comment">-- preordering.)</span>
<a name="line-154"></a><span class="hs-comment">--</span>
<a name="line-155"></a><span class="hs-comment">-- Note: Since for signed fixed-width integer types, @'abs' 'minBound' &lt; 0@,</span>
<a name="line-156"></a><span class="hs-comment">-- the result may be negative if one of the arguments is @'minBound'@ (and</span>
<a name="line-157"></a><span class="hs-comment">-- necessarily is if the other is @0@ or @'minBound'@) for such types.</span>
<a name="line-158"></a><span class="hs-definition">gcd</span>             <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-159"></a><span class="hs-definition">gcd</span> <span class="hs-varid">x</span> <span class="hs-varid">y</span>         <span class="hs-keyglyph">=</span>  <span class="hs-varid">gcd'</span> <span class="hs-layout">(</span><span class="hs-varid">abs</span> <span class="hs-varid">x</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">abs</span> <span class="hs-varid">y</span><span class="hs-layout">)</span>
<a name="line-160"></a>                   <span class="hs-keyword">where</span> <span class="hs-varid">gcd'</span> <span class="hs-varid">a</span> <span class="hs-num">0</span>  <span class="hs-keyglyph">=</span>  <span class="hs-varid">a</span>
<a name="line-161"></a>                         <span class="hs-varid">gcd'</span> <span class="hs-varid">a</span> <span class="hs-varid">b</span>  <span class="hs-keyglyph">=</span>  <span class="hs-varid">gcd'</span> <span class="hs-varid">b</span> <span class="hs-layout">(</span><span class="hs-varid">a</span> <span class="hs-varop">`rem`</span> <span class="hs-varid">b</span><span class="hs-layout">)</span>
<a name="line-162"></a>
<a name="line-163"></a><a name="lcm"></a><span class="hs-comment">-- | @'lcm' x y@ is the smallest positive integer that both @x@ and @y@ divide.</span>
<a name="line-164"></a><span class="hs-definition">lcm</span>             <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span>
<a name="line-165"></a><span class="hs-comment">{-# SPECIALISE lcm :: Int -&gt; Int -&gt; Int #-}</span>
<a name="line-166"></a><span class="hs-definition">lcm</span> <span class="hs-keyword">_</span> <span class="hs-num">0</span>         <span class="hs-keyglyph">=</span>  <span class="hs-num">0</span>
<a name="line-167"></a><span class="hs-definition">lcm</span> <span class="hs-num">0</span> <span class="hs-keyword">_</span>         <span class="hs-keyglyph">=</span>  <span class="hs-num">0</span>
<a name="line-168"></a><span class="hs-definition">lcm</span> <span class="hs-varid">x</span> <span class="hs-varid">y</span>         <span class="hs-keyglyph">=</span>  <span class="hs-varid">abs</span> <span class="hs-layout">(</span><span class="hs-layout">(</span><span class="hs-varid">x</span> <span class="hs-varop">`quot`</span> <span class="hs-layout">(</span><span class="hs-varid">gcd</span> <span class="hs-varid">x</span> <span class="hs-varid">y</span><span class="hs-layout">)</span><span class="hs-layout">)</span> <span class="hs-varop">*</span> <span class="hs-varid">y</span><span class="hs-layout">)</span>
<a name="line-169"></a>
<a name="line-170"></a><span class="hs-cpp">#ifdef OPTIMISE_INTEGER_GCD_LCM</span>
<a name="line-171"></a><span class="hs-comment">{-# RULES
<a name="line-172"></a>&quot;gcd/Int-&gt;Int-&gt;Int&quot;             gcd = gcdInt
<a name="line-173"></a>&quot;gcd/Integer-&gt;Integer-&gt;Integer&quot; gcd = gcdInteger
<a name="line-174"></a>&quot;lcm/Integer-&gt;Integer-&gt;Integer&quot; lcm = lcmInteger
<a name="line-175"></a> #-}</span>
<a name="line-176"></a>
<a name="line-177"></a><a name="gcdInt"></a><span class="hs-definition">gcdInt</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span>
<a name="line-178"></a><span class="hs-definition">gcdInt</span> <span class="hs-varid">a</span> <span class="hs-varid">b</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">fromIntegral</span> <span class="hs-layout">(</span><span class="hs-varid">gcdInteger</span> <span class="hs-layout">(</span><span class="hs-varid">fromIntegral</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">fromIntegral</span> <span class="hs-varid">b</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-179"></a><span class="hs-cpp">#endif</span>
<a name="line-180"></a>
<a name="line-181"></a><a name="integralEnumFrom"></a><span class="hs-definition">integralEnumFrom</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Bounded</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span>
<a name="line-182"></a><span class="hs-definition">integralEnumFrom</span> <span class="hs-varid">n</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">map</span> <span class="hs-varid">fromInteger</span> <span class="hs-keyglyph">[</span><span class="hs-varid">toInteger</span> <span class="hs-varid">n</span> <span class="hs-keyglyph">..</span> <span class="hs-varid">toInteger</span> <span class="hs-layout">(</span><span class="hs-varid">maxBound</span> <span class="hs-varop">`asTypeOf`</span> <span class="hs-varid">n</span><span class="hs-layout">)</span><span class="hs-keyglyph">]</span>
<a name="line-183"></a>
<a name="line-184"></a><a name="integralEnumFromThen"></a><span class="hs-definition">integralEnumFromThen</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Integral</span> <span class="hs-varid">a</span><span class="hs-layout">,</span> <span class="hs-conid">Bounded</span> <span class="hs-varid">a</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span>
<a name="line-185"></a><span class="hs-definition">integralEnumFromThen</span> <span class="hs-varid">n1</span> <span class="hs-varid">n2</span>
<a name="line-186"></a>  <span class="hs-keyglyph">|</span> <span class="hs-varid">i_n2</span> <span class="hs-varop">&gt;=</span> <span class="hs-varid">i_n1</span>  <span class="hs-keyglyph">=</span> <span class="hs-varid">map</span> <span class="hs-varid">fromInteger</span> <span class="hs-keyglyph">[</span><span class="hs-varid">i_n1</span><span class="hs-layout">,</span> <span class="hs-varid">i_n2</span> <span class="hs-keyglyph">..</span> <span class="hs-varid">toInteger</span> <span class="hs-layout">(</span><span class="hs-varid">maxBound</span> <span class="hs-varop">`asTypeOf`</span> <span class="hs-varid">n1</span><span class="hs-layout">)</span><span class="hs-keyglyph">]</span>
<a name="line-187"></a>  <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>     <span class="hs-keyglyph">=</span> <span class="hs-varid">map</span> <span class="hs-varid">fromInteger</span> <span class="hs-keyglyph">[</span><span class="hs-varid">i_n1</span><span class="hs-layout">,</span> <span class="hs-varid">i_n2</span> <span class="hs-keyglyph">..</span> <span class="hs-varid">toInteger</span> <span class="hs-layout">(</span><span class="hs-varid">minBound</span> <span class="hs-varop">`asTypeOf`</span> <span class="hs-varid">n1</span><span class="hs-layout">)</span><span class="hs-keyglyph">]</span>
<a name="line-188"></a>  <span class="hs-keyword">where</span>
<a name="line-189"></a>    <span class="hs-varid">i_n1</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">toInteger</span> <span class="hs-varid">n1</span>
<a name="line-190"></a>    <span class="hs-varid">i_n2</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">toInteger</span> <span class="hs-varid">n2</span>
<a name="line-191"></a>
<a name="line-192"></a><a name="integralEnumFromTo"></a><span class="hs-definition">integralEnumFromTo</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Integral</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span>
<a name="line-193"></a><span class="hs-definition">integralEnumFromTo</span> <span class="hs-varid">n</span> <span class="hs-varid">m</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">map</span> <span class="hs-varid">fromInteger</span> <span class="hs-keyglyph">[</span><span class="hs-varid">toInteger</span> <span class="hs-varid">n</span> <span class="hs-keyglyph">..</span> <span class="hs-varid">toInteger</span> <span class="hs-varid">m</span><span class="hs-keyglyph">]</span>
<a name="line-194"></a>
<a name="line-195"></a><a name="integralEnumFromThenTo"></a><span class="hs-definition">integralEnumFromThenTo</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Integral</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyglyph">[</span><span class="hs-varid">a</span><span class="hs-keyglyph">]</span>
<a name="line-196"></a><span class="hs-definition">integralEnumFromThenTo</span> <span class="hs-varid">n1</span> <span class="hs-varid">n2</span> <span class="hs-varid">m</span>
<a name="line-197"></a>  <span class="hs-keyglyph">=</span> <span class="hs-varid">map</span> <span class="hs-varid">fromInteger</span> <span class="hs-keyglyph">[</span><span class="hs-varid">toInteger</span> <span class="hs-varid">n1</span><span class="hs-layout">,</span> <span class="hs-varid">toInteger</span> <span class="hs-varid">n2</span> <span class="hs-keyglyph">..</span> <span class="hs-varid">toInteger</span> <span class="hs-varid">m</span><span class="hs-keyglyph">]</span>
</pre>\end{code}
</body>
</html>
