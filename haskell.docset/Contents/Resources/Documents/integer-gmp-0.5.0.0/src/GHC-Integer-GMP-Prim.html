<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>GHC/Integer/GMP/Prim.hs</title>
<link type="text/css" rel="stylesheet" href="hscolour.css"></link>
</head>
<body>
<pre><a name="line-1"></a><span class="hs-comment">{-# LANGUAGE ForeignFunctionInterface, GHCForeignImportPrim, CPP,
<a name="line-2"></a>             MagicHash, UnboxedTuples, UnliftedFFITypes, BangPatterns #-}</span>
<a name="line-3"></a><span class="hs-comment">{-# OPTIONS_GHC -XNoImplicitPrelude #-}</span>
<a name="line-4"></a><span class="hs-comment">{-# OPTIONS_HADDOCK hide #-}</span>
<a name="line-5"></a>
<a name="line-6"></a><span class="hs-cpp">#include &quot;MachDeps.h&quot;</span>
<a name="line-7"></a><span class="hs-keyword">module</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Integer</span><span class="hs-varop">.</span><span class="hs-conid">GMP</span><span class="hs-varop">.</span><span class="hs-conid">Prim</span> <span class="hs-layout">(</span>
<a name="line-8"></a>    <span class="hs-varid">cmpInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-9"></a>    <span class="hs-varid">cmpIntegerInt</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-10"></a>
<a name="line-11"></a>    <span class="hs-varid">plusInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-12"></a>    <span class="hs-varid">minusInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-13"></a>    <span class="hs-varid">timesInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-14"></a>
<a name="line-15"></a>    <span class="hs-varid">quotRemInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-16"></a>    <span class="hs-varid">quotInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-17"></a>    <span class="hs-varid">remInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-18"></a>    <span class="hs-varid">divModInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-19"></a>    <span class="hs-varid">divInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-20"></a>    <span class="hs-varid">modInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-21"></a>    <span class="hs-varid">divExactInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-22"></a>
<a name="line-23"></a>    <span class="hs-varid">gcdInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-24"></a>    <span class="hs-varid">gcdIntegerInt</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-25"></a>    <span class="hs-varid">gcdInt</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-26"></a>
<a name="line-27"></a>    <span class="hs-varid">decodeDouble</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-28"></a>
<a name="line-29"></a>    <span class="hs-varid">int2Integer</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-30"></a>    <span class="hs-varid">integer2Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-31"></a>
<a name="line-32"></a>    <span class="hs-varid">word2Integer</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-33"></a>    <span class="hs-varid">integer2Word</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-34"></a>
<a name="line-35"></a>    <span class="hs-varid">andInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-36"></a>    <span class="hs-varid">orInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-37"></a>    <span class="hs-varid">xorInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-38"></a>    <span class="hs-varid">complementInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-39"></a>
<a name="line-40"></a>    <span class="hs-varid">mul2ExpInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-41"></a>    <span class="hs-varid">fdivQ2ExpInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-42"></a>
<a name="line-43"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS &lt; 64</span>
<a name="line-44"></a>    <span class="hs-varid">int64ToInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>  <span class="hs-varid">integerToInt64</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-45"></a>    <span class="hs-varid">word64ToInteger</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-varid">integerToWord64</span><span class="hs-cpp">#</span><span class="hs-layout">,</span>
<a name="line-46"></a><span class="hs-cpp">#endif</span>
<a name="line-47"></a>
<a name="line-48"></a><span class="hs-cpp">#ifndef WORD_SIZE_IN_BITS</span>
<a name="line-49"></a><span class="hs-cpp">#error WORD_SIZE_IN_BITS not defined!!!</span>
<a name="line-50"></a><span class="hs-cpp">#endif</span>
<a name="line-51"></a>
<a name="line-52"></a>  <span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-53"></a>
<a name="line-54"></a><span class="hs-keyword">import</span> <span class="hs-conid">GHC</span><span class="hs-varop">.</span><span class="hs-conid">Prim</span>
<a name="line-55"></a>
<a name="line-56"></a><span class="hs-comment">-- Double isn't available yet, and we shouldn't be using defaults anyway:</span>
<a name="line-57"></a><span class="hs-keyword">default</span> <span class="hs-conid">()</span>
<a name="line-58"></a>
<a name="line-59"></a><span class="hs-comment">-- | Returns -1,0,1 according as first argument is less than, equal to, or greater than second argument.</span>
<a name="line-60"></a><span class="hs-comment">--</span>
<a name="line-61"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_cmpIntegerzh&quot;</span> <span class="hs-varid">cmpInteger</span><span class="hs-cpp">#</span>
<a name="line-62"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span>
<a name="line-63"></a>
<a name="line-64"></a><span class="hs-comment">-- | Returns -1,0,1 according as first argument is less than, equal to, or greater than second argument, which</span>
<a name="line-65"></a><span class="hs-comment">--   is an ordinary Int\#.</span>
<a name="line-66"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_cmpIntegerIntzh&quot;</span> <span class="hs-varid">cmpIntegerInt</span><span class="hs-cpp">#</span>
<a name="line-67"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span>
<a name="line-68"></a>
<a name="line-69"></a><span class="hs-comment">-- |</span>
<a name="line-70"></a><span class="hs-comment">--</span>
<a name="line-71"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_plusIntegerzh&quot;</span> <span class="hs-varid">plusInteger</span><span class="hs-cpp">#</span>
<a name="line-72"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-73"></a>
<a name="line-74"></a><span class="hs-comment">-- |</span>
<a name="line-75"></a><span class="hs-comment">--</span>
<a name="line-76"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_minusIntegerzh&quot;</span> <span class="hs-varid">minusInteger</span><span class="hs-cpp">#</span>
<a name="line-77"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-78"></a>
<a name="line-79"></a><span class="hs-comment">-- |</span>
<a name="line-80"></a><span class="hs-comment">--</span>
<a name="line-81"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_timesIntegerzh&quot;</span> <span class="hs-varid">timesInteger</span><span class="hs-cpp">#</span>
<a name="line-82"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-83"></a>
<a name="line-84"></a><span class="hs-comment">-- | Compute div and mod simultaneously, where div rounds towards negative</span>
<a name="line-85"></a><span class="hs-comment">-- infinity and\ @(q,r) = divModInteger#(x,y)@ implies</span>
<a name="line-86"></a><span class="hs-comment">-- @plusInteger# (timesInteger# q y) r = x@.</span>
<a name="line-87"></a><span class="hs-comment">--</span>
<a name="line-88"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_quotRemIntegerzh&quot;</span> <span class="hs-varid">quotRemInteger</span><span class="hs-cpp">#</span>
<a name="line-89"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-90"></a>
<a name="line-91"></a><span class="hs-comment">-- | Rounds towards zero.</span>
<a name="line-92"></a><span class="hs-comment">--</span>
<a name="line-93"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_quotIntegerzh&quot;</span> <span class="hs-varid">quotInteger</span><span class="hs-cpp">#</span>
<a name="line-94"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-95"></a>
<a name="line-96"></a><span class="hs-comment">-- | Satisfies \texttt{plusInteger\# (timesInteger\# (quotInteger\# x y) y) (remInteger\# x y) == x}.</span>
<a name="line-97"></a><span class="hs-comment">--</span>
<a name="line-98"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_remIntegerzh&quot;</span> <span class="hs-varid">remInteger</span><span class="hs-cpp">#</span>
<a name="line-99"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-100"></a>
<a name="line-101"></a><span class="hs-comment">-- | Compute div and mod simultaneously, where div rounds towards negative infinity</span>
<a name="line-102"></a><span class="hs-comment">-- and\texttt{(q,r) = divModInteger\#(x,y)} implies \texttt{plusInteger\# (timesInteger\# q y) r = x}.</span>
<a name="line-103"></a><span class="hs-comment">--</span>
<a name="line-104"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_divModIntegerzh&quot;</span> <span class="hs-varid">divModInteger</span><span class="hs-cpp">#</span>
<a name="line-105"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-106"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_divIntegerzh&quot;</span> <span class="hs-varid">divInteger</span><span class="hs-cpp">#</span>
<a name="line-107"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-108"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_modIntegerzh&quot;</span> <span class="hs-varid">modInteger</span><span class="hs-cpp">#</span>
<a name="line-109"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-110"></a>
<a name="line-111"></a><span class="hs-comment">-- | Divisor is guaranteed to be a factor of dividend.</span>
<a name="line-112"></a><span class="hs-comment">--</span>
<a name="line-113"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_divExactIntegerzh&quot;</span> <span class="hs-varid">divExactInteger</span><span class="hs-cpp">#</span>
<a name="line-114"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-115"></a>
<a name="line-116"></a><span class="hs-comment">-- | Greatest common divisor.</span>
<a name="line-117"></a><span class="hs-comment">--</span>
<a name="line-118"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_gcdIntegerzh&quot;</span> <span class="hs-varid">gcdInteger</span><span class="hs-cpp">#</span>
<a name="line-119"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-120"></a>
<a name="line-121"></a><span class="hs-comment">-- | Greatest common divisor, where second argument is an ordinary {\tt Int\#}.</span>
<a name="line-122"></a><span class="hs-comment">--</span>
<a name="line-123"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_gcdIntegerIntzh&quot;</span> <span class="hs-varid">gcdIntegerInt</span><span class="hs-cpp">#</span>
<a name="line-124"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span>
<a name="line-125"></a>
<a name="line-126"></a><span class="hs-comment">-- |</span>
<a name="line-127"></a><span class="hs-comment">--</span>
<a name="line-128"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_gcdIntzh&quot;</span> <span class="hs-varid">gcdInt</span><span class="hs-cpp">#</span>
<a name="line-129"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span>
<a name="line-130"></a>
<a name="line-131"></a><span class="hs-comment">-- | Convert to arbitrary-precision integer.</span>
<a name="line-132"></a><span class="hs-comment">--    First {\tt Int\#} in result is the exponent; second {\tt Int\#} and {\tt ByteArray\#}</span>
<a name="line-133"></a><span class="hs-comment">--  represent an {\tt Integer\#} holding the mantissa.</span>
<a name="line-134"></a><span class="hs-comment">--</span>
<a name="line-135"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_decodeDoublezh&quot;</span> <span class="hs-varid">decodeDouble</span><span class="hs-cpp">#</span>
<a name="line-136"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Double</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-137"></a>
<a name="line-138"></a><span class="hs-comment">-- |</span>
<a name="line-139"></a><span class="hs-comment">--</span>
<a name="line-140"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_int2Integerzh&quot;</span> <span class="hs-varid">int2Integer</span><span class="hs-cpp">#</span>
<a name="line-141"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-142"></a>
<a name="line-143"></a><span class="hs-comment">-- |</span>
<a name="line-144"></a><span class="hs-comment">--</span>
<a name="line-145"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_word2Integerzh&quot;</span> <span class="hs-varid">word2Integer</span><span class="hs-cpp">#</span>
<a name="line-146"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Word</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-147"></a>
<a name="line-148"></a><span class="hs-comment">-- |</span>
<a name="line-149"></a><span class="hs-comment">--</span>
<a name="line-150"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_andIntegerzh&quot;</span> <span class="hs-varid">andInteger</span><span class="hs-cpp">#</span>
<a name="line-151"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-152"></a>
<a name="line-153"></a><span class="hs-comment">-- |</span>
<a name="line-154"></a><span class="hs-comment">--</span>
<a name="line-155"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_orIntegerzh&quot;</span> <span class="hs-varid">orInteger</span><span class="hs-cpp">#</span>
<a name="line-156"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-157"></a>
<a name="line-158"></a><span class="hs-comment">-- |</span>
<a name="line-159"></a><span class="hs-comment">--</span>
<a name="line-160"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_xorIntegerzh&quot;</span> <span class="hs-varid">xorInteger</span><span class="hs-cpp">#</span>
<a name="line-161"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-162"></a>
<a name="line-163"></a><span class="hs-comment">-- |</span>
<a name="line-164"></a><span class="hs-comment">--</span>
<a name="line-165"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_mul2ExpIntegerzh&quot;</span> <span class="hs-varid">mul2ExpInteger</span><span class="hs-cpp">#</span>
<a name="line-166"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-167"></a>
<a name="line-168"></a><span class="hs-comment">-- |</span>
<a name="line-169"></a><span class="hs-comment">--</span>
<a name="line-170"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_fdivQ2ExpIntegerzh&quot;</span> <span class="hs-varid">fdivQ2ExpInteger</span><span class="hs-cpp">#</span>
<a name="line-171"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-172"></a>
<a name="line-173"></a><span class="hs-comment">-- |</span>
<a name="line-174"></a><span class="hs-comment">--</span>
<a name="line-175"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_complementIntegerzh&quot;</span> <span class="hs-varid">complementInteger</span><span class="hs-cpp">#</span>
<a name="line-176"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-177"></a>
<a name="line-178"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS &lt; 64</span>
<a name="line-179"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_int64ToIntegerzh&quot;</span> <span class="hs-varid">int64ToInteger</span><span class="hs-cpp">#</span>
<a name="line-180"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int64</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-181"></a>
<a name="line-182"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-varid">prim</span> <span class="hs-str">&quot;integer_cmm_word64ToIntegerzh&quot;</span> <span class="hs-varid">word64ToInteger</span><span class="hs-cpp">#</span>
<a name="line-183"></a>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Word64</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-cpp">#</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span><span class="hs-layout">,</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-cpp">#</span><span class="hs-layout">)</span>
<a name="line-184"></a>
<a name="line-185"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-keyword">ccall</span> <span class="hs-keyword">unsafe</span> <span class="hs-str">&quot;hs_integerToInt64&quot;</span>
<a name="line-186"></a>    <span class="hs-varid">integerToInt64</span><span class="hs-cpp">#</span>  <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int64</span><span class="hs-cpp">#</span>
<a name="line-187"></a>
<a name="line-188"></a><span class="hs-keyword">foreign</span> <span class="hs-keyword">import</span> <span class="hs-keyword">ccall</span> <span class="hs-keyword">unsafe</span> <span class="hs-str">&quot;hs_integerToWord64&quot;</span>
<a name="line-189"></a>    <span class="hs-varid">integerToWord64</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Word64</span><span class="hs-cpp">#</span>
<a name="line-190"></a><span class="hs-cpp">#endif</span>
<a name="line-191"></a>
<a name="line-192"></a><a name="integer2Int"></a><span class="hs-comment">-- used to be primops:</span>
<a name="line-193"></a><span class="hs-definition">integer2Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span>
<a name="line-194"></a><span class="hs-definition">integer2Int</span><span class="hs-cpp">#</span> <span class="hs-varid">s</span> <span class="hs-varid">d</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">if</span> <span class="hs-varid">s</span> <span class="hs-varop">==#</span> <span class="hs-num">0</span><span class="hs-cpp">#</span>
<a name="line-195"></a>                       <span class="hs-keyword">then</span> <span class="hs-num">0</span><span class="hs-cpp">#</span>
<a name="line-196"></a>                       <span class="hs-keyword">else</span> <span class="hs-keyword">let</span> <span class="hs-varop">!</span><span class="hs-varid">v</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">indexIntArray</span><span class="hs-cpp">#</span> <span class="hs-varid">d</span> <span class="hs-num">0</span><span class="hs-cpp">#</span> <span class="hs-keyword">in</span>
<a name="line-197"></a>                            <span class="hs-keyword">if</span> <span class="hs-varid">s</span> <span class="hs-varop">&lt;#</span> <span class="hs-num">0</span><span class="hs-cpp">#</span>
<a name="line-198"></a>                               <span class="hs-keyword">then</span> <span class="hs-varid">negateInt</span><span class="hs-cpp">#</span> <span class="hs-varid">v</span>
<a name="line-199"></a>                               <span class="hs-keyword">else</span> <span class="hs-varid">v</span>
<a name="line-200"></a>
<a name="line-201"></a><a name="integer2Word"></a><span class="hs-definition">integer2Word</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">ByteArray</span><span class="hs-cpp">#</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Word</span><span class="hs-cpp">#</span>
<a name="line-202"></a><span class="hs-definition">integer2Word</span><span class="hs-cpp">#</span> <span class="hs-varid">s</span> <span class="hs-varid">d</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">int2Word</span><span class="hs-cpp">#</span> <span class="hs-layout">(</span><span class="hs-varid">integer2Int</span><span class="hs-cpp">#</span> <span class="hs-varid">s</span> <span class="hs-varid">d</span><span class="hs-layout">)</span>
</pre></body>
</html>
