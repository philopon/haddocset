<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Distribution/PackageDescription/PrettyPrint.hs</title>
<link type="text/css" rel="stylesheet" href="hscolour.css"></link>
</head>
<body>
<pre><a name="line-1"></a><span class="hs-comment">-----------------------------------------------------------------------------</span>
<a name="line-2"></a><span class="hs-comment">--</span>
<a name="line-3"></a><span class="hs-comment">-- Module      :  Distribution.PackageDescription.PrettyPrint</span>
<a name="line-4"></a><span class="hs-comment">-- Copyright   :  JÃ¼rgen Nicklisch-Franken 2010</span>
<a name="line-5"></a><span class="hs-comment">-- License     :  AllRightsReserved</span>
<a name="line-6"></a><span class="hs-comment">--</span>
<a name="line-7"></a><span class="hs-comment">-- Maintainer  : cabal-devel@haskell.org</span>
<a name="line-8"></a><span class="hs-comment">-- Stability   : provisional</span>
<a name="line-9"></a><span class="hs-comment">-- Portability : portable</span>
<a name="line-10"></a><span class="hs-comment">--</span>
<a name="line-11"></a><span class="hs-comment">-- | Pretty printing for cabal files</span>
<a name="line-12"></a><span class="hs-comment">--</span>
<a name="line-13"></a><span class="hs-comment">-----------------------------------------------------------------------------</span>
<a name="line-14"></a><span class="hs-comment">{- All rights reserved.
<a name="line-15"></a>
<a name="line-16"></a>Redistribution and use in source and binary forms, with or without
<a name="line-17"></a>modification, are permitted provided that the following conditions are
<a name="line-18"></a>met:
<a name="line-19"></a>
<a name="line-20"></a>    * Redistributions of source code must retain the above copyright
<a name="line-21"></a>      notice, this list of conditions and the following disclaimer.
<a name="line-22"></a>
<a name="line-23"></a>    * Redistributions in binary form must reproduce the above
<a name="line-24"></a>      copyright notice, this list of conditions and the following
<a name="line-25"></a>      disclaimer in the documentation and/or other materials provided
<a name="line-26"></a>      with the distribution.
<a name="line-27"></a>
<a name="line-28"></a>    * Neither the name of Isaac Jones nor the names of other
<a name="line-29"></a>      contributors may be used to endorse or promote products derived
<a name="line-30"></a>      from this software without specific prior written permission.
<a name="line-31"></a>
<a name="line-32"></a>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
<a name="line-33"></a>&quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
<a name="line-34"></a>LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
<a name="line-35"></a>A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
<a name="line-36"></a>OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
<a name="line-37"></a>SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
<a name="line-38"></a>LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
<a name="line-39"></a>DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
<a name="line-40"></a>THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
<a name="line-41"></a>(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
<a name="line-42"></a>OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. -}</span>
<a name="line-43"></a>
<a name="line-44"></a><span class="hs-keyword">module</span> <span class="hs-conid">Distribution</span><span class="hs-varop">.</span><span class="hs-conid">PackageDescription</span><span class="hs-varop">.</span><span class="hs-conid">PrettyPrint</span> <span class="hs-layout">(</span>
<a name="line-45"></a>    <span class="hs-varid">writeGenericPackageDescription</span><span class="hs-layout">,</span>
<a name="line-46"></a>    <span class="hs-varid">showGenericPackageDescription</span><span class="hs-layout">,</span>
<a name="line-47"></a><span class="hs-layout">)</span> <span class="hs-keyword">where</span>
<a name="line-48"></a>
<a name="line-49"></a><span class="hs-keyword">import</span> <span class="hs-conid">Distribution</span><span class="hs-varop">.</span><span class="hs-conid">PackageDescription</span>
<a name="line-50"></a>       <span class="hs-layout">(</span> <span class="hs-conid">TestSuite</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-conid">TestSuiteInterface</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-varid">testType</span>
<a name="line-51"></a>       <span class="hs-layout">,</span> <span class="hs-conid">SourceRepo</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-52"></a>        <span class="hs-varid">customFieldsBI</span><span class="hs-layout">,</span> <span class="hs-conid">CondTree</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-conid">Condition</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-53"></a>        <span class="hs-conid">FlagName</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-conid">ConfVar</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-conid">Executable</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-conid">Library</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-54"></a>        <span class="hs-conid">Flag</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-conid">PackageDescription</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">,</span>
<a name="line-55"></a>        <span class="hs-conid">GenericPackageDescription</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-56"></a><span class="hs-keyword">import</span> <span class="hs-conid">Text</span><span class="hs-varop">.</span><span class="hs-conid">PrettyPrint</span>
<a name="line-57"></a>       <span class="hs-layout">(</span><span class="hs-varid">hsep</span><span class="hs-layout">,</span> <span class="hs-varid">comma</span><span class="hs-layout">,</span> <span class="hs-varid">punctuate</span><span class="hs-layout">,</span> <span class="hs-varid">fsep</span><span class="hs-layout">,</span> <span class="hs-varid">parens</span><span class="hs-layout">,</span> <span class="hs-varid">char</span><span class="hs-layout">,</span> <span class="hs-varid">nest</span><span class="hs-layout">,</span> <span class="hs-varid">empty</span><span class="hs-layout">,</span>
<a name="line-58"></a>        <span class="hs-varid">isEmpty</span><span class="hs-layout">,</span> <span class="hs-layout">(</span><span class="hs-varop">$$</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-layout">(</span><span class="hs-varop">&lt;+&gt;</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-varid">colon</span><span class="hs-layout">,</span> <span class="hs-layout">(</span><span class="hs-varop">&lt;&gt;</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-varid">text</span><span class="hs-layout">,</span> <span class="hs-varid">vcat</span><span class="hs-layout">,</span> <span class="hs-layout">(</span><span class="hs-varop">$+$</span><span class="hs-layout">)</span><span class="hs-layout">,</span> <span class="hs-conid">Doc</span><span class="hs-layout">,</span> <span class="hs-varid">render</span><span class="hs-layout">)</span>
<a name="line-59"></a><span class="hs-keyword">import</span> <span class="hs-conid">Distribution</span><span class="hs-varop">.</span><span class="hs-conid">Simple</span><span class="hs-varop">.</span><span class="hs-conid">Utils</span> <span class="hs-layout">(</span><span class="hs-varid">writeUTF8File</span><span class="hs-layout">)</span>
<a name="line-60"></a><span class="hs-keyword">import</span> <span class="hs-conid">Distribution</span><span class="hs-varop">.</span><span class="hs-conid">ParseUtils</span> <span class="hs-layout">(</span><span class="hs-varid">showFreeText</span><span class="hs-layout">,</span> <span class="hs-conid">FieldDescr</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-61"></a><span class="hs-keyword">import</span> <span class="hs-conid">Distribution</span><span class="hs-varop">.</span><span class="hs-conid">PackageDescription</span><span class="hs-varop">.</span><span class="hs-conid">Parse</span> <span class="hs-layout">(</span><span class="hs-varid">pkgDescrFieldDescrs</span><span class="hs-layout">,</span><span class="hs-varid">binfoFieldDescrs</span><span class="hs-layout">,</span><span class="hs-varid">libFieldDescrs</span><span class="hs-layout">,</span>
<a name="line-62"></a>       <span class="hs-varid">sourceRepoFieldDescrs</span><span class="hs-layout">)</span>
<a name="line-63"></a><span class="hs-keyword">import</span> <span class="hs-conid">Distribution</span><span class="hs-varop">.</span><span class="hs-conid">Package</span> <span class="hs-layout">(</span><span class="hs-conid">Dependency</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-64"></a><span class="hs-keyword">import</span> <span class="hs-conid">Distribution</span><span class="hs-varop">.</span><span class="hs-conid">Text</span> <span class="hs-layout">(</span><span class="hs-conid">Text</span><span class="hs-layout">(</span><span class="hs-keyglyph">..</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-65"></a><span class="hs-keyword">import</span> <span class="hs-conid">Data</span><span class="hs-varop">.</span><span class="hs-conid">Maybe</span> <span class="hs-layout">(</span><span class="hs-varid">isJust</span><span class="hs-layout">,</span> <span class="hs-varid">fromJust</span><span class="hs-layout">,</span> <span class="hs-varid">isNothing</span><span class="hs-layout">)</span>
<a name="line-66"></a>
<a name="line-67"></a><a name="indentWith"></a><span class="hs-definition">indentWith</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Int</span>
<a name="line-68"></a><span class="hs-definition">indentWith</span> <span class="hs-keyglyph">=</span> <span class="hs-num">4</span>
<a name="line-69"></a>
<a name="line-70"></a><a name="simplifiedPrinting"></a><span class="hs-comment">-- | Recompile with false for regression testing</span>
<a name="line-71"></a><span class="hs-definition">simplifiedPrinting</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Bool</span>
<a name="line-72"></a><span class="hs-definition">simplifiedPrinting</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">False</span>
<a name="line-73"></a>
<a name="line-74"></a><a name="writeGenericPackageDescription"></a><span class="hs-comment">-- | Writes a .cabal file from a generic package description</span>
<a name="line-75"></a><span class="hs-definition">writeGenericPackageDescription</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">FilePath</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">GenericPackageDescription</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">IO</span> <span class="hs-conid">()</span>
<a name="line-76"></a><span class="hs-definition">writeGenericPackageDescription</span> <span class="hs-varid">fpath</span> <span class="hs-varid">pkg</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">writeUTF8File</span> <span class="hs-varid">fpath</span> <span class="hs-layout">(</span><span class="hs-varid">showGenericPackageDescription</span> <span class="hs-varid">pkg</span><span class="hs-layout">)</span>
<a name="line-77"></a>
<a name="line-78"></a><a name="showGenericPackageDescription"></a><span class="hs-comment">-- | Writes a generic package description to a string</span>
<a name="line-79"></a><span class="hs-definition">showGenericPackageDescription</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">GenericPackageDescription</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">String</span>
<a name="line-80"></a><span class="hs-definition">showGenericPackageDescription</span>            <span class="hs-keyglyph">=</span> <span class="hs-varid">render</span> <span class="hs-varop">.</span> <span class="hs-varid">ppGenericPackageDescription</span>
<a name="line-81"></a>
<a name="line-82"></a><a name="ppGenericPackageDescription"></a><span class="hs-definition">ppGenericPackageDescription</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">GenericPackageDescription</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-83"></a><span class="hs-definition">ppGenericPackageDescription</span> <span class="hs-varid">gpd</span>          <span class="hs-keyglyph">=</span>
<a name="line-84"></a>        <span class="hs-varid">ppPackageDescription</span> <span class="hs-layout">(</span><span class="hs-varid">packageDescription</span> <span class="hs-varid">gpd</span><span class="hs-layout">)</span>
<a name="line-85"></a>        <span class="hs-varop">$+$</span> <span class="hs-varid">ppGenPackageFlags</span> <span class="hs-layout">(</span><span class="hs-varid">genPackageFlags</span> <span class="hs-varid">gpd</span><span class="hs-layout">)</span>
<a name="line-86"></a>        <span class="hs-varop">$+$</span> <span class="hs-varid">ppLibrary</span> <span class="hs-layout">(</span><span class="hs-varid">condLibrary</span> <span class="hs-varid">gpd</span><span class="hs-layout">)</span>
<a name="line-87"></a>        <span class="hs-varop">$+$</span> <span class="hs-varid">ppExecutables</span> <span class="hs-layout">(</span><span class="hs-varid">condExecutables</span> <span class="hs-varid">gpd</span><span class="hs-layout">)</span>
<a name="line-88"></a>        <span class="hs-varop">$+$</span> <span class="hs-varid">ppTestSuites</span> <span class="hs-layout">(</span><span class="hs-varid">condTestSuites</span> <span class="hs-varid">gpd</span><span class="hs-layout">)</span>
<a name="line-89"></a>
<a name="line-90"></a><a name="ppPackageDescription"></a><span class="hs-definition">ppPackageDescription</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">PackageDescription</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-91"></a><span class="hs-definition">ppPackageDescription</span> <span class="hs-varid">pd</span>                  <span class="hs-keyglyph">=</span>      <span class="hs-varid">ppFields</span> <span class="hs-varid">pkgDescrFieldDescrs</span> <span class="hs-varid">pd</span>
<a name="line-92"></a>                                                <span class="hs-varop">$+$</span> <span class="hs-varid">ppCustomFields</span> <span class="hs-layout">(</span><span class="hs-varid">customFieldsPD</span> <span class="hs-varid">pd</span><span class="hs-layout">)</span>
<a name="line-93"></a>                                                <span class="hs-varop">$+$</span> <span class="hs-varid">ppSourceRepos</span> <span class="hs-layout">(</span><span class="hs-varid">sourceRepos</span> <span class="hs-varid">pd</span><span class="hs-layout">)</span>
<a name="line-94"></a>
<a name="line-95"></a><a name="ppSourceRepos"></a><span class="hs-definition">ppSourceRepos</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-conid">SourceRepo</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-96"></a><span class="hs-definition">ppSourceRepos</span> <span class="hs-conid">[]</span>                         <span class="hs-keyglyph">=</span> <span class="hs-varid">empty</span>
<a name="line-97"></a><span class="hs-definition">ppSourceRepos</span> <span class="hs-layout">(</span><span class="hs-varid">hd</span><span class="hs-conop">:</span><span class="hs-varid">tl</span><span class="hs-layout">)</span>                    <span class="hs-keyglyph">=</span> <span class="hs-varid">ppSourceRepo</span> <span class="hs-varid">hd</span> <span class="hs-varop">$+$</span> <span class="hs-varid">ppSourceRepos</span> <span class="hs-varid">tl</span>
<a name="line-98"></a>
<a name="line-99"></a><a name="ppSourceRepo"></a><span class="hs-definition">ppSourceRepo</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">SourceRepo</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-100"></a><span class="hs-definition">ppSourceRepo</span> <span class="hs-varid">repo</span>                        <span class="hs-keyglyph">=</span>
<a name="line-101"></a>    <span class="hs-varid">emptyLine</span> <span class="hs-varop">$</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;source-repository&quot;</span> <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">disp</span> <span class="hs-layout">(</span><span class="hs-varid">repoKind</span> <span class="hs-varid">repo</span><span class="hs-layout">)</span> <span class="hs-varop">$+$</span>
<a name="line-102"></a>        <span class="hs-layout">(</span><span class="hs-varid">nest</span> <span class="hs-varid">indentWith</span> <span class="hs-layout">(</span><span class="hs-varid">ppFields</span> <span class="hs-varid">sourceRepoFieldDescrs'</span> <span class="hs-varid">repo</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-103"></a>  <span class="hs-keyword">where</span>
<a name="line-104"></a>    <span class="hs-varid">sourceRepoFieldDescrs'</span> <span class="hs-keyglyph">=</span> <span class="hs-keyglyph">[</span><span class="hs-varid">fd</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">fd</span> <span class="hs-keyglyph">&lt;-</span> <span class="hs-varid">sourceRepoFieldDescrs</span><span class="hs-layout">,</span> <span class="hs-varid">fieldName</span> <span class="hs-varid">fd</span> <span class="hs-varop">/=</span> <span class="hs-str">&quot;kind&quot;</span><span class="hs-keyglyph">]</span>
<a name="line-105"></a>
<a name="line-106"></a><a name="ppFields"></a><span class="hs-definition">ppFields</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-conid">FieldDescr</span> <span class="hs-varid">a</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-107"></a><span class="hs-definition">ppFields</span> <span class="hs-varid">fields</span> <span class="hs-varid">x</span>                        <span class="hs-keyglyph">=</span>
<a name="line-108"></a>    <span class="hs-varid">vcat</span> <span class="hs-keyglyph">[</span> <span class="hs-varid">ppField</span> <span class="hs-varid">name</span> <span class="hs-layout">(</span><span class="hs-varid">getter</span> <span class="hs-varid">x</span><span class="hs-layout">)</span>
<a name="line-109"></a>                         <span class="hs-keyglyph">|</span> <span class="hs-conid">FieldDescr</span> <span class="hs-varid">name</span> <span class="hs-varid">getter</span> <span class="hs-keyword">_</span> <span class="hs-keyglyph">&lt;-</span> <span class="hs-varid">fields</span><span class="hs-keyglyph">]</span>
<a name="line-110"></a>
<a name="line-111"></a><a name="ppField"></a><span class="hs-definition">ppField</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">String</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-112"></a><span class="hs-definition">ppField</span> <span class="hs-varid">name</span> <span class="hs-varid">fielddoc</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">isEmpty</span> <span class="hs-varid">fielddoc</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">empty</span>
<a name="line-113"></a>                      <span class="hs-keyglyph">|</span> <span class="hs-varid">otherwise</span>        <span class="hs-keyglyph">=</span> <span class="hs-varid">text</span> <span class="hs-varid">name</span> <span class="hs-varop">&lt;&gt;</span> <span class="hs-varid">colon</span> <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">fielddoc</span>
<a name="line-114"></a>
<a name="line-115"></a><a name="ppDiffFields"></a><span class="hs-definition">ppDiffFields</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-conid">FieldDescr</span> <span class="hs-varid">a</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-116"></a><span class="hs-definition">ppDiffFields</span> <span class="hs-varid">fields</span> <span class="hs-varid">x</span> <span class="hs-varid">y</span>                  <span class="hs-keyglyph">=</span>
<a name="line-117"></a>    <span class="hs-varid">vcat</span> <span class="hs-keyglyph">[</span> <span class="hs-varid">ppField</span> <span class="hs-varid">name</span> <span class="hs-layout">(</span><span class="hs-varid">getter</span> <span class="hs-varid">x</span><span class="hs-layout">)</span>
<a name="line-118"></a>                         <span class="hs-keyglyph">|</span> <span class="hs-conid">FieldDescr</span> <span class="hs-varid">name</span> <span class="hs-varid">getter</span> <span class="hs-keyword">_</span> <span class="hs-keyglyph">&lt;-</span> <span class="hs-varid">fields</span><span class="hs-layout">,</span>
<a name="line-119"></a>                            <span class="hs-varid">render</span> <span class="hs-layout">(</span><span class="hs-varid">getter</span> <span class="hs-varid">x</span><span class="hs-layout">)</span> <span class="hs-varop">/=</span> <span class="hs-varid">render</span> <span class="hs-layout">(</span><span class="hs-varid">getter</span> <span class="hs-varid">y</span><span class="hs-layout">)</span><span class="hs-keyglyph">]</span>
<a name="line-120"></a>
<a name="line-121"></a><a name="ppCustomFields"></a><span class="hs-definition">ppCustomFields</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-layout">(</span><span class="hs-conid">String</span><span class="hs-layout">,</span><span class="hs-conid">String</span><span class="hs-layout">)</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-122"></a><span class="hs-definition">ppCustomFields</span> <span class="hs-varid">flds</span>                      <span class="hs-keyglyph">=</span> <span class="hs-varid">vcat</span> <span class="hs-keyglyph">[</span><span class="hs-varid">ppCustomField</span> <span class="hs-varid">f</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">f</span> <span class="hs-keyglyph">&lt;-</span> <span class="hs-varid">flds</span><span class="hs-keyglyph">]</span>
<a name="line-123"></a>
<a name="line-124"></a><a name="ppCustomField"></a><span class="hs-definition">ppCustomField</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">String</span><span class="hs-layout">,</span><span class="hs-conid">String</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-125"></a><span class="hs-definition">ppCustomField</span> <span class="hs-layout">(</span><span class="hs-varid">name</span><span class="hs-layout">,</span><span class="hs-varid">val</span><span class="hs-layout">)</span>                 <span class="hs-keyglyph">=</span> <span class="hs-varid">text</span> <span class="hs-varid">name</span> <span class="hs-varop">&lt;&gt;</span> <span class="hs-varid">colon</span> <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">showFreeText</span> <span class="hs-varid">val</span>
<a name="line-126"></a>
<a name="line-127"></a><a name="ppGenPackageFlags"></a><span class="hs-definition">ppGenPackageFlags</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Flag</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-128"></a><span class="hs-definition">ppGenPackageFlags</span> <span class="hs-varid">flds</span>                   <span class="hs-keyglyph">=</span> <span class="hs-varid">vcat</span> <span class="hs-keyglyph">[</span><span class="hs-varid">ppFlag</span> <span class="hs-varid">f</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">f</span> <span class="hs-keyglyph">&lt;-</span> <span class="hs-varid">flds</span><span class="hs-keyglyph">]</span>
<a name="line-129"></a>
<a name="line-130"></a><a name="ppFlag"></a><span class="hs-definition">ppFlag</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Flag</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-131"></a><span class="hs-definition">ppFlag</span> <span class="hs-layout">(</span><span class="hs-conid">MkFlag</span> <span class="hs-varid">name</span> <span class="hs-varid">desc</span> <span class="hs-varid">dflt</span> <span class="hs-varid">manual</span><span class="hs-layout">)</span>    <span class="hs-keyglyph">=</span>
<a name="line-132"></a>    <span class="hs-varid">emptyLine</span> <span class="hs-varop">$</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;flag&quot;</span> <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">ppFlagName</span> <span class="hs-varid">name</span> <span class="hs-varop">$+$</span>
<a name="line-133"></a>            <span class="hs-layout">(</span><span class="hs-varid">nest</span> <span class="hs-varid">indentWith</span> <span class="hs-layout">(</span><span class="hs-layout">(</span><span class="hs-keyword">if</span> <span class="hs-varid">null</span> <span class="hs-varid">desc</span>
<a name="line-134"></a>                                <span class="hs-keyword">then</span> <span class="hs-varid">empty</span>
<a name="line-135"></a>                                <span class="hs-keyword">else</span>  <span class="hs-varid">text</span> <span class="hs-str">&quot;Description: &quot;</span> <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">showFreeText</span> <span class="hs-varid">desc</span><span class="hs-layout">)</span> <span class="hs-varop">$+$</span>
<a name="line-136"></a>                     <span class="hs-layout">(</span><span class="hs-keyword">if</span> <span class="hs-varid">dflt</span> <span class="hs-keyword">then</span> <span class="hs-varid">empty</span> <span class="hs-keyword">else</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;Default: False&quot;</span><span class="hs-layout">)</span> <span class="hs-varop">$+$</span>
<a name="line-137"></a>                     <span class="hs-layout">(</span><span class="hs-keyword">if</span> <span class="hs-varid">manual</span> <span class="hs-keyword">then</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;Manual: True&quot;</span> <span class="hs-keyword">else</span> <span class="hs-varid">empty</span><span class="hs-layout">)</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-138"></a>
<a name="line-139"></a><a name="ppLibrary"></a><span class="hs-definition">ppLibrary</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Maybe</span> <span class="hs-layout">(</span><span class="hs-conid">CondTree</span> <span class="hs-conid">ConfVar</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Dependency</span><span class="hs-keyglyph">]</span> <span class="hs-conid">Library</span><span class="hs-layout">)</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-140"></a><span class="hs-definition">ppLibrary</span> <span class="hs-conid">Nothing</span>                        <span class="hs-keyglyph">=</span> <span class="hs-varid">empty</span>
<a name="line-141"></a><span class="hs-definition">ppLibrary</span> <span class="hs-layout">(</span><span class="hs-conid">Just</span> <span class="hs-varid">condTree</span><span class="hs-layout">)</span>                <span class="hs-keyglyph">=</span>
<a name="line-142"></a>    <span class="hs-varid">emptyLine</span> <span class="hs-varop">$</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;library&quot;</span> <span class="hs-varop">$+$</span> <span class="hs-varid">nest</span> <span class="hs-varid">indentWith</span> <span class="hs-layout">(</span><span class="hs-varid">ppCondTree</span> <span class="hs-varid">condTree</span> <span class="hs-conid">Nothing</span> <span class="hs-varid">ppLib</span><span class="hs-layout">)</span>
<a name="line-143"></a>  <span class="hs-keyword">where</span>
<a name="line-144"></a>    <span class="hs-varid">ppLib</span> <span class="hs-varid">lib</span> <span class="hs-conid">Nothing</span>     <span class="hs-keyglyph">=</span> <span class="hs-varid">ppFields</span> <span class="hs-varid">libFieldDescrs</span> <span class="hs-varid">lib</span>
<a name="line-145"></a>                            <span class="hs-varop">$$</span>  <span class="hs-varid">ppCustomFields</span> <span class="hs-layout">(</span><span class="hs-varid">customFieldsBI</span> <span class="hs-layout">(</span><span class="hs-varid">libBuildInfo</span> <span class="hs-varid">lib</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-146"></a>    <span class="hs-varid">ppLib</span> <span class="hs-varid">lib</span> <span class="hs-layout">(</span><span class="hs-conid">Just</span> <span class="hs-varid">plib</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">ppDiffFields</span> <span class="hs-varid">libFieldDescrs</span> <span class="hs-varid">lib</span> <span class="hs-varid">plib</span>
<a name="line-147"></a>                            <span class="hs-varop">$$</span>  <span class="hs-varid">ppCustomFields</span> <span class="hs-layout">(</span><span class="hs-varid">customFieldsBI</span> <span class="hs-layout">(</span><span class="hs-varid">libBuildInfo</span> <span class="hs-varid">lib</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-148"></a>
<a name="line-149"></a><a name="ppExecutables"></a><span class="hs-definition">ppExecutables</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-layout">(</span><span class="hs-conid">String</span><span class="hs-layout">,</span> <span class="hs-conid">CondTree</span> <span class="hs-conid">ConfVar</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Dependency</span><span class="hs-keyglyph">]</span> <span class="hs-conid">Executable</span><span class="hs-layout">)</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-150"></a><span class="hs-definition">ppExecutables</span> <span class="hs-varid">exes</span>                       <span class="hs-keyglyph">=</span>
<a name="line-151"></a>    <span class="hs-varid">vcat</span> <span class="hs-keyglyph">[</span><span class="hs-varid">emptyLine</span> <span class="hs-varop">$</span> <span class="hs-varid">text</span> <span class="hs-layout">(</span><span class="hs-str">&quot;executable &quot;</span> <span class="hs-varop">++</span> <span class="hs-varid">n</span><span class="hs-layout">)</span>
<a name="line-152"></a>              <span class="hs-varop">$+$</span> <span class="hs-varid">nest</span> <span class="hs-varid">indentWith</span> <span class="hs-layout">(</span><span class="hs-varid">ppCondTree</span> <span class="hs-varid">condTree</span> <span class="hs-conid">Nothing</span> <span class="hs-varid">ppExe</span><span class="hs-layout">)</span><span class="hs-keyglyph">|</span> <span class="hs-layout">(</span><span class="hs-varid">n</span><span class="hs-layout">,</span><span class="hs-varid">condTree</span><span class="hs-layout">)</span> <span class="hs-keyglyph">&lt;-</span> <span class="hs-varid">exes</span><span class="hs-keyglyph">]</span>
<a name="line-153"></a>  <span class="hs-keyword">where</span>
<a name="line-154"></a>    <span class="hs-varid">ppExe</span> <span class="hs-layout">(</span><span class="hs-conid">Executable</span> <span class="hs-keyword">_</span> <span class="hs-varid">modulePath'</span> <span class="hs-varid">buildInfo'</span><span class="hs-layout">)</span> <span class="hs-conid">Nothing</span> <span class="hs-keyglyph">=</span>
<a name="line-155"></a>        <span class="hs-layout">(</span><span class="hs-keyword">if</span> <span class="hs-varid">modulePath'</span> <span class="hs-varop">==</span> <span class="hs-str">&quot;&quot;</span> <span class="hs-keyword">then</span> <span class="hs-varid">empty</span> <span class="hs-keyword">else</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;main-is:&quot;</span> <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">text</span> <span class="hs-varid">modulePath'</span><span class="hs-layout">)</span>
<a name="line-156"></a>            <span class="hs-varop">$+$</span> <span class="hs-varid">ppFields</span> <span class="hs-varid">binfoFieldDescrs</span> <span class="hs-varid">buildInfo'</span>
<a name="line-157"></a>            <span class="hs-varop">$+$</span>  <span class="hs-varid">ppCustomFields</span> <span class="hs-layout">(</span><span class="hs-varid">customFieldsBI</span> <span class="hs-varid">buildInfo'</span><span class="hs-layout">)</span>
<a name="line-158"></a>    <span class="hs-varid">ppExe</span> <span class="hs-layout">(</span><span class="hs-conid">Executable</span> <span class="hs-keyword">_</span> <span class="hs-varid">modulePath'</span> <span class="hs-varid">buildInfo'</span><span class="hs-layout">)</span>
<a name="line-159"></a>            <span class="hs-layout">(</span><span class="hs-conid">Just</span> <span class="hs-layout">(</span><span class="hs-conid">Executable</span> <span class="hs-keyword">_</span> <span class="hs-varid">modulePath2</span> <span class="hs-varid">buildInfo2</span><span class="hs-layout">)</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span>
<a name="line-160"></a>            <span class="hs-layout">(</span><span class="hs-keyword">if</span> <span class="hs-varid">modulePath'</span> <span class="hs-varop">==</span> <span class="hs-str">&quot;&quot;</span> <span class="hs-varop">||</span> <span class="hs-varid">modulePath'</span> <span class="hs-varop">==</span> <span class="hs-varid">modulePath2</span>
<a name="line-161"></a>                <span class="hs-keyword">then</span> <span class="hs-varid">empty</span> <span class="hs-keyword">else</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;main-is:&quot;</span> <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">text</span> <span class="hs-varid">modulePath'</span><span class="hs-layout">)</span>
<a name="line-162"></a>            <span class="hs-varop">$+$</span> <span class="hs-varid">ppDiffFields</span> <span class="hs-varid">binfoFieldDescrs</span> <span class="hs-varid">buildInfo'</span> <span class="hs-varid">buildInfo2</span>
<a name="line-163"></a>            <span class="hs-varop">$+$</span> <span class="hs-varid">ppCustomFields</span> <span class="hs-layout">(</span><span class="hs-varid">customFieldsBI</span> <span class="hs-varid">buildInfo'</span><span class="hs-layout">)</span>
<a name="line-164"></a>
<a name="line-165"></a><a name="ppTestSuites"></a><span class="hs-definition">ppTestSuites</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-layout">(</span><span class="hs-conid">String</span><span class="hs-layout">,</span> <span class="hs-conid">CondTree</span> <span class="hs-conid">ConfVar</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Dependency</span><span class="hs-keyglyph">]</span> <span class="hs-conid">TestSuite</span><span class="hs-layout">)</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-166"></a><span class="hs-definition">ppTestSuites</span> <span class="hs-varid">suites</span> <span class="hs-keyglyph">=</span>
<a name="line-167"></a>    <span class="hs-varid">emptyLine</span> <span class="hs-varop">$</span> <span class="hs-varid">vcat</span> <span class="hs-keyglyph">[</span>     <span class="hs-varid">text</span> <span class="hs-layout">(</span><span class="hs-str">&quot;test-suite &quot;</span> <span class="hs-varop">++</span> <span class="hs-varid">n</span><span class="hs-layout">)</span>
<a name="line-168"></a>                       <span class="hs-varop">$+$</span> <span class="hs-varid">nest</span> <span class="hs-varid">indentWith</span> <span class="hs-layout">(</span><span class="hs-varid">ppCondTree</span> <span class="hs-varid">condTree</span> <span class="hs-conid">Nothing</span> <span class="hs-varid">ppTestSuite</span><span class="hs-layout">)</span>
<a name="line-169"></a>                     <span class="hs-keyglyph">|</span> <span class="hs-layout">(</span><span class="hs-varid">n</span><span class="hs-layout">,</span><span class="hs-varid">condTree</span><span class="hs-layout">)</span> <span class="hs-keyglyph">&lt;-</span> <span class="hs-varid">suites</span><span class="hs-keyglyph">]</span>
<a name="line-170"></a>  <span class="hs-keyword">where</span>
<a name="line-171"></a>    <span class="hs-varid">ppTestSuite</span> <span class="hs-varid">testsuite</span> <span class="hs-conid">Nothing</span> <span class="hs-keyglyph">=</span>
<a name="line-172"></a>                <span class="hs-varid">text</span> <span class="hs-str">&quot;type:&quot;</span> <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">disp</span> <span class="hs-layout">(</span><span class="hs-varid">testType</span> <span class="hs-varid">testsuite</span><span class="hs-layout">)</span>
<a name="line-173"></a>            <span class="hs-varop">$+$</span> <span class="hs-varid">maybe</span> <span class="hs-varid">empty</span> <span class="hs-layout">(</span><span class="hs-keyglyph">\</span><span class="hs-varid">f</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;main-is:&quot;</span>     <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">text</span> <span class="hs-varid">f</span><span class="hs-layout">)</span>
<a name="line-174"></a>                            <span class="hs-layout">(</span><span class="hs-varid">testSuiteMainIs</span> <span class="hs-varid">testsuite</span><span class="hs-layout">)</span>
<a name="line-175"></a>            <span class="hs-varop">$+$</span> <span class="hs-varid">maybe</span> <span class="hs-varid">empty</span> <span class="hs-layout">(</span><span class="hs-keyglyph">\</span><span class="hs-varid">m</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;test-module:&quot;</span> <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">disp</span> <span class="hs-varid">m</span><span class="hs-layout">)</span>
<a name="line-176"></a>                            <span class="hs-layout">(</span><span class="hs-varid">testSuiteModule</span> <span class="hs-varid">testsuite</span><span class="hs-layout">)</span>
<a name="line-177"></a>            <span class="hs-varop">$+$</span> <span class="hs-varid">ppFields</span> <span class="hs-varid">binfoFieldDescrs</span> <span class="hs-layout">(</span><span class="hs-varid">testBuildInfo</span> <span class="hs-varid">testsuite</span><span class="hs-layout">)</span>
<a name="line-178"></a>            <span class="hs-varop">$+$</span> <span class="hs-varid">ppCustomFields</span> <span class="hs-layout">(</span><span class="hs-varid">customFieldsBI</span> <span class="hs-layout">(</span><span class="hs-varid">testBuildInfo</span> <span class="hs-varid">testsuite</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-179"></a>
<a name="line-180"></a>    <span class="hs-varid">ppTestSuite</span> <span class="hs-layout">(</span><span class="hs-conid">TestSuite</span> <span class="hs-keyword">_</span> <span class="hs-keyword">_</span> <span class="hs-varid">buildInfo'</span> <span class="hs-keyword">_</span><span class="hs-layout">)</span>
<a name="line-181"></a>                    <span class="hs-layout">(</span><span class="hs-conid">Just</span> <span class="hs-layout">(</span><span class="hs-conid">TestSuite</span> <span class="hs-keyword">_</span> <span class="hs-keyword">_</span> <span class="hs-varid">buildInfo2</span> <span class="hs-keyword">_</span><span class="hs-layout">)</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span>
<a name="line-182"></a>            <span class="hs-varid">ppDiffFields</span> <span class="hs-varid">binfoFieldDescrs</span> <span class="hs-varid">buildInfo'</span> <span class="hs-varid">buildInfo2</span>
<a name="line-183"></a>            <span class="hs-varop">$+$</span> <span class="hs-varid">ppCustomFields</span> <span class="hs-layout">(</span><span class="hs-varid">customFieldsBI</span> <span class="hs-varid">buildInfo'</span><span class="hs-layout">)</span>
<a name="line-184"></a>
<a name="line-185"></a>    <span class="hs-varid">testSuiteMainIs</span> <span class="hs-varid">test</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">testInterface</span> <span class="hs-varid">test</span> <span class="hs-keyword">of</span>
<a name="line-186"></a>      <span class="hs-conid">TestSuiteExeV10</span> <span class="hs-keyword">_</span> <span class="hs-varid">f</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Just</span> <span class="hs-varid">f</span>
<a name="line-187"></a>      <span class="hs-keyword">_</span>                   <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Nothing</span>
<a name="line-188"></a>
<a name="line-189"></a>    <span class="hs-varid">testSuiteModule</span> <span class="hs-varid">test</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">case</span> <span class="hs-varid">testInterface</span> <span class="hs-varid">test</span> <span class="hs-keyword">of</span>
<a name="line-190"></a>      <span class="hs-conid">TestSuiteLibV09</span> <span class="hs-keyword">_</span> <span class="hs-varid">m</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Just</span> <span class="hs-varid">m</span>
<a name="line-191"></a>      <span class="hs-keyword">_</span>                   <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Nothing</span>
<a name="line-192"></a>
<a name="line-193"></a><a name="ppCondition"></a><span class="hs-definition">ppCondition</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Condition</span> <span class="hs-conid">ConfVar</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-194"></a><span class="hs-definition">ppCondition</span> <span class="hs-layout">(</span><span class="hs-conid">Var</span> <span class="hs-varid">x</span><span class="hs-layout">)</span>                      <span class="hs-keyglyph">=</span> <span class="hs-varid">ppConfVar</span> <span class="hs-varid">x</span>
<a name="line-195"></a><span class="hs-definition">ppCondition</span> <span class="hs-layout">(</span><span class="hs-conid">Lit</span> <span class="hs-varid">b</span><span class="hs-layout">)</span>                      <span class="hs-keyglyph">=</span> <span class="hs-varid">text</span> <span class="hs-layout">(</span><span class="hs-varid">show</span> <span class="hs-varid">b</span><span class="hs-layout">)</span>
<a name="line-196"></a><span class="hs-definition">ppCondition</span> <span class="hs-layout">(</span><span class="hs-conid">CNot</span> <span class="hs-varid">c</span><span class="hs-layout">)</span>                     <span class="hs-keyglyph">=</span> <span class="hs-varid">char</span> <span class="hs-chr">'!'</span> <span class="hs-varop">&lt;&gt;</span> <span class="hs-layout">(</span><span class="hs-varid">ppCondition</span> <span class="hs-varid">c</span><span class="hs-layout">)</span>
<a name="line-197"></a><span class="hs-definition">ppCondition</span> <span class="hs-layout">(</span><span class="hs-conid">COr</span> <span class="hs-varid">c1</span> <span class="hs-varid">c2</span><span class="hs-layout">)</span>                  <span class="hs-keyglyph">=</span> <span class="hs-varid">parens</span> <span class="hs-layout">(</span><span class="hs-varid">hsep</span> <span class="hs-keyglyph">[</span><span class="hs-varid">ppCondition</span> <span class="hs-varid">c1</span><span class="hs-layout">,</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;||&quot;</span>
<a name="line-198"></a>                                                         <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">ppCondition</span> <span class="hs-varid">c2</span><span class="hs-keyglyph">]</span><span class="hs-layout">)</span>
<a name="line-199"></a><span class="hs-definition">ppCondition</span> <span class="hs-layout">(</span><span class="hs-conid">CAnd</span> <span class="hs-varid">c1</span> <span class="hs-varid">c2</span><span class="hs-layout">)</span>                 <span class="hs-keyglyph">=</span> <span class="hs-varid">parens</span> <span class="hs-layout">(</span><span class="hs-varid">hsep</span> <span class="hs-keyglyph">[</span><span class="hs-varid">ppCondition</span> <span class="hs-varid">c1</span><span class="hs-layout">,</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;&amp;&amp;&quot;</span>
<a name="line-200"></a>                                                         <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">ppCondition</span> <span class="hs-varid">c2</span><span class="hs-keyglyph">]</span><span class="hs-layout">)</span>
<a name="line-201"></a><a name="ppConfVar"></a><span class="hs-definition">ppConfVar</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">ConfVar</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-202"></a><span class="hs-definition">ppConfVar</span> <span class="hs-layout">(</span><span class="hs-conid">OS</span> <span class="hs-varid">os</span><span class="hs-layout">)</span>                        <span class="hs-keyglyph">=</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;os&quot;</span>   <span class="hs-varop">&lt;&gt;</span> <span class="hs-varid">parens</span> <span class="hs-layout">(</span><span class="hs-varid">disp</span> <span class="hs-varid">os</span><span class="hs-layout">)</span>
<a name="line-203"></a><span class="hs-definition">ppConfVar</span> <span class="hs-layout">(</span><span class="hs-conid">Arch</span> <span class="hs-varid">arch</span><span class="hs-layout">)</span>                    <span class="hs-keyglyph">=</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;arch&quot;</span> <span class="hs-varop">&lt;&gt;</span> <span class="hs-varid">parens</span> <span class="hs-layout">(</span><span class="hs-varid">disp</span> <span class="hs-varid">arch</span><span class="hs-layout">)</span>
<a name="line-204"></a><span class="hs-definition">ppConfVar</span> <span class="hs-layout">(</span><span class="hs-conid">Flag</span> <span class="hs-varid">name</span><span class="hs-layout">)</span>                    <span class="hs-keyglyph">=</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;flag&quot;</span> <span class="hs-varop">&lt;&gt;</span> <span class="hs-varid">parens</span> <span class="hs-layout">(</span><span class="hs-varid">ppFlagName</span> <span class="hs-varid">name</span><span class="hs-layout">)</span>
<a name="line-205"></a><span class="hs-definition">ppConfVar</span> <span class="hs-layout">(</span><span class="hs-conid">Impl</span> <span class="hs-varid">c</span> <span class="hs-varid">v</span><span class="hs-layout">)</span>                     <span class="hs-keyglyph">=</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;impl&quot;</span> <span class="hs-varop">&lt;&gt;</span> <span class="hs-varid">parens</span> <span class="hs-layout">(</span><span class="hs-varid">disp</span> <span class="hs-varid">c</span> <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">disp</span> <span class="hs-varid">v</span><span class="hs-layout">)</span>
<a name="line-206"></a>
<a name="line-207"></a><a name="ppFlagName"></a><span class="hs-definition">ppFlagName</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">FlagName</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-208"></a><span class="hs-definition">ppFlagName</span> <span class="hs-layout">(</span><span class="hs-conid">FlagName</span> <span class="hs-varid">name</span><span class="hs-layout">)</span>               <span class="hs-keyglyph">=</span> <span class="hs-varid">text</span> <span class="hs-varid">name</span>
<a name="line-209"></a>
<a name="line-210"></a><a name="ppCondTree"></a><span class="hs-definition">ppCondTree</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">CondTree</span> <span class="hs-conid">ConfVar</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Dependency</span><span class="hs-keyglyph">]</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Maybe</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-layout">(</span><span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Maybe</span> <span class="hs-varid">a</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span>  <span class="hs-conid">Doc</span>
<a name="line-211"></a><span class="hs-definition">ppCondTree</span> <span class="hs-varid">ct</span><span class="hs-keyglyph">@</span><span class="hs-layout">(</span><span class="hs-conid">CondNode</span> <span class="hs-varid">it</span> <span class="hs-varid">deps</span> <span class="hs-varid">ifs</span><span class="hs-layout">)</span> <span class="hs-varid">mbIt</span> <span class="hs-varid">ppIt</span> <span class="hs-keyglyph">=</span>
<a name="line-212"></a>    <span class="hs-keyword">let</span> <span class="hs-varid">res</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">ppDeps</span> <span class="hs-varid">deps</span>
<a name="line-213"></a>                <span class="hs-varop">$+$</span> <span class="hs-layout">(</span><span class="hs-varid">vcat</span> <span class="hs-varop">$</span> <span class="hs-varid">map</span> <span class="hs-varid">ppIf</span> <span class="hs-varid">ifs</span><span class="hs-layout">)</span>
<a name="line-214"></a>                <span class="hs-varop">$+$</span> <span class="hs-varid">ppIt</span> <span class="hs-varid">it</span> <span class="hs-varid">mbIt</span>
<a name="line-215"></a>    <span class="hs-keyword">in</span> <span class="hs-keyword">if</span> <span class="hs-varid">isJust</span> <span class="hs-varid">mbIt</span> <span class="hs-varop">&amp;&amp;</span> <span class="hs-varid">isEmpty</span> <span class="hs-varid">res</span>
<a name="line-216"></a>        <span class="hs-keyword">then</span> <span class="hs-varid">ppCondTree</span> <span class="hs-varid">ct</span> <span class="hs-conid">Nothing</span> <span class="hs-varid">ppIt</span>
<a name="line-217"></a>        <span class="hs-keyword">else</span> <span class="hs-varid">res</span>
<a name="line-218"></a>  <span class="hs-keyword">where</span>
<a name="line-219"></a>    <span class="hs-varid">ppIf</span> <span class="hs-layout">(</span><span class="hs-varid">c</span><span class="hs-layout">,</span><span class="hs-varid">thenTree</span><span class="hs-layout">,</span><span class="hs-varid">mElseTree</span><span class="hs-layout">)</span>          <span class="hs-keyglyph">=</span>
<a name="line-220"></a>        <span class="hs-layout">(</span><span class="hs-layout">(</span><span class="hs-varid">emptyLine</span> <span class="hs-varop">$</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;if&quot;</span> <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">ppCondition</span> <span class="hs-varid">c</span><span class="hs-layout">)</span> <span class="hs-varop">$$</span>
<a name="line-221"></a>          <span class="hs-varid">nest</span> <span class="hs-varid">indentWith</span> <span class="hs-layout">(</span><span class="hs-varid">ppCondTree</span> <span class="hs-varid">thenTree</span>
<a name="line-222"></a>                    <span class="hs-layout">(</span><span class="hs-keyword">if</span> <span class="hs-varid">simplifiedPrinting</span> <span class="hs-keyword">then</span> <span class="hs-layout">(</span><span class="hs-conid">Just</span> <span class="hs-varid">it</span><span class="hs-layout">)</span> <span class="hs-keyword">else</span> <span class="hs-conid">Nothing</span><span class="hs-layout">)</span> <span class="hs-varid">ppIt</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-223"></a>        <span class="hs-varop">$+$</span> <span class="hs-layout">(</span><span class="hs-keyword">if</span> <span class="hs-varid">isNothing</span> <span class="hs-varid">mElseTree</span>
<a name="line-224"></a>                <span class="hs-keyword">then</span> <span class="hs-varid">empty</span>
<a name="line-225"></a>                <span class="hs-keyword">else</span> <span class="hs-varid">text</span> <span class="hs-str">&quot;else&quot;</span>
<a name="line-226"></a>                    <span class="hs-varop">$$</span> <span class="hs-varid">nest</span> <span class="hs-varid">indentWith</span> <span class="hs-layout">(</span><span class="hs-varid">ppCondTree</span> <span class="hs-layout">(</span><span class="hs-varid">fromJust</span> <span class="hs-varid">mElseTree</span><span class="hs-layout">)</span>
<a name="line-227"></a>                        <span class="hs-layout">(</span><span class="hs-keyword">if</span> <span class="hs-varid">simplifiedPrinting</span> <span class="hs-keyword">then</span> <span class="hs-layout">(</span><span class="hs-conid">Just</span> <span class="hs-varid">it</span><span class="hs-layout">)</span> <span class="hs-keyword">else</span> <span class="hs-conid">Nothing</span><span class="hs-layout">)</span> <span class="hs-varid">ppIt</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-228"></a>
<a name="line-229"></a><a name="ppDeps"></a><span class="hs-definition">ppDeps</span> <span class="hs-keyglyph">::</span> <span class="hs-keyglyph">[</span><span class="hs-conid">Dependency</span><span class="hs-keyglyph">]</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-230"></a><span class="hs-definition">ppDeps</span> <span class="hs-conid">[]</span>                                <span class="hs-keyglyph">=</span> <span class="hs-varid">empty</span>
<a name="line-231"></a><span class="hs-definition">ppDeps</span> <span class="hs-varid">deps</span>                              <span class="hs-keyglyph">=</span>
<a name="line-232"></a>    <span class="hs-varid">text</span> <span class="hs-str">&quot;build-depends:&quot;</span> <span class="hs-varop">&lt;+&gt;</span> <span class="hs-varid">fsep</span> <span class="hs-layout">(</span><span class="hs-varid">punctuate</span> <span class="hs-varid">comma</span> <span class="hs-layout">(</span><span class="hs-varid">map</span> <span class="hs-varid">disp</span> <span class="hs-varid">deps</span><span class="hs-layout">)</span><span class="hs-layout">)</span>
<a name="line-233"></a>
<a name="line-234"></a><a name="emptyLine"></a><span class="hs-definition">emptyLine</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Doc</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Doc</span>
<a name="line-235"></a><span class="hs-definition">emptyLine</span> <span class="hs-varid">d</span>                              <span class="hs-keyglyph">=</span> <span class="hs-varid">text</span> <span class="hs-str">&quot; &quot;</span> <span class="hs-varop">$+$</span> <span class="hs-varid">d</span>
<a name="line-236"></a>
<a name="line-237"></a>
<a name="line-238"></a>
</pre></body>
</html>
